{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/gestures sync ^\\.\\/.*\\.svg$","webpack:///./src/components/elements/VideoPlayer.vue?fc37","webpack:///./src/components/elements/WebcamBox.vue?808e","webpack:///./src/components/screens/LearningScreen.vue?1f95","webpack:///./src/assets/gestures/forward.svg","webpack:///./src/components/screens/PoseDrawerTest.vue?7360","webpack:///./src/components/elements/SegmentedProgressBar.vue?325d","webpack:///./src/components/elements/WebcamPromptCard.vue?02bc","webpack:///./src/assets/gestures/play.svg","webpack:///./src/assets/gestures/backward.svg","webpack:///./src/App.vue?bf84","webpack:///./src/components/elements/UploadCard.vue?d451","webpack:///./src/assets/tiktokdances.jpg","webpack:///./src/components/screens/CreateLessonScreen.vue?a05e","webpack:///./src/components/screens/DanceMenu.vue?b279","webpack:///./src/components/CameraSurface.vue?6dbc","webpack:///./src/components/elements/LessonCard.vue?048f","webpack:///./src/components/elements/InstructionCarousel.vue?2efc","webpack:///./src/components/DrawingSurface.vue?d0d9","webpack:///./src/App.vue","webpack:///./src/services/WebcamProvider.ts","webpack:///./src/components/CameraSurface.vue","webpack:///./src/services/EventHub.ts","webpack:///./src/components/DrawingSurface.vue","webpack:///./src/services/MediaPipeTypes.ts","webpack:///./src/services/Utils.ts","webpack:///./src/services/MediaPipe.ts","webpack:///./src/components/DrawingSurface.vue?0145","webpack:///./src/components/DrawingSurface.vue?3b98","webpack:///./src/components/CameraSurface.vue?7f23","webpack:///./src/components/CameraSurface.vue?8fa7","webpack:///./src/components/OnboardingUI.vue","webpack:///./src/components/elements/InstructionCarousel.vue","webpack:///./src/components/elements/InstructionCarousel.vue?eae7","webpack:///./src/components/elements/InstructionCarousel.vue?3dde","webpack:///./src/components/elements/GestureIcon.vue","webpack:///./src/components/elements/GestureIcon.vue?548f","webpack:///./src/components/elements/GestureIcon.vue?1324","webpack:///./src/components/OnboardingUI.vue?b3c5","webpack:///./src/components/OnboardingUI.vue?fcd3","webpack:///./src/components/screens/DanceMenu.vue","webpack:///./src/components/elements/LessonCard.vue","webpack:///./src/services/MotionDatabase.ts","webpack:///./src/components/elements/LessonCard.vue?090b","webpack:///./src/components/elements/LessonCard.vue?8b6b","webpack:///./src/components/elements/UploadCard.vue","webpack:///./src/components/elements/UploadCard.vue?311e","webpack:///./src/components/elements/UploadCard.vue?f397","webpack:///./src/components/screens/DanceMenu.vue?3ac9","webpack:///./src/components/screens/DanceMenu.vue?9623","webpack:///./src/components/screens/LearningScreen.vue","webpack:///./src/services/Constants.ts","webpack:///./src/model/DanceLesson.ts","webpack:///./src/services/ScreenRecorder.ts","webpack:///./src/services/MotionRecorder.ts","webpack:///./src/components/elements/SegmentedProgressBar.vue","webpack:///./src/components/elements/SegmentedProgressBar.vue?1c88","webpack:///./src/components/elements/SegmentedProgressBar.vue?1b9d","webpack:///./src/components/elements/PausingVideoPlayer.vue","webpack:///./src/components/elements/VideoPlayer.vue","webpack:///./src/services/PoseProvider.ts","webpack:///./src/components/elements/VideoPlayer.vue?e7d3","webpack:///./src/components/elements/VideoPlayer.vue?b67d","webpack:///./src/components/elements/PausingVideoPlayer.vue?fe03","webpack:///./src/components/elements/PausingVideoPlayer.vue?8e8a","webpack:///./src/components/elements/WebcamBox.vue","webpack:///./src/components/elements/WebcamBox.vue?0a4a","webpack:///./src/components/elements/WebcamBox.vue?e390","webpack:///./src/components/screens/LearningScreen.vue?7818","webpack:///./src/components/screens/LearningScreen.vue?9387","webpack:///./src/components/elements/WebcamPromptCard.vue","webpack:///./src/components/elements/WebcamPromptCard.vue?a879","webpack:///./src/components/screens/PoseDrawerTest.vue","webpack:///./src/components/screens/PoseDrawerTest.vue?af42","webpack:///./src/components/screens/PoseDrawerTest.vue?bc96","webpack:///./src/components/screens/CreateLessonScreen.vue","webpack:///./src/components/elements/ActivityVideoPlayer.vue","webpack:///./src/components/elements/ActivityVideoPlayer.vue?e80c","webpack:///./src/components/elements/ActivityVideoPlayer.vue?f161","webpack:///./src/components/screens/CreateLessonScreen.vue?a8e9","webpack:///./src/components/screens/CreateLessonScreen.vue?8b77","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?eabf","webpack:///./src/registerServiceWorker.ts","webpack:///./src/services/GestureDetection.ts","webpack:///./src/main.ts","webpack:///./src/components/elements/ActivityVideoPlayer.vue?ad66","webpack:///./src/components/OnboardingUI.vue?9114"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","map","webpackContext","req","id","webpackContextResolve","e","Error","code","keys","resolve","class","src","alt","poseDrawerSelected","danceSelected","createLessonSelected","state","State","DanceMenu","CreateLesson","motion","currentDance","goHome","PoseDrawingTester","ref","onTrackingAttained","background","OnboardingLoading","ui","LessonActive","target-dance","target-lesson","currentLesson","PromptStartWebcam","startWebcam","StartingWebcam","LoadingTracking","Onboarding","indexOf","WEBCAM_DIMENSIONS","freeze","width","height","recorder","mediaStream","activeConnections","Set","permissionState","isWebcamLoading","webcamError","isRecording","webcamStatus","this","readPermissionStatus","navigator","permissions","query","constraints","video","aspectRatio","frameRate","audio","mediaDevices","getUserMedia","videoE","add","console","log","srcObject","onloadedmetadata","play","delete","size","stopWebcam","stopRecording","getTracks","forEach","x","stop","rtc","type","startRecording","Promise","res","getBlob","saveBlob","defaultProvider","muted","style","enableDrawing","isActivelyTracking","EventNames","gesture","trackingProcessingStarted","trackingResults","trackingRequested","trackingRequestFinished","GestureNames","none","pointLeft","pointRight","namaste","eventHub","setupGestureListening","callbacks","fallback","onGesture","cb","on","off","setupMediaPipeListening","callback","onFrameProcessingStarted","TrackingActions","requestTracking","emit","endTrackingRequest","PoseLandmarks","nose","leftEyeInner","leftEye","leftEyeOuter","rightEyeInner","rightEye","rightEyeOuter","leftEar","rightEar","mouthLeft","mouthRight","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftPinky","rightPinky","leftIndex","rightIndex","leftThumb","rightThumb","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle","leftHeel","rightHeel","leftFootIndex","rightFootIndex","secs","setTimeout","filename","text","element","document","createElement","setAttribute","encodeURIComponent","display","body","appendChild","click","removeChild","onFrame","shouldRun","undefined","requestAnimationFrame","then","Utils","DoEveryFrame","replace","crypto","getRandomValues","Uint8Array","toString","obj","Date","copy","setTime","getTime","Array","isArray","len","deepCopy","typedObj","attrs","attr","val","usingHolistic","mp","HAND_LANDMARK_CONNECTIONS","HAND","THUMB_FINGER","INDEX_FINGER","MIDDLE_FINGER","RING_FINGER","PINKY_FINGER","CONNECTIONS_TO_DRAW","v0","v1","trackingStarted","DrawConnections","canvasCtx","landmarks","connections","w","canvas","h","beginPath","connection","p1","p2","moveTo","y","lineTo","stroke","restore","DrawPose","poseLandmarks","options","jointsWithEmphasis","emphasizedJoints","save","sourceAR","sourceAspectRatio","canvasAR","adjustedHeight","pixelsTaller","translate","adjustedWidth","pixelsWider","visibility","emphasized","emphasisStroke","strokeStyle","lineWidth","p1a","p1b","trackingRequests","trackingCount","filter","StartTracking","initial","mpInstance","Holistic","locateFile","file","Pose","setOptions","upperBodyOnly","smoothLandmarks","minDetectionConfidence","minTrackingConfidence","frameId","timestamp","now","onResults","send","image","isTracking","drawHandShape","results","rightHandLandmarks","lineCap","drawTrackingResults","enabled","detectedGesture","fadeTimeMs","trackingTimestamp","globalAlpha","props","Boolean","default","Number","setup","canvasE","mpResults","ges","getContext","newVals","clearRect","isEnabled","holisticResults","render","components","DrawingSurface","trackingIntervalId","hasStartedTracking","hasResults","timerId","setInterval","clearInterval","methods","startTracking","$refs","whenReady","readyState","connectVideoElement","instructions","gestureIcon","stage","OnboardingStage","done","skipOnboarding","tag","inst","sizeClass","tagClass","String","showIcon","iconClass","gestureImgSrc","GestureIcons","forward","backward","trySelectNext","trySelectPrevious","tryPerformPlay","InstructionCarousel","GestureIcon","ctx","output","instructs","advanceStage","motionList","dance","title","hover","hovering","selectedDance","videoSrc","uploadUIActive","$emit","danceLessonSelected","uploadAccept","onFilesSelected","uploadFiles","savingText","successText","autoplay","lessons","lesson","_id","header","lessonTitle","canCreateLesson","motionsMap","Map","motions","from","values","videoDatabase","videoEntry","set","clipName","clipPath","upsertLesson","source","customLessonCount","loadCustomLessons","lessonList","lessonIndex","findIndex","existingIndex","les","customLessonIds","MotionDatabase","getCustomLessonIdsList","countLoaded","custLesson","localStorage","getItem","JSON","parse","has","activities","setItem","stringify","custLessonIds","saveCustomLessonsIdsList","removeLesson","lessonIdIndex","removeItem","createBlankActivity","startTime","endTime","duration","demoVisual","userVisual","practiceSpeed","createBlankLesson","uuidv4","segmentBreaks","fps","db","computed","getLessons","emits","enctype","novalidate","isInitial","isSaving","isFailed","uploadFieldName","disabled","accept","uploadInstructions","uploadError","isSuccess","Status","Initial","Saving","Success","Failed","Function","currentStatus","reset","fileList","mounted","LessonCard","UploadCard","files","item","validateLesson","saveCustomLesson","aria-hidden","to","activityId","activityCount","max","activityTitle","videoTime","toFixed","maxHeight","activity","targetDance","onTimeChanged","onActivityFinished","onPauseHit","onPauseEnded","drawPoseLandmarks","videoOpacity","timedInstructions","activityFinished","staticInstruction","showPlayGestureIcon","segments","progressSegments","progress","gotoPreviousActivity","repeatActivity","playActivity","gotoNextActivity","hasNextActivity","isSavingFrames","startSaveFrames","canSaveFrame","Constants","DefaultPauseDuration","getDisplayMedia","captureStream","rej","recordingSessions","recordingSessionNextId","screenRecorder","userDims","demoDims","frameTimestamps","userDimension","userFrames","demoDimension","demoFrames","sessionId","userFrame","demoFrame","session","start","end","endRecording","recordedBlob","mSession","PromptDownloadFile","motionRecorder","segmentsData","seg","enableAll","cssClass","min","calculateProgressSegments","last","segs","segData","focusedSegments","cssClassOptions","videoBaseUrl","onProgress","onSegmentPlaybackCompleted","setDrawStyle","emphasizedJointStyle","videoUrl","scheduleCanvasResizing","endReported","poseFiles","videoName","poseFilename","cached","stored","PoseProvider","getPoseFile","poseFile","poses","convertToPoseList","url","fetch","response","ok","statusText","csv","temp","row","convertRow","startsWith","lms","parseFloat","poseProvider","onResize","modified","offsetWidth","offsetHeight","setupCanvasResizing","videoElement","canvasElement","resizeCanvas","addEventListener","removeEventListener","setupVideoPlaying","startProgressUpdating","playVideo","speed","pause","playbackRate","currentTime","error","pauseVideo","canvasModified","currentPose","frame","Math","floor","pose","prevTime","onTimeUpdated","vidElement","time","clearDrawing","drawCtx","drawPose","GetPose","getVideoDimensions","keepPlaying","getVideoTime","DEFAULT_PAUSE_DURATION","computePlaySegments","pauses","nextPauseIndex","prevIndex","pTime","pauseIndex","pi","segStartTime","VideoPlayer","videoPlayer","playTimeoutId","vidPlayer","clearTimeout","playSegment","delaySecs","emitResume","onPlayStart","playingSegments","playingSegmentIndex","playDelaySecs","nextSeg","manualResume","pauseDuration","disablePictureInPicture","webcamStartError","enableRecordButton","status","disconnectVideoElement","webcamProvider","ActivityPlayState","AwaitingPlayGesture","PendingStart","Playing","ActivityEnded","TRACKING_ID","setupFrameRecording","recordingSessionId","lastPose","saveMotionFrame","warn","startRecordingSession","concludeSaveFrames","sleep","endRecordingSession","SegmentedProgressBar","PausingVideoPlayer","WebcamBox","targetLesson","activityState","nextActivityTitle","nextActivity","pauseInstructs","instruction","mActivity","startInstruction","playingInstruction","endInstruction","activeTimedInstructions","ti","curActivity","vidActivity","forcePlay","startingNow","shouldPauseBeforeActivity","gotoActivity","delta","isTrackingUser","dropdownOpen","loadMotion","cPose","lm","index","LessonCreationState","SelectOpenState","lessonUnderConstruction","SelectOpenLesson","activeLessonSelectionIndex","canEditActiveLesson","startCreation","ModifyLesson","segBreak","step","newSegmentVal","addSegmentBreak","activeActivityIndex","selectActivity","addActivity","canDeleteLesson","deleteLesson","exportLesson","saveLesson","lessonInDatabase","activeActivity","activePauseIndex","selectPause","addPause","sortPauses","activeTimedInstructionIndex","selectTimedInstruction","addTimedInstruction","sortTimedInstructions","activePause","deletePause","activeTimedInstruction","deleteTimedInstruction","activityProgress","hasPreviousActivity","activityVideoPlayer","awaitingStart","playDemo","onPlaybackCompleted","AwaitingStart","defaultPauseDuration","newTime","concat","delay","ActivityVideoPlayer","newPauseTime","activeLessonSelection","hasLesson","lessonStartTime","lessonEndTime","acLes","typedMotion","asTemplate","existingLesson","targetIndex","newActivity","newPause","selectedPause","sort","a","b","newIndex","pauseObj","confirm","newInstruction","timedInstructs","selectedTimedInstruc","timedInstruction","tiIndex","breakTime","isNaN","newList","deleteCustomLesson","CameraSurface","OnboardingUI","LearningScreen","WebcamPromptCard","PoseDrawerTest","CreateLessonScreen","cameraSurface","hasCompletedOnboarding","camSurface","alert","ready","registered","updatefound","updated","offline","minDetectionVisibility","getAngle","lm0","lm1","atan2","dist","sqrt","getSum","input","reduce","midPoint","averageAngle","angles","arr","pop","sin","cos","isLine","angleTolerance","tolerance","PI","lastAngle","thisAngle","abs","detectHandPointingGestures","handLandmarks","FINGERS","FINGER_LANDMARKS","indices","areLines","finger","avgAngle","avgAngleDeg","detectPosePointingGestures","TOLERANCE","TOLERANCE_RADS","left","lelb","lwrist","ang","right","relb","rwrist","isNamasteGesture","IDs","poseLMs","areArmLandmarksVisible","downwards","leftForearmTargetAngle","rightForearmTargetAngle","elbowAngleTolerance","leftForearmAngle","rightForearmAngle","handNeckMinRelativeDist","shoulderDist","neckCenter","leftWristNeckDist","rightWristNeckDist","areHandsNearNeckBase","detectGesture","leftHandLandmarks","startGestureDetection","app","App","mount"],"mappings":"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","file":"js/app.9fef1383.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var map = {\n\t\"./backward.svg\": \"6218\",\n\t\"./forward.svg\": \"3b9e\",\n\t\"./play.svg\": \"5cd5\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"1942\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./VideoPlayer.vue?vue&type=style&index=0&id=8096110c&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./WebcamBox.vue?vue&type=style&index=0&id=584a541e&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./LearningScreen.vue?vue&type=style&index=0&id=9452b712&lang=scss\"","module.exports = __webpack_public_path__ + \"img/forward.e257a03f.svg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PoseDrawerTest.vue?vue&type=style&index=0&id=9399757c&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SegmentedProgressBar.vue?vue&type=style&index=0&id=5bf959ee&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./WebcamPromptCard.vue?vue&type=style&index=0&id=07a96404&lang=scss\"","module.exports = __webpack_public_path__ + \"img/play.8c9e21c7.svg\";","module.exports = __webpack_public_path__ + \"img/backward.434f566c.svg\";","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=01243361&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./UploadCard.vue?vue&type=style&index=0&id=4565a82c&lang=scss\"","module.exports = __webpack_public_path__ + \"img/tiktokdances.589b3b61.jpg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CreateLessonScreen.vue?vue&type=style&index=0&id=2ddc02e1&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DanceMenu.vue?vue&type=style&index=0&id=2d265ef0&lang=scss\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CameraSurface.vue?vue&type=style&index=0&id=556bdbf0&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./LessonCard.vue?vue&type=style&index=0&id=0310a410&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./InstructionCarousel.vue?vue&type=style&index=0&id=7f78f3d2&lang=scss\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DrawingSurface.vue?vue&type=style&index=0&id=002e5f90&lang=scss\"","<template>\n<div class=\"app\">\n   <div id=\"aboveSurface\" class=\"pb-4 pt-4\">\n     <span id=\"topbarLeft\"></span>\n     <span class=\"spacer\"></span>\n     <span id=\"topbarCenter\"></span>\n     <span class=\"spacer\"></span>\n     <span id=\"topbarRight\"></span>\n  </div>\n\n  <DanceMenu\n        v-show=\"state === State.DanceMenu\"\n        @pose-drawer-selected=\"poseDrawerSelected\"\n        @dance-selected=\"danceSelected\"\n        @create-lesson-selected=\"createLessonSelected\"\n      />\n\n  <CreateLessonScreen\n        v-if=\"state === State.CreateLesson\"\n          :motion=\"currentDance\"\n          @back-selected=\"goHome\"\n          @lesson-created=\"goHome\" />\n\n  <PoseDrawerTest\n        v-if=\"state === State.PoseDrawingTester\"\n        @back-selected=\"goHome\" />\n\n  <CameraSurface\n    ref=\"cameraSurface\"\n    @tracking-attained=\"onTrackingAttained()\"\n    v-show=\"[State.DanceMenu, State.CreateLesson, State.PoseDrawingTester].indexOf(state) === -1\">\n\n    <template v-slot:background>\n      <img v-show=\"state == State.OnboardingLoading\"\n      src=\"./assets/tiktokdances.jpg\"\n      alt=\"Background Image\">\n    </template>\n\n    <template v-slot:ui>\n\n      <LearningScreen v-if=\"state == State.LessonActive\"\n        :target-dance=\"currentDance\"\n        :target-lesson=\"currentLesson\"\n        @lesson-completed=\"goHome\"\n        @back-selected=\"goHome\"\n      />\n\n     <WebcamPromptCard v-if=\"state === State.PromptStartWebcam\"\n      @cancel-selected=\"state = State.DanceMenu\"\n      @startWebcamSelected=\"startWebcam\"\n     />\n\n      <div class=\"vcenter-parent\" v-if=\"state === State.StartingWebcam\">\n        <div class=\"translucent-text is-rounded has-text-centered\">\n          <div class=\"content\">\n            <h3 class=\"has-text-white m-2\">Starting Webcam...</h3>\n          </div>\n          <div class=\"loader-progress loader is-loading mt-5 mb-5\"></div>\n        </div>\n      </div>\n\n      <div class=\"vcenter-parent\" v-if=\"state === State.LoadingTracking\">\n        <div class=\"translucent-text is-rounded has-text-centered\">\n          <div class=\"content has-text-white m-2 has-text-centered\">\n            <h3 class=\"has-text-white\">Starting Gestures...</h3>\n          </div>\n          <div class=\"loader-progress loader is-loading mt-5 mb-5\"></div>\n        </div>\n      </div>\n\n      <OnboardingUI v-if=\"state == State.Onboarding\"\n        @onboarding-complete=\"state= State.LessonActive \"/>\n    </template>\n\n  </CameraSurface>\n  <div id=\"belowSurface\"></div>\n</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, nextTick, ref } from 'vue';\nimport webcamProvider from '@/services/WebcamProvider';\nimport { DatabaseEntry } from '@/services/MotionDatabase';\nimport CameraSurface from './components/CameraSurface.vue';\nimport OnboardingUI from './components/OnboardingUI.vue';\nimport DanceMenu from './components/screens/DanceMenu.vue';\nimport LearningScreen from './components/screens/LearningScreen.vue';\nimport DanceLesson from './model/DanceLesson';\nimport WebcamPromptCard from './components/elements/WebcamPromptCard.vue';\n\nimport PoseDrawerTest from './components/screens/PoseDrawerTest.vue';\nimport CreateLessonScreen from './components/screens/CreateLessonScreen.vue';\n\nconst State = {\n  DanceMenu: 'DanceMenu',\n  PromptStartWebcam: 'PromptStartWebcam',\n  StartingWebcam: 'StartingWebcam',\n  LoadingTracking: 'LoadingTracking',\n  Onboarding: 'Onboarding',\n  LessonActive: 'LessonActive',\n  PoseDrawingTester: 'PoseDrawingTester',\n  CreateLesson: 'CreateLesson',\n};\n\nexport default defineComponent({\n  name: 'App',\n  components: {\n    CameraSurface,\n    OnboardingUI,\n    DanceMenu,\n    LearningScreen,\n    WebcamPromptCard,\n    PoseDrawerTest,\n    CreateLessonScreen,\n  },\n  setup() {\n    const state = ref(State.DanceMenu);\n    const cameraSurface = ref(null as typeof CameraSurface | null);\n    const hasCompletedOnboarding = ref(false);\n\n    const currentDance = ref(null as DatabaseEntry | null);\n    const currentLesson = ref(null as DanceLesson | null);\n\n    function danceSelected(dance: DatabaseEntry, lesson: DanceLesson) {\n      currentDance.value = dance;\n      currentLesson.value = lesson;\n\n      if (webcamProvider.webcamStatus.value === 'running') state.value = State.LessonActive;\n      else state.value = State.PromptStartWebcam;\n    }\n\n    function goHome() {\n      state.value = State.DanceMenu;\n      currentDance.value = null;\n      currentLesson.value = null;\n    }\n\n    async function startTracking() {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      nextTick(() => {\n        const camSurface: any = cameraSurface.value;\n        state.value = State.LoadingTracking;\n        camSurface.startTracking();\n      });\n    }\n\n    async function startWebcam() {\n      console.log('Starting Webcam');\n\n      if (webcamProvider.webcamStatus.value !== 'running') {\n        state.value = State.StartingWebcam;\n\n        try {\n          await webcamProvider.startWebcam();\n        } catch (e) {\n          console.error('Error starting webcam: ', e);\n          // eslint-disable-next-line no-alert\n          alert('Failed to start the webcam\\n\\nPlease ensure this is the only app using the camera and that you\\'ve allowed camera access in your browser.');\n          state.value = State.DanceMenu;\n          return;\n        }\n      }\n\n      state.value = State.LoadingTracking;\n      try {\n        await startTracking();\n      } catch (e) {\n        console.error(\"Couldn't start tracking\", e);\n      }\n    }\n\n    function onTrackingAttained() {\n      console.log('Tracking attained');\n      if (hasCompletedOnboarding.value) {\n        state.value = State.LessonActive;\n      } else state.value = State.Onboarding;\n    }\n\n    return {\n      currentDance,\n      currentLesson,\n      danceSelected,\n      goHome,\n      startWebcam,\n      onTrackingAttained,\n      state,\n      cameraSurface,\n      State,\n    };\n  },\n  methods: {\n    poseDrawerSelected() {\n      this.state = State.PoseDrawingTester;\n    },\n    createLessonSelected(dance: DatabaseEntry) {\n      this.currentDance = dance;\n      this.state = State.CreateLesson;\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\nbody, html {\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  background-color: #00d1b2;\n  // background-image: linear-gradient(45deg, #00d1b2 0%, #3475da 100%);\n\n  // background-color: #FF9A8B;\n  // background-image: linear-gradient(135deg, #B721FF 0%, #145eb3 100%);\n\n  background-image: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);\n\n  background-size: 100vw 100vh;\n  background-attachment: fixed;\n}\n\n.card {\n  display: inline-block;\n  max-width: 90%;\n}\n\n.vcenter-parent {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n\n.loader-progress {\n  width: 100px;\n  height: 100px;\n  margin: auto;\n}\n\n#aboveSurface {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n\n  span {\n    flex: 0 0 auto;\n  }\n  .spacer {\n    flex: 1 1 0;\n  }\n\n  width: 1280px;\n  margin: auto;\n}\n\n#belowSurface {\n  width: 1280px;\n  margin: auto;\n}\n\n#topbarLeft, #topbarRight, #topbarCenter {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.background-blur {\n  backdrop-filter: blur(4px);\n  background: rgba(0, 0, 0, 0.75);\n}\n\n.translucent-text {\n  backdrop-filter: blur(4px);\n  color: white;\n  padding: 10px 20px;\n  background: rgba(0, 0, 0, 0.55);\n}\n\n.translucent-text.is-rounded {\n  border-radius: 0.25rem;\n}\n\n.is-slightly-rounded {\n  border-radius: 0.25rem;\n}\n\n</style>\n","import RecordRTC, { invokeSaveAsDialog } from 'recordrtc';\n\nimport { computed, ref, Ref } from 'vue';\n\nexport const WEBCAM_DIMENSIONS = Object.freeze({\n  width: 640,\n  height: 480,\n});\n\nexport class WebcamProvider {\n\n  // Recorder class\n  private recorder = ref(null as null | RecordRTC);\n\n  // The actual media stream\n  private mediaStream = ref(null as null | MediaStream);\n\n  // List of active connections. Used so we know when to pause the webcam\n  private activeConnections: Set<HTMLVideoElement> = new Set();\n\n  private permissionState: Ref<PermissionState> = ref('prompt');\n\n  private isWebcamLoading = ref(false);\n\n  public webcamError = ref(null as any);\n\n  public isRecording = ref(false);\n\n  constructor() {\n    this.readPermissionStatus();\n  }\n\n  private async readPermissionStatus(): Promise<void> {\n    if (navigator.permissions) {\n      try {\n        const result = await navigator.permissions.query({ name: 'camera' });\n        this.permissionState.value = result.state;\n\n        // eslint-disable-next-line no-empty\n      } catch { }\n    }\n  }\n\n  public permissionStatus(): Ref<PermissionState> {\n    return this.permissionState;\n  }\n\n  public async startWebcam(): Promise<void> {\n    if (this.mediaStream.value || this.isWebcamLoading.value) {\n      return;\n    }\n    this.isWebcamLoading.value = true;\n\n    try {\n      const constraints: MediaStreamConstraints = {\n        video: {\n          // facingMode: 'user',\n          width: WEBCAM_DIMENSIONS.width,\n          height: WEBCAM_DIMENSIONS.height,\n          aspectRatio: 1.777777778,\n          frameRate: 30,\n        },\n        audio: true,\n      };\n\n      if (!navigator.mediaDevices?.getUserMedia) throw new Error(\"Browser doesn't support webcam\");\n\n      this.mediaStream.value = await navigator.mediaDevices.getUserMedia(constraints);\n\n      this.permissionState.value = 'granted';\n    } finally {\n      this.isWebcamLoading.value = false;\n    }\n  }\n\n  public webcamStatus = computed(() => {\n    if (this.mediaStream.value) return 'running';\n    if (this.isWebcamLoading.value) return 'loading';\n    return 'stopped';\n  });\n\n  public async connectVideoElement(videoE: HTMLVideoElement): Promise<void> {\n\n    if (this.permissionState.value !== 'granted') throw new Error(\"Doesn't have permissions yet!\");\n\n    this.activeConnections.add(videoE);\n\n    // eslint-disable-next-line no-param-reassign\n    console.log('Connecting media stream to video');\n    videoE.srcObject = this.mediaStream.value;\n    videoE.onloadedmetadata = () => {\n      videoE.play();\n      console.log('Connected media stream to video');\n    };\n  }\n\n  public disconnectVideoElement(videoE: HTMLVideoElement): void {\n    this.activeConnections.delete(videoE);\n\n    videoE.srcObject = null;\n\n    if (this.activeConnections.size === 0 && !this.recorder) {\n      this.stopWebcam();\n    }\n  }\n\n  public async stopWebcam(): Promise<void> {\n    if (this.recorder) {\n      try {\n        await this.stopRecording();\n        // eslint-disable-next-line no-empty\n      } catch { }\n    }\n\n    if (this.mediaStream.value) {\n      this.mediaStream.value.getTracks().forEach((x) => x.stop());\n    }\n    this.mediaStream.value = null;\n  }\n\n  public async startRecording(): Promise<void> {\n    if (this.recorder.value || this.isRecording.value) {\n      return;\n    }\n\n    if (!this.mediaStream.value) {\n      throw new Error('Webcam must be started before recording can happen');\n    }\n\n    this.isRecording.value = true;\n\n    const rtc = new RecordRTC(this.mediaStream.value, {\n      type: 'video',\n    });\n    rtc.startRecording();\n    this.recorder.value = rtc;\n  }\n\n  public async stopRecording(): Promise<Blob> {\n\n    return new Promise((res) => {\n      if (!this.recorder.value) throw new Error(\"Haven't started recording\");\n      this.isRecording.value = false;\n      const recorder = this.recorder.value;\n      this.recorder.value.stopRecording(() => {\n        res(recorder.getBlob());\n        this.recorder.value = null;\n      });\n    });\n  }\n\n  public async clearRecording(): Promise<void> {\n    // TODO: pay attention to status of recording\n    // this.recorder?.stopRecording();\n    this.recorder.value = null;\n  }\n\n  // public async postFiles(url: string, filename: string): Promise<void> {\n  //   if (!this.recorder) throw new Error('Nothing to post');\n\n  //   const blob = this.recorder.getBlob();\n  //   invokeSaveAsDialog(blob, filename);\n\n  //   const fname = `${filename}.webm`;\n\n  //   const file = new File([blob], fname, {\n  //     type: 'video/webm',\n  //   });\n\n  // videoElement.src = '';\n  // videoElement.srcObject = null;\n\n  // if (mediaStream) { mediaStream.stop(); }\n  // }\n}\n\nexport const saveBlob = invokeSaveAsDialog;\n\nconst defaultProvider = new WebcamProvider();\n\nexport default defaultProvider;\n","<template>\n  <div ref=\"canvasBackground\" class=\"surface-container is-slightly-rounded\">\n\n    <div class=\"overlay overlay-background\">\n      <slot name=\"background\"></slot>\n    </div>\n\n    <video\n      class=\"mirrored is-slightly-rounded\"\n      ref=\"videoE\"\n      muted\n      :style=\"{\n        height: '720px',\n        width: '1280px',\n      }\"\n    ></video>\n\n    <div class=\"overlay\">\n      <slot name=\"ui\"></slot>\n    </div>\n\n    <DrawingSurface\n      :enableDrawing=\"isActivelyTracking\"\n      ref=\"drawingSurface\"\n      class=\"overlay\"/>\n  </div>\n</template>\n\n<script lang=\"ts\">\n\nimport {\n  defineComponent, onBeforeUnmount, onMounted, onUpdated, ref,\n} from 'vue';\nimport webcamProvider from '@/services/WebcamProvider';\nimport { setupMediaPipeListening } from '@/services/EventHub';\nimport { MpHolisticResults } from '@/services/MediaPipeTypes';\nimport DrawingSurface from './DrawingSurface.vue';\nimport { isTracking as mpIsTracking, StartTracking } from '../services/MediaPipe';\n\nexport default defineComponent({\n  name: 'CameraSurface',\n  components: {\n    DrawingSurface,\n  },\n  data() {\n    return {\n      trackingIntervalId: -1,\n    };\n  },\n  setup(props, { emit }) {\n    // const { enableDrawing } = toRefs(props);\n    const hasStartedTracking = ref(false);\n    const isActivelyTracking = ref(false);\n    const hasResults = ref(false);\n    const trackingResults = ref({});\n\n    let timerId = -1;\n    onMounted(() => {\n      timerId = setInterval(() => {\n        isActivelyTracking.value = mpIsTracking();\n      }, 500);\n    });\n    onBeforeUnmount(() => {\n      clearInterval(timerId);\n    });\n\n    function onResults(results: MpHolisticResults) {\n      if (!hasResults.value) {\n        emit('tracking-attained');\n        console.log('Got Results', results);\n        hasResults.value = true;\n      }\n      trackingResults.value = results;\n      // this.$refs.drawingSurface.draw(results, canvasCtx);\n    }\n\n    setupMediaPipeListening(onResults);\n\n    return {\n      hasStartedTracking,\n      isActivelyTracking,\n      hasResults,\n      trackingResults,\n    };\n  },\n  methods: {\n    startTracking() {\n      if (this.trackingIntervalId !== -1) return;\n\n      const videoE = this.$refs.videoE as HTMLVideoElement;\n      const whenReady = () => {\n        if (this.hasStartedTracking) return;\n        this.hasStartedTracking = true;\n        console.log('Video loaded. Starting tracking...');\n\n        StartTracking(\n            this.$refs.videoE as HTMLVideoElement,\n        );\n\n        videoE.onloadedmetadata = null;\n      };\n\n      this.trackingIntervalId = setInterval(() => {\n\n        if (this.hasStartedTracking) {\n          clearInterval(this.trackingIntervalId);\n          this.trackingIntervalId = -1;\n        }\n\n        if (videoE.readyState === 4) {\n          whenReady();\n          return;\n        }\n\n        console.log('Video not ready, will start tracking when loaded.');\n      }, 100);\n\n      webcamProvider.connectVideoElement(videoE);\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n.surface-container {\n  position: relative;\n  margin: auto;\n  width: 1280px;\n  height: 720px;\n  box-sizing: content-box;\n  text-align: center;\n\n  background: rgba(0, 0, 0, 0.3);\n\n  .overlay {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n  }\n\n  .overlay.overlay-bottom {\n    top: auto;\n  }\n  .overlay.overlay-left {\n    right: auto;\n  }\n  .overlay.overlay-right {\n    left: auto;\n  }\n  .overlay.overlay-top {\n    bottom: auto;\n  }\n}\n\n.mirrored {\n  transform: scaleX(-1);\n}\n\n// .overlay-background {\n//   z-index: -1;\n// }\n\n</style>\n","import { TinyEmitter } from 'tiny-emitter';\nimport { onMounted, onBeforeUnmount } from 'vue';\nimport { MpHolisticResults } from './MediaPipeTypes';\n\nexport const EventNames = Object.freeze({\n  gesture: 'gesture',\n  trackingProcessingStarted: 'trackingProcessingStarted',\n  trackingResults: 'trackingResults',\n  trackingRequested: 'trackingRequested',\n  trackingRequestFinished: 'trackingRequestFinished',\n});\n\nexport const GestureNames = Object.freeze({\n  none: 'none',\n  pointLeft: 'point-left',\n  pointRight: 'point-right',\n  namaste: 'namaste',\n});\n\nconst eventHub = new TinyEmitter();\n\nexport function setupGestureListening(\n  callbacks: Record<string, (trackingResults?: MpHolisticResults | undefined) => void>,\n  fallback?: undefined | ((gesture: string, trackingResults: MpHolisticResults) => void),\n) {\n  function onGesture(gesture: string, trackingResults: MpHolisticResults) {\n    const cb = callbacks[gesture];\n    if (cb) cb(trackingResults);\n\n    if (!cb && fallback) fallback(gesture, trackingResults);\n  }\n  onMounted(() => {\n    eventHub.on(EventNames.gesture, onGesture);\n  });\n  onBeforeUnmount(() => {\n    eventHub.off(EventNames.gesture, onGesture);\n  });\n}\n\nexport function setupMediaPipeListening(\n  callback: (res: MpHolisticResults, frameId?: number) => void,\n  onFrameProcessingStarted?: (frameId: number) => void,\n) {\n\n  onMounted(() => {\n    eventHub.on(EventNames.trackingResults, callback);\n    if (onFrameProcessingStarted) eventHub.on(EventNames.trackingProcessingStarted, onFrameProcessingStarted);\n  });\n  onBeforeUnmount(() => {\n    eventHub.off(EventNames.trackingResults, callback);\n    if (onFrameProcessingStarted) eventHub.off(EventNames.trackingProcessingStarted, onFrameProcessingStarted);\n  });\n}\n\nexport const TrackingActions = Object.freeze({\n  requestTracking: (id: string) => {\n    eventHub.emit(EventNames.trackingRequested, id);\n  },\n  endTrackingRequest: (id: string) => {\n    eventHub.emit(EventNames.trackingRequestFinished, id);\n  },\n});\n\nexport default eventHub;\n","<template>\n  <canvas ref=\"canvasE\" width=\"1280\" height=\"720\" class=\"drawCanvas\"></canvas>\n</template>\n\n<script lang=\"ts\">\n\nimport {\n  ref, defineComponent, watch, toRefs, onMounted, Ref,\n} from 'vue';\nimport { WEBCAM_DIMENSIONS } from '@/services/WebcamProvider';\nimport { GestureNames, setupGestureListening } from '../services/EventHub';\n\nimport { MpHolisticResults } from '../services/MediaPipeTypes';\nimport {\n  HAND_LANDMARK_CONNECTIONS, DrawConnections, DrawPose,\n} from '../services/MediaPipe';\n\nfunction drawHandShape(results: MpHolisticResults, canvasCtx: CanvasRenderingContext2D) {\n  if (!results.rightHandLandmarks) {\n    return;\n  }\n\n  canvasCtx.save();\n\n  /* eslint-disable no-param-reassign */\n  canvasCtx.strokeStyle = 'white';\n  canvasCtx.lineWidth = 3.0;\n  canvasCtx.lineCap = 'round';\n\n  DrawConnections(canvasCtx, results.rightHandLandmarks, HAND_LANDMARK_CONNECTIONS);\n  canvasCtx.restore();\n}\n\nfunction drawTrackingResults(\n  enabled: boolean,\n  detectedGesture: string,\n  results: MpHolisticResults,\n  fadeTimeMs: number,\n  canvasCtx: CanvasRenderingContext2D,\n) {\n  if (!enabled) return;\n\n  const sourceAR = (results.image?.width ?? WEBCAM_DIMENSIONS.width)\n                   / (results.image?.height ?? WEBCAM_DIMENSIONS.height);\n\n  canvasCtx.save();\n  const trackingTimestamp = results.timestamp ?? Date.now();\n  canvasCtx.globalAlpha = 1 - (Date.now() - trackingTimestamp) / fadeTimeMs;\n\n  if (results.poseLandmarks) {\n    DrawPose(canvasCtx, results.poseLandmarks, {\n      sourceAspectRatio: sourceAR,\n    });\n  }\n  if (detectedGesture !== GestureNames.none) drawHandShape(results, canvasCtx);\n  canvasCtx.restore();\n}\n\nexport default defineComponent({\n  name: 'DrawingSurface',\n  props: {\n    enableDrawing: {\n      type: Boolean,\n      default: true,\n    },\n    fadeTimeMs: {\n      type: Number,\n      default: 1000,\n    },\n  },\n  setup(props) {\n    const { enableDrawing, fadeTimeMs } = toRefs(props);\n\n    const canvasE = ref(null) as unknown as Ref<HTMLCanvasElement>;\n    const gesture = ref(GestureNames.none);\n    const mpResults = ref({} as MpHolisticResults);\n\n    setupGestureListening({},\n      (ges, trackingResults) => {\n        gesture.value = ges;\n        mpResults.value = trackingResults;\n        // console.log('Drawing surface: recvived tracking results', ges, trackingResults);\n      });\n\n    onMounted(() => {\n      const canvas = canvasE.value;\n      const canvasCtx = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n      canvasCtx.strokeStyle = 'rgba(200, 250, 200, 0.75)';\n      canvasCtx.lineWidth = 6;\n      canvasCtx.lineCap = 'round';\n    });\n\n    watch([enableDrawing, mpResults, gesture], (newVals) => {\n      const canvas = canvasE.value;\n      const canvasCtx = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n      canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n\n      const isEnabled = newVals[0];\n      const holisticResults = newVals[1];\n      const detectedGesture = newVals[2];\n\n      drawTrackingResults(\n        isEnabled as unknown as boolean,\n        detectedGesture as unknown as string,\n        holisticResults as unknown as MpHolisticResults,\n        fadeTimeMs.value,\n        canvasCtx,\n      );\n    });\n\n    return {\n      canvasE,\n      gesture,\n      mpResults,\n    };\n  },\n});\n\n</script>\n\n<style lang=\"scss\">\n\n$pointer-size: 64px;\n\n.drawCanvas {\n  transform: scaleX(-1);\n  pointer-events: none;\n}\n\n.pointer-container {\n  position: fixed;\n  // transition: top .1s, left .1s;\n\n  img {\n    position: relative;\n    left: -$pointer-size / 2;\n    top: -32px;\n    width: 64px;\n    height: 64px;\n  }\n}\n\n</style>\n","// Inspired from https://gist.github.com/TheJLifeX/74958cc59db477a91837244ff598ef4a\n\nexport type Landmark = {\n  x: number;\n  y: number;\n  z?: number;\n  visibility?: number;\n}\n\nexport type MpHolisticResults = {\n  image?: any;\n  timestamp?: number;\n  faceLandmarks?: Array<Landmark>;\n  poseLandmarks?: Array<Landmark>;\n  rightHandLandmarks?: Array<Landmark>;\n  leftHandLandmarks?: Array<Landmark>;\n}\nexport const HandLandmarks = {\n  wrist: 0,\n  thumbCMC: 1,\n  thumbMCP: 2,\n  thumbIP: 3,\n  thumbTIP: 4,\n  indexMCP: 5,\n  indexPIP: 6,\n  indexDIP: 7,\n  indexTIP: 8,\n  middleMCP: 9,\n  middlePIP: 10,\n  middleDIP: 11,\n  middleTIP: 12,\n  ringMCP: 13,\n  ringPIP: 14,\n  ringDIP: 15,\n  ringTIP: 16,\n  pinkyMCP: 17,\n  pinkyPIP: 18,\n  pinkyDIP: 19,\n  pinkyTIP: 20,\n};\n\nexport const PoseLandmarks = {\n  nose: 0,\n  leftEyeInner: 1,\n  leftEye: 2,\n  leftEyeOuter: 3,\n  rightEyeInner: 4,\n  rightEye: 5,\n  rightEyeOuter: 6,\n  leftEar: 7,\n  rightEar: 8,\n  mouthLeft: 9,\n  mouthRight: 10,\n  leftShoulder: 11,\n  rightShoulder: 12,\n  leftElbow: 13,\n  rightElbow: 14,\n  leftWrist: 15,\n  rightWrist: 16,\n  leftPinky: 17,\n  rightPinky: 18,\n  leftIndex: 19,\n  rightIndex: 20,\n  leftThumb: 21,\n  rightThumb: 22,\n  leftHip: 23,\n  rightHip: 24,\n  leftKnee: 25,\n  rightKnee: 26,\n  leftAnkle: 27,\n  rightAnkle: 28,\n  leftHeel: 29,\n  rightHeel: 30,\n  leftFootIndex: 31,\n  rightFootIndex: 32,\n};\n","//\n// Utils.ts\n//\n\nexport default class Utils {\n\n  static sleep(secs: number): Promise<void> {\n    return new Promise((res) => setTimeout(res, secs * 1000));\n  }\n\n  static PromptDownloadFile(filename: string, text: string) {\n    const element = document.createElement('a');\n    element.setAttribute('href', `data:text/plain;charset=utf-8,${encodeURIComponent(text)}`);\n    element.setAttribute('download', filename);\n    element.style.display = 'none';\n\n    document.body.appendChild(element);\n    element.click();\n\n    document.body.removeChild(element);\n  }\n\n  // static CaptureVideoImage(videoE: HTMLVideoElement) {\n  //   const canvas = document.createElement('canvas');\n  //   canvas.style.display = 'none';\n  //   document.appendChild(canvas);\n  //   canvas.width = videoE.width;\n  //   canvas.height = videoE.height;\n  //   const ctx = canvas.getContext('2d')!;\n\n  //   ctx.drawImage(videoE, 0, 0, videoE.width, videoE.height);\n  // }\n\n  static DoEveryFrame(\n    onFrame: () => Promise<void>,\n    shouldRun?: () => boolean,\n  ) {\n\n    if (shouldRun !== undefined && !shouldRun()) {\n      requestAnimationFrame(() => {\n        Utils.DoEveryFrame(onFrame);\n      });\n    } else {\n      requestAnimationFrame(() => {\n        onFrame().then(() => {\n          Utils.DoEveryFrame(onFrame);\n        });\n      });\n    }\n  }\n\n  static uuidv4() {\n    // eslint-disable-next-line no-bitwise, no-mixed-operators, space-infix-ops\n    return (`${1e7}-${1e3}-${4e3}-${8e3}-${1e11}`).replace(/[018]/g, (c: any) => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));\n  }\n\n  static deepCopy<T>(obj: T): T {\n\n    // Handle the 3 simple types, and null or undefined\n    if (obj === null || undefined === obj || typeof obj !== 'object') {\n      return obj;\n    }\n\n    if (obj instanceof Date) {\n      const copy = new Date();\n      copy.setTime(obj.getTime());\n      return copy as unknown as T;\n    }\n\n    if (Array.isArray(obj)) {\n      const len = obj.length;\n      const copy = new Array(len);\n      for (let i = 0; i < len; i += 1) {\n        copy[i] = Utils.deepCopy(obj[i]);\n      }\n      return copy as unknown as T;\n    }\n\n    if (typeof obj === 'object') {\n      const typedObj = obj as any;\n      const copy = {} as any;\n      const attrs = Object.keys(typedObj);\n      for (let i = 0; i < attrs.length; i += 1) {\n        const attr = attrs[i];\n        const val = typedObj[attr];\n        // eslint-disable-next-line no-prototype-builtins\n        if (typedObj.hasOwnProperty(attr)) copy[attr] = Utils.deepCopy(val);\n      }\n      return copy;\n    }\n\n    throw new Error(`Unable to copy object ${obj}! It's type isn't supported`);\n  }\n}\n","/* eslint-disable no-multi-spaces */\n/* eslint-disable @typescript-eslint/no-var-requires */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable import/prefer-default-export */\nimport { Landmark, MpHolisticResults, PoseLandmarks } from './MediaPipeTypes';\nimport eventHub, { EventNames } from './EventHub';\nimport Utils from './Utils';\n\nexport const usingHolistic = false;\n\nlet mp: any = null;\n// eslint-disable-next-line global-require\nif (usingHolistic) mp = require('@mediapipe/holistic/holistic');\n// eslint-disable-next-line global-require\nelse mp = require('@mediapipe/pose/pose');\n\nexport const HAND_LANDMARK_CONNECTIONS = [\n  [0, 1], [1, 2], [2, 3], [3, 4], // Thumb\n  [0, 5], [5, 6], [6, 7], [7, 8], // Index\n  [5, 9], [9, 10], [10, 11], [11, 12], // Middle\n  [9, 13], [13, 14], [14, 15], [15, 16], // Ring\n  [0, 17], [13, 17], [17, 18], [18, 19], [19, 20], // Pinky\n];\n\nexport const HAND = {\n  THUMB_FINGER: [1, 2, 3, 4],\n  INDEX_FINGER: [5, 6, 7, 8],\n  MIDDLE_FINGER: [9, 10, 11, 12],\n  RING_FINGER: [13, 14, 15, 16],\n  PINKY_FINGER: [17, 18, 19, 20],\n};\n\nconst CONNECTIONS_TO_DRAW = [\n  { v0: PoseLandmarks.leftWrist,    v1: PoseLandmarks.leftPinky,      size: 1.0 },\n  { v0: PoseLandmarks.rightWrist,   v1: PoseLandmarks.rightPinky,     size: 1.0 },\n  { v0: PoseLandmarks.leftWrist,    v1: PoseLandmarks.leftThumb,      size: 1.0 },\n  { v0: PoseLandmarks.rightWrist,   v1: PoseLandmarks.rightThumb,     size: 1.0 },\n  { v0: PoseLandmarks.leftIndex,    v1: PoseLandmarks.leftWrist,      size: 1.0 },\n  { v0: PoseLandmarks.rightIndex,   v1: PoseLandmarks.rightWrist,     size: 1.0 },\n  { v0: PoseLandmarks.leftWrist,    v1: PoseLandmarks.leftElbow,      size: 1.1 },\n  { v0: PoseLandmarks.rightWrist,   v1: PoseLandmarks.rightElbow,     size: 1.1 },\n  { v0: PoseLandmarks.leftElbow,    v1: PoseLandmarks.leftShoulder,   size: 1.3 },\n  { v0: PoseLandmarks.rightElbow,   v1: PoseLandmarks.rightShoulder,  size: 1.3 },\n  { v0: PoseLandmarks.leftShoulder, v1: PoseLandmarks.rightShoulder,  size: 2.0 },\n  { v0: PoseLandmarks.leftHip,      v1: PoseLandmarks.leftShoulder,   size: 1.7 },\n  { v0: PoseLandmarks.rightHip,     v1: PoseLandmarks.rightShoulder,  size: 1.7 },\n  { v0: PoseLandmarks.leftHip,      v1: PoseLandmarks.rightHip,       size: 1.7 },\n  { v0: PoseLandmarks.leftHip,      v1: PoseLandmarks.leftKnee,       size: 1.5 },\n  { v0: PoseLandmarks.rightHip,     v1: PoseLandmarks.rightKnee,      size: 1.5 },\n  { v0: PoseLandmarks.leftKnee,     v1: PoseLandmarks.leftAnkle,      size: 1.4 },\n  { v0: PoseLandmarks.rightKnee,    v1: PoseLandmarks.rightAnkle,     size: 1.4 },\n  { v0: PoseLandmarks.leftAnkle,    v1: PoseLandmarks.leftHeel,       size: 1.0 },\n  { v0: PoseLandmarks.rightAnkle,   v1: PoseLandmarks.rightHeel,      size: 1.0 },\n  { v0: PoseLandmarks.leftHeel,     v1: PoseLandmarks.leftFootIndex,  size: 1.0 },\n  { v0: PoseLandmarks.rightHeel,    v1: PoseLandmarks.rightFootIndex, size: 1.0 },\n  { v0: PoseLandmarks.leftAnkle,    v1: PoseLandmarks.leftFootIndex,  size: 1.0 },\n  { v0: PoseLandmarks.rightAnkle,   v1: PoseLandmarks.rightFootIndex, size: 1.0 },\n  { v0: PoseLandmarks.nose,         v1: PoseLandmarks.rightEye,       size: 1.0 },\n  { v0: PoseLandmarks.nose,         v1: PoseLandmarks.leftEye,        size: 1.0 },\n];\n\nlet trackingStarted = false;\n\nexport function DrawConnections(\n  canvasCtx: CanvasRenderingContext2D,\n  landmarks: Array<Landmark>,\n  connections: Array<Array<number>>,\n) {\n  const w = canvasCtx.canvas.width;\n  const h = canvasCtx.canvas.height;\n\n  canvasCtx.beginPath();\n  connections.forEach((connection) => {\n    const p1 = landmarks[connection[0]];\n    const p2 = landmarks[connection[1]];\n\n    if (!p1 || !p2) return;\n\n    canvasCtx.moveTo(p1.x * w, p1.y * h);\n    canvasCtx.lineTo(p2.x * w, p2.y * h);\n  });\n\n  canvasCtx.stroke();\n  canvasCtx.restore();\n}\n\nexport function DrawPose(\n  canvasCtx: CanvasRenderingContext2D,\n  poseLandmarks: Landmark[],\n  options?: {\n    sourceAspectRatio?: number;\n    emphasizedJoints?: number[];\n    emphasisStroke? : string;\n  },\n) {\n\n  if (poseLandmarks.length === 0) {\n    return;\n  }\n\n  const jointsWithEmphasis = options?.emphasizedJoints;\n\n  canvasCtx.save();\n  let w = canvasCtx.canvas.width;\n  let h = canvasCtx.canvas.height;\n\n  const sourceAR = options?.sourceAspectRatio;\n  if (sourceAR) {\n    const canvasAR = canvasCtx.canvas.width / canvasCtx.canvas.height;\n\n    if (sourceAR > canvasAR) {\n      // video source is wider than canvas\n      const adjustedHeight = w / sourceAR;\n      const pixelsTaller = h - adjustedHeight;\n      canvasCtx.translate(0, pixelsTaller / 2);\n      h = adjustedHeight;\n\n    } else if (sourceAR < canvasAR) {\n      // video source is taller than canvas\n      const adjustedWidth = sourceAR * h;\n      const pixelsWider = w - adjustedWidth;\n      canvasCtx.translate(pixelsWider / 2, 0);\n      w = adjustedWidth;\n    }\n  }\n\n  CONNECTIONS_TO_DRAW.forEach((connection) => {\n    const p1 = poseLandmarks[connection.v0];\n    const p2 = poseLandmarks[connection.v1];\n\n    if (!p1 || !p2) return;\n    if ((p1.visibility ?? 1) < 0.5 || (p2.visibility ?? 1) < 0.5) {\n      // console.log('skipping b/c of insufficient visibility');\n      return;\n    }\n\n    const emphasized = jointsWithEmphasis\n    && jointsWithEmphasis.indexOf(connection.v0) !== -1\n    && jointsWithEmphasis.indexOf(connection.v1) !== -1;\n\n    canvasCtx.save();\n    if (emphasized && options?.emphasisStroke) {\n      canvasCtx.strokeStyle = options.emphasisStroke;\n    }\n    canvasCtx.lineWidth *= connection.size;\n    canvasCtx.beginPath();\n    canvasCtx.moveTo(p1.x * w, p1.y * h);\n    canvasCtx.lineTo(p2.x * w, p2.y * h);\n    canvasCtx.stroke();\n    canvasCtx.restore();\n  });\n\n  const p1a = poseLandmarks[PoseLandmarks.leftShoulder];\n  const p1b = poseLandmarks[PoseLandmarks.rightShoulder];\n  const p2 = poseLandmarks[PoseLandmarks.nose];\n  if (!p1a || !p1b || !p2) {\n    canvasCtx.beginPath();\n    canvasCtx.moveTo(w * 0.5 * (p1a.x + p1b.x), h * 0.5 * (p1a.y + p1b.y));\n    canvasCtx.lineTo(w * p2.x, h * p2.y);\n    canvasCtx.stroke();\n  }\n\n  canvasCtx.restore();\n}\n\nconst trackingRequests: Record<string, boolean> = {};\nconst trackingCount = () => Object\n  .keys(trackingRequests)\n  .map((id) => trackingRequests[id])\n  .filter((x) => x).length;\n\nlet latestResults: MpHolisticResults | null = null;\nexport function GetLatestResults() {\n  return Object.freeze(latestResults);\n}\n\nexport function StartTracking(videoE: HTMLVideoElement): void {\n  if (trackingStarted) { throw Error('Tracking alread started'); }\n\n  trackingStarted = true;\n  trackingRequests.initial = true;\n\n  let mpInstance: any = null;\n  if (usingHolistic) mpInstance = new mp.Holistic({ locateFile: (file: any) => `https://cdn.jsdelivr.net/npm/@mediapipe/holistic@0.1.1613603339/${file}` });\n  else mpInstance = new mp.Pose({ locateFile: (file: any) => `https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.2.1617147663/${file}` });\n\n  mpInstance.setOptions({\n    upperBodyOnly: false,\n    smoothLandmarks: true,\n    minDetectionConfidence: 0.5,\n    minTrackingConfidence: 0.5,\n  });\n\n  let frameId = 0;\n  let timestamp = Date.now();\n  mpInstance.onResults((res: MpHolisticResults) => {\n    trackingRequests.initial = false;\n    latestResults = res;\n    res.timestamp = timestamp;\n    eventHub.emit(EventNames.trackingResults, res, frameId);\n  });\n\n  eventHub.on(EventNames.trackingRequested, (id: string) => {\n    trackingRequests[id] = true;\n  });\n  eventHub.on(EventNames.trackingRequestFinished, (id: string) => {\n    trackingRequests[id] = false;\n  });\n\n  Utils.DoEveryFrame(\n    async () => {\n      frameId += 1;\n      eventHub.emit(EventNames.trackingProcessingStarted, frameId);\n      timestamp = Date.now();\n      if (trackingCount() > 0) await mpInstance.send({ image: videoE });\n    },\n    () => true,\n  );\n}\n\nexport function isTracking() {\n  return trackingCount() > 0;\n}\n","\n\nimport {\n  ref, defineComponent, watch, toRefs, onMounted, Ref,\n} from 'vue';\nimport { WEBCAM_DIMENSIONS } from '@/services/WebcamProvider';\nimport { GestureNames, setupGestureListening } from '../services/EventHub';\n\nimport { MpHolisticResults } from '../services/MediaPipeTypes';\nimport {\n  HAND_LANDMARK_CONNECTIONS, DrawConnections, DrawPose,\n} from '../services/MediaPipe';\n\nfunction drawHandShape(results: MpHolisticResults, canvasCtx: CanvasRenderingContext2D) {\n  if (!results.rightHandLandmarks) {\n    return;\n  }\n\n  canvasCtx.save();\n\n  /* eslint-disable no-param-reassign */\n  canvasCtx.strokeStyle = 'white';\n  canvasCtx.lineWidth = 3.0;\n  canvasCtx.lineCap = 'round';\n\n  DrawConnections(canvasCtx, results.rightHandLandmarks, HAND_LANDMARK_CONNECTIONS);\n  canvasCtx.restore();\n}\n\nfunction drawTrackingResults(\n  enabled: boolean,\n  detectedGesture: string,\n  results: MpHolisticResults,\n  fadeTimeMs: number,\n  canvasCtx: CanvasRenderingContext2D,\n) {\n  if (!enabled) return;\n\n  const sourceAR = (results.image?.width ?? WEBCAM_DIMENSIONS.width)\n                   / (results.image?.height ?? WEBCAM_DIMENSIONS.height);\n\n  canvasCtx.save();\n  const trackingTimestamp = results.timestamp ?? Date.now();\n  canvasCtx.globalAlpha = 1 - (Date.now() - trackingTimestamp) / fadeTimeMs;\n\n  if (results.poseLandmarks) {\n    DrawPose(canvasCtx, results.poseLandmarks, {\n      sourceAspectRatio: sourceAR,\n    });\n  }\n  if (detectedGesture !== GestureNames.none) drawHandShape(results, canvasCtx);\n  canvasCtx.restore();\n}\n\nexport default defineComponent({\n  name: 'DrawingSurface',\n  props: {\n    enableDrawing: {\n      type: Boolean,\n      default: true,\n    },\n    fadeTimeMs: {\n      type: Number,\n      default: 1000,\n    },\n  },\n  setup(props) {\n    const { enableDrawing, fadeTimeMs } = toRefs(props);\n\n    const canvasE = ref(null) as unknown as Ref<HTMLCanvasElement>;\n    const gesture = ref(GestureNames.none);\n    const mpResults = ref({} as MpHolisticResults);\n\n    setupGestureListening({},\n      (ges, trackingResults) => {\n        gesture.value = ges;\n        mpResults.value = trackingResults;\n        // console.log('Drawing surface: recvived tracking results', ges, trackingResults);\n      });\n\n    onMounted(() => {\n      const canvas = canvasE.value;\n      const canvasCtx = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n      canvasCtx.strokeStyle = 'rgba(200, 250, 200, 0.75)';\n      canvasCtx.lineWidth = 6;\n      canvasCtx.lineCap = 'round';\n    });\n\n    watch([enableDrawing, mpResults, gesture], (newVals) => {\n      const canvas = canvasE.value;\n      const canvasCtx = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n      canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n\n      const isEnabled = newVals[0];\n      const holisticResults = newVals[1];\n      const detectedGesture = newVals[2];\n\n      drawTrackingResults(\n        isEnabled as unknown as boolean,\n        detectedGesture as unknown as string,\n        holisticResults as unknown as MpHolisticResults,\n        fadeTimeMs.value,\n        canvasCtx,\n      );\n    });\n\n    return {\n      canvasE,\n      gesture,\n      mpResults,\n    };\n  },\n});\n\n","import { render } from \"./DrawingSurface.vue?vue&type=template&id=002e5f90\"\nimport script from \"./DrawingSurface.vue?vue&type=script&lang=ts\"\nexport * from \"./DrawingSurface.vue?vue&type=script&lang=ts\"\n\nimport \"./DrawingSurface.vue?vue&type=style&index=0&id=002e5f90&lang=scss\"\nscript.render = render\n\nexport default script","\n\nimport {\n  defineComponent, onBeforeUnmount, onMounted, onUpdated, ref,\n} from 'vue';\nimport webcamProvider from '@/services/WebcamProvider';\nimport { setupMediaPipeListening } from '@/services/EventHub';\nimport { MpHolisticResults } from '@/services/MediaPipeTypes';\nimport DrawingSurface from './DrawingSurface.vue';\nimport { isTracking as mpIsTracking, StartTracking } from '../services/MediaPipe';\n\nexport default defineComponent({\n  name: 'CameraSurface',\n  components: {\n    DrawingSurface,\n  },\n  data() {\n    return {\n      trackingIntervalId: -1,\n    };\n  },\n  setup(props, { emit }) {\n    // const { enableDrawing } = toRefs(props);\n    const hasStartedTracking = ref(false);\n    const isActivelyTracking = ref(false);\n    const hasResults = ref(false);\n    const trackingResults = ref({});\n\n    let timerId = -1;\n    onMounted(() => {\n      timerId = setInterval(() => {\n        isActivelyTracking.value = mpIsTracking();\n      }, 500);\n    });\n    onBeforeUnmount(() => {\n      clearInterval(timerId);\n    });\n\n    function onResults(results: MpHolisticResults) {\n      if (!hasResults.value) {\n        emit('tracking-attained');\n        console.log('Got Results', results);\n        hasResults.value = true;\n      }\n      trackingResults.value = results;\n      // this.$refs.drawingSurface.draw(results, canvasCtx);\n    }\n\n    setupMediaPipeListening(onResults);\n\n    return {\n      hasStartedTracking,\n      isActivelyTracking,\n      hasResults,\n      trackingResults,\n    };\n  },\n  methods: {\n    startTracking() {\n      if (this.trackingIntervalId !== -1) return;\n\n      const videoE = this.$refs.videoE as HTMLVideoElement;\n      const whenReady = () => {\n        if (this.hasStartedTracking) return;\n        this.hasStartedTracking = true;\n        console.log('Video loaded. Starting tracking...');\n\n        StartTracking(\n            this.$refs.videoE as HTMLVideoElement,\n        );\n\n        videoE.onloadedmetadata = null;\n      };\n\n      this.trackingIntervalId = setInterval(() => {\n\n        if (this.hasStartedTracking) {\n          clearInterval(this.trackingIntervalId);\n          this.trackingIntervalId = -1;\n        }\n\n        if (videoE.readyState === 4) {\n          whenReady();\n          return;\n        }\n\n        console.log('Video not ready, will start tracking when loaded.');\n      }, 100);\n\n      webcamProvider.connectVideoElement(videoE);\n    },\n  },\n});\n","import { render } from \"./CameraSurface.vue?vue&type=template&id=556bdbf0\"\nimport script from \"./CameraSurface.vue?vue&type=script&lang=ts\"\nexport * from \"./CameraSurface.vue?vue&type=script&lang=ts\"\n\nimport \"./CameraSurface.vue?vue&type=style&index=0&id=556bdbf0&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"onboardingUI\">\n    <div class=\"overlay instructions-overlay mb-4\">\n       <InstructionCarousel :instructions=\"instructions\" class=\"\"/>\n       <!-- <InstructionCarousel v-show=\"stage !== OnboardingStage.done\" :instructions=\"[{id: 0, text: 'How to use this app'}]\" class=\"m-2\"/> -->\n    </div>\n    <div class=\"vcenter-parent\" v-show=\"stage !== OnboardingStage.done\">\n      <div class=\"content translucent-text is-rounded p-6\">\n        <GestureIcon :gesture=\"gestureIcon\" />\n      </div>\n    </div>\n    <div class=\"overlay overlay-top overlay-right mt-4 mr-4\" v-show=\"stage !== OnboardingStage.done\">\n      <button class=\"button\" @click=\"skipOnboarding\">Skip</button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\n\nimport { usingHolistic } from '@/services/MediaPipe';\nimport {\n  computed,\n  defineComponent, onBeforeUnmount, onMounted, ref,\n} from 'vue';\n\nimport { setupGestureListening, GestureNames, TrackingActions } from '../services/EventHub';\nimport InstructionCarousel, { Instruction } from './elements/InstructionCarousel.vue';\nimport GestureIcon, { GestureIcons } from './elements/GestureIcon.vue';\n\nconst OnboardingStage = {\n  trySelectNext: 0,\n  trySelectPrevious: 1,\n  tryPerformPlay: 2,\n  done: 3,\n};\n\nexport default defineComponent({\n  name: 'OnboardingUI',\n  components: { InstructionCarousel, GestureIcon },\n  setup(props, ctx) {\n    const stage = ref(OnboardingStage.trySelectNext);\n    const output = ref('');\n\n    const instructions = computed(() => {\n      const instructs: Instruction[] = [];\n      if (stage.value === OnboardingStage.trySelectNext) {\n        instructs.push({\n          id: 0,\n          text:\n            usingHolistic\n              ? 'Point to the right with a flat hand to proceed'\n              : 'Point your left forearm to the right to proceed',\n        });\n      } else if (stage.value === OnboardingStage.trySelectPrevious) {\n        instructs.push({\n          id: 1,\n          text:\n          usingHolistic\n            ? 'Point to the left with a flat hand to repeat an activity'\n            : 'Point your right forearm to the left to repeat an activity',\n        });\n      } else if (stage.value === OnboardingStage.tryPerformPlay) {\n        instructs.push({\n          id: 2,\n          text: 'Put your hands together in a Namaste greeting to play a video',\n        });\n      } else {\n        instructs.push({\n          id: 3,\n          text: 'You got it!',\n        });\n      }\n      return instructs;\n    });\n\n    onMounted(() => {\n      TrackingActions.requestTracking('onboarding');\n    });\n    onBeforeUnmount(() => {\n      TrackingActions.endTrackingRequest('onboarding');\n    });\n\n    function advanceStage() {\n      if (stage.value === OnboardingStage.trySelectNext) {\n        stage.value = OnboardingStage.trySelectPrevious;\n      } else if (stage.value === OnboardingStage.trySelectPrevious) {\n        stage.value = OnboardingStage.tryPerformPlay;\n      } else if (stage.value === OnboardingStage.tryPerformPlay) {\n        stage.value = OnboardingStage.done;\n        TrackingActions.endTrackingRequest('onboarding');\n        setTimeout(() => {\n          ctx.emit('onboarding-complete');\n        }, 1500);\n      }\n    }\n    setupGestureListening({\n      [GestureNames.pointRight]: () => {\n        if (stage.value === OnboardingStage.trySelectNext) {\n          advanceStage();\n        }\n      },\n      [GestureNames.pointLeft]: () => {\n        if (stage.value === OnboardingStage.trySelectPrevious) {\n          advanceStage();\n        }\n      },\n      [GestureNames.namaste]: () => {\n        if (stage.value === OnboardingStage.tryPerformPlay) {\n          advanceStage();\n        }\n      },\n    });\n\n    function skipOnboarding() {\n      advanceStage();\n    }\n\n    const gestureIcon = computed(() => {\n      switch (stage.value) {\n        case OnboardingStage.trySelectNext:\n          return GestureIcons.forward;\n        case OnboardingStage.trySelectPrevious:\n          return GestureIcons.backward;\n        case OnboardingStage.tryPerformPlay:\n          return GestureIcons.play;\n        default:\n          return '';\n      }\n    });\n\n    return {\n      stage,\n      output,\n      instructions,\n      OnboardingStage,\n      skipOnboarding,\n      gestureIcon,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n.onboardingUI {\n  width: 100%;\n  height: 100%;\n}\n\n</style>\n","<template>\n  <transition-group name=\"slide-fade\" tag=\"div\" class=\"instructionCarousel\">\n    <p\n      class=\"tag\"\n      :class=\"[sizeClass, tagClass]\"\n      v-for=\"inst in instructions\"\n      :key=\"inst.id\">{{inst.text}}</p>\n  </transition-group>\n</template>\n\n<script lang=\"ts\">\n\nimport { defineComponent } from 'vue';\n\nexport type Instruction = {\n  id: number;\n  text: string;\n}\n\nexport default defineComponent({\n  props: {\n    instructions: {\n      type: Array,\n      default: Array,\n    },\n    sizeClass: {\n      type: String,\n      default: 'is-normal',\n    },\n    tagClass: {\n      type: String,\n      default: 'is-dark',\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n.instructionCarousel {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* Enter and leave animations can use different */\n/* durations and timing functions.              */\n.slide-fade-enter-active {\n  transition: all .15s ease;\n  overflow: hidden;\n  // transform: translateX(-100%);\n}\n.slide-fade-leave-active {\n  transition: all .15s ease;\n  overflow: clip;\n  // transform: translateX(-100%);\n}\n.slide-fade-enter, .slide-fade-leave-to\n/* .slide-fade-leave-active below version 2.1.8 */ {\n  transform: translateX(10px) scaleX(0);\n  opacity: 0;\n}\n\n</style>\n","\n\nimport { defineComponent } from 'vue';\n\nexport type Instruction = {\n  id: number;\n  text: string;\n}\n\nexport default defineComponent({\n  props: {\n    instructions: {\n      type: Array,\n      default: Array,\n    },\n    sizeClass: {\n      type: String,\n      default: 'is-normal',\n    },\n    tagClass: {\n      type: String,\n      default: 'is-dark',\n    },\n  },\n});\n","import { render } from \"./InstructionCarousel.vue?vue&type=template&id=7f78f3d2\"\nimport script from \"./InstructionCarousel.vue?vue&type=script&lang=ts\"\nexport * from \"./InstructionCarousel.vue?vue&type=script&lang=ts\"\n\nimport \"./InstructionCarousel.vue?vue&type=style&index=0&id=7f78f3d2&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <span class=\"icon is-large\" :class=\"iconClass\" v-if=\"showIcon\">\n    <i class=\"fas fa-2x fa-hand-paper fa-rotate-90\"></i>\n  </span>\n  <span v-else>\n    <img :src=\"gestureImgSrc\" :alt=\"gesture\">\n  </span>\n</template>\n\n<script lang=\"ts\">\nimport { usingHolistic } from '@/services/MediaPipe';\nimport { computed, defineComponent, toRefs } from 'vue';\n\nexport const GestureIcons = Object.freeze({\n  forward: 'forward',\n  backward: 'backward',\n  play: 'play',\n});\n\nexport default defineComponent({\n  props: {\n    gesture: {\n      type: String,\n      default: 'foward',\n    },\n  },\n  setup(props) {\n\n    const { gesture } = toRefs(props);\n\n    const showIcon = computed(() => usingHolistic);\n    const iconClass = computed(() => {\n      switch (gesture.value) {\n        case 'backward': return ['fa-flip-horizontal'];\n        case 'forward': return [];\n        default:\n          return [];\n      }\n    });\n    /* eslint-disable global-require */\n    /* eslint-disable import/no-dynamic-require */\n    const gestureImgSrc = computed(() => {\n      try {\n        return require(`../../assets/gestures/${gesture.value}.svg`);\n      } catch {\n        return '';\n      }\n    });\n\n    return {\n      showIcon,\n      iconClass,\n      gestureImgSrc,\n    };\n  },\n});\n</script>\n\n<style>\n</style>\n","\nimport { usingHolistic } from '@/services/MediaPipe';\nimport { computed, defineComponent, toRefs } from 'vue';\n\nexport const GestureIcons = Object.freeze({\n  forward: 'forward',\n  backward: 'backward',\n  play: 'play',\n});\n\nexport default defineComponent({\n  props: {\n    gesture: {\n      type: String,\n      default: 'foward',\n    },\n  },\n  setup(props) {\n\n    const { gesture } = toRefs(props);\n\n    const showIcon = computed(() => usingHolistic);\n    const iconClass = computed(() => {\n      switch (gesture.value) {\n        case 'backward': return ['fa-flip-horizontal'];\n        case 'forward': return [];\n        default:\n          return [];\n      }\n    });\n    /* eslint-disable global-require */\n    /* eslint-disable import/no-dynamic-require */\n    const gestureImgSrc = computed(() => {\n      try {\n        return require(`../../assets/gestures/${gesture.value}.svg`);\n      } catch {\n        return '';\n      }\n    });\n\n    return {\n      showIcon,\n      iconClass,\n      gestureImgSrc,\n    };\n  },\n});\n","import { render } from \"./GestureIcon.vue?vue&type=template&id=35fcd4fc\"\nimport script from \"./GestureIcon.vue?vue&type=script&lang=ts\"\nexport * from \"./GestureIcon.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\n\nimport { usingHolistic } from '@/services/MediaPipe';\nimport {\n  computed,\n  defineComponent, onBeforeUnmount, onMounted, ref,\n} from 'vue';\n\nimport { setupGestureListening, GestureNames, TrackingActions } from '../services/EventHub';\nimport InstructionCarousel, { Instruction } from './elements/InstructionCarousel.vue';\nimport GestureIcon, { GestureIcons } from './elements/GestureIcon.vue';\n\nconst OnboardingStage = {\n  trySelectNext: 0,\n  trySelectPrevious: 1,\n  tryPerformPlay: 2,\n  done: 3,\n};\n\nexport default defineComponent({\n  name: 'OnboardingUI',\n  components: { InstructionCarousel, GestureIcon },\n  setup(props, ctx) {\n    const stage = ref(OnboardingStage.trySelectNext);\n    const output = ref('');\n\n    const instructions = computed(() => {\n      const instructs: Instruction[] = [];\n      if (stage.value === OnboardingStage.trySelectNext) {\n        instructs.push({\n          id: 0,\n          text:\n            usingHolistic\n              ? 'Point to the right with a flat hand to proceed'\n              : 'Point your left forearm to the right to proceed',\n        });\n      } else if (stage.value === OnboardingStage.trySelectPrevious) {\n        instructs.push({\n          id: 1,\n          text:\n          usingHolistic\n            ? 'Point to the left with a flat hand to repeat an activity'\n            : 'Point your right forearm to the left to repeat an activity',\n        });\n      } else if (stage.value === OnboardingStage.tryPerformPlay) {\n        instructs.push({\n          id: 2,\n          text: 'Put your hands together in a Namaste greeting to play a video',\n        });\n      } else {\n        instructs.push({\n          id: 3,\n          text: 'You got it!',\n        });\n      }\n      return instructs;\n    });\n\n    onMounted(() => {\n      TrackingActions.requestTracking('onboarding');\n    });\n    onBeforeUnmount(() => {\n      TrackingActions.endTrackingRequest('onboarding');\n    });\n\n    function advanceStage() {\n      if (stage.value === OnboardingStage.trySelectNext) {\n        stage.value = OnboardingStage.trySelectPrevious;\n      } else if (stage.value === OnboardingStage.trySelectPrevious) {\n        stage.value = OnboardingStage.tryPerformPlay;\n      } else if (stage.value === OnboardingStage.tryPerformPlay) {\n        stage.value = OnboardingStage.done;\n        TrackingActions.endTrackingRequest('onboarding');\n        setTimeout(() => {\n          ctx.emit('onboarding-complete');\n        }, 1500);\n      }\n    }\n    setupGestureListening({\n      [GestureNames.pointRight]: () => {\n        if (stage.value === OnboardingStage.trySelectNext) {\n          advanceStage();\n        }\n      },\n      [GestureNames.pointLeft]: () => {\n        if (stage.value === OnboardingStage.trySelectPrevious) {\n          advanceStage();\n        }\n      },\n      [GestureNames.namaste]: () => {\n        if (stage.value === OnboardingStage.tryPerformPlay) {\n          advanceStage();\n        }\n      },\n    });\n\n    function skipOnboarding() {\n      advanceStage();\n    }\n\n    const gestureIcon = computed(() => {\n      switch (stage.value) {\n        case OnboardingStage.trySelectNext:\n          return GestureIcons.forward;\n        case OnboardingStage.trySelectPrevious:\n          return GestureIcons.backward;\n        case OnboardingStage.tryPerformPlay:\n          return GestureIcons.play;\n        default:\n          return '';\n      }\n    });\n\n    return {\n      stage,\n      output,\n      instructions,\n      OnboardingStage,\n      skipOnboarding,\n      gestureIcon,\n    };\n  },\n});\n","import { render } from \"./OnboardingUI.vue?vue&type=template&id=69ed9ac4\"\nimport script from \"./OnboardingUI.vue?vue&type=script&lang=ts\"\nexport * from \"./OnboardingUI.vue?vue&type=script&lang=ts\"\n\nimport \"./OnboardingUI.vue?vue&type=style&index=0&id=69ed9ac4&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <section class=\"section dance-menu\">\n\n    <div class=\"hero is-primary block\">\n      <div class=\"hero-body\">\n        <div class=\"container\">\n          <p class=\"title\">\n            Main Menu\n          </p>\n          <p class=\"subtitle mb-0\">\n            Which motion would you like to learn?\n          </p>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"menu container block\">\n      <div\n        class=\"dance-card card is-clickable shrink-hover\"\n        v-for=\"dance in motionList\"\n        :key=\"dance.title\"\n        @mouseover=\"hover = dance.hovering = true\"\n        @mouseleave=\"hover = dance.hovering = false\"\n        @click=\"selectedDance = dance\"\n      >\n        <div class=\"card-image\">\n          <figure class=\"image is-2by3\">\n            <video :src=\"dance.videoSrc\" />\n          </figure>\n        </div>\n        <div class=\"card-content\">\n          {{ dance.title }}\n        </div>\n      </div>\n\n      <div class=\"form-upload p-4\">\n        <h4 class=\"title is-4\">Other Actions</h4>\n        <div class=\"field\">\n          <div class=\"control is-expanded shrink-hover\">\n            <button class=\"button is-fullwidth\" @click=\"uploadUIActive = true\">Upload Custom Lesson</button>\n          </div>\n        </div>\n        <div class=\"field\">\n          <div class=\"control is-expanded shrink-hover\">\n            <button class=\"button is-fullwidth\" @click=\"$emit('pose-drawer-selected')\">Pose Drawer Test</button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div v-bind:class=\"{ 'is-active': selectedDance }\" class=\"modal\">\n      <div class=\"modal-background\"></div>\n      <div class=\"modal-content\">\n        <LessonCard\n          :motion=\"selectedDance\"\n          @closed=\"selectedDance = null\"\n          @lesson-selected=\"danceLessonSelected\"\n          @create-lesson-selected=\"createLessonSelected\"\n        />\n      </div>\n    </div>\n\n    <div v-bind:class=\"{ 'is-active': uploadUIActive }\" class=\"modal\">\n      <div class=\"modal-background\"></div>\n      <div class=\"modal-content\">\n        <UploadCard\n          v-if=\"uploadUIActive\"\n          @cancelled=\"uploadUIActive = false\"\n          :uploadAccept=\"'*.json'\"\n          :onFilesSelected=\"uploadFiles\"\n          :savingText=\"'Loading lessons...'\"\n          :successText=\"'Lessons loaded successfully'\"\n        />\n      </div>\n    </div>\n  </section>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref } from 'vue';\nimport LessonCard from '@/components/elements/LessonCard.vue';\nimport UploadCard from '@/components/elements/UploadCard.vue';\nimport db, { DatabaseEntry } from '@/services/MotionDatabase';\nimport DanceLesson from '@/model/DanceLesson';\n\nexport default defineComponent({\n  name: 'DanceMenu',\n  emits: ['dance-selected', 'pose-drawer-selected', 'create-lesson-selected'],\n  components: {\n    LessonCard,\n    UploadCard,\n  },\n  setup(props, ctx) {\n    const motionList = db.motions;\n    const selectedDance = ref(null as DatabaseEntry | null);\n    const uploadUIActive = ref(false);\n\n    function danceLessonSelected(dance: DatabaseEntry, lesson: DanceLesson) {\n      ctx.emit('dance-selected', dance, lesson);\n      selectedDance.value = null;\n    }\n\n    function createLessonSelected(dance: DatabaseEntry) {\n      ctx.emit('create-lesson-selected', dance);\n      selectedDance.value = null;\n    }\n\n    return {\n      selectedDance,\n      motionList,\n      danceLessonSelected,\n      createLessonSelected,\n      uploadUIActive,\n    };\n  },\n  methods: {\n    async uploadFiles(files: FileList) {\n      console.log('Upload files', files);\n\n      for (let i = 0; i < files.length; i += 1) {\n        const file = files.item(i);\n        if (!file) continue;\n        // eslint-disable-next-line no-await-in-loop\n        const text = await file.text();\n        const lesson = JSON.parse(text);\n        db.validateLesson(lesson);\n\n        // TODO: validate lesson\n        db.saveCustomLesson(lesson);\n      }\n      return true;\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n// .dance-menu {\n  // backdrop-filter: blur(4px);\n  // background: rgba(0, 0, 0, 0.2);\n// }\n\n.dance-menu {\n\n  .menu {\n    text-align: left;\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));\n    grid-gap: 0.5em;\n  }\n  .menu .card {\n    display: block;\n  }\n  .dance-card {\n    height: max-content;\n    overflow: hidden;\n    // transition: transform 0.2s, box-shadow 0.2s;\n\n    // &:hover {\n    //   box-shadow: 0 0.5em 1em -0.125em rgba(10, 10, 10, 0.3),\n    //     0 0 0 2px rgba(10, 10, 10, 0.05);\n    //   transform: scale(0.98);\n    // }\n  }\n\n  .shrink-hover {\n    transition: transform 0.2s, box-shadow 0.2s;\n\n    &:hover {\n      box-shadow: 0 0.5em 1em -0.125em rgba(10, 10, 10, 0.3),\n        0 0 0 2px rgba(10, 10, 10, 0.05);\n      transform: scale(0.98);\n    }\n  }\n\n  img {\n    object-fit: fill;\n  }\n\n  .subtitle {\n    margin: 2rem 1rem 2em;\n    color: white;\n  }\n\n  .section {\n    padding: 1.5rem;\n  }\n\n  .image video {\n    bottom: 0;\n    left: 0;\n    right: 0;\n    top: 0;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n}\n</style>\n","<template>\n  <div class=\"card lesson-card\" v-if=\"motion\">\n    <div class=\"card-header\">\n      <h4 class=\"card-header-title\">\n        {{ motion.title }}\n      </h4>\n\n      <a class=\"card-header-icon\" @click=\"$emit('closed')\">\n        <i class=\"fas fa-times\"></i>\n      </a>\n    </div>\n    <div class=\"card-content\">\n      <div class=\"columns\">\n        <div class=\"column is-narrow is-hidden-mobile\">\n          <video :src=\"motion.videoSrc\" autoplay=\"true\" muted=\"true\" width=\"180\" />\n        </div>\n        <div class=\"column\">\n          <div class=\"menu\">\n            <p class=\"menu-label\">\n              Pick a lesson\n            </p>\n            <ul class=\"menu-list\">\n              <li v-for=\"lesson in lessons\" :key=\"lesson._id\">\n                <a @click=\"$emit('lesson-selected', motion, lesson)\">\n                  {{ lesson.header.lessonTitle }}\n                </a>\n              </li>\n              <li v-if=\"canCreateLesson\">\n                <a @click=\"$emit('create-lesson-selected', motion)\">Create Lesson</a>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport db, { DatabaseEntry } from '@/services/MotionDatabase';\n\nexport default defineComponent({\n  name: 'LessonCard',\n  props: {\n    motion: {\n      type: Object,\n    },\n    canCreateLesson: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  computed: {\n    lessons() {\n      if (!this.motion) return [];\n      const motion = this.motion as DatabaseEntry;\n      const lessons = db.getLessons(motion);\n      return lessons ?? [];\n    },\n  },\n  emits: ['lesson-selected', 'create-lesson-selected', 'closed'],\n});\n</script>\n\n<style lang=\"scss\">\n\n.lesson-card .dance-image {\n  max-height: 50vh;\n}\n\n</style>\n","import DanceLesson, { Activity } from '@/model/DanceLesson';\n\nimport videoDatabase from '@/model/videoDatabase.json';\nimport defaultLessons from '@/model/bakedInLessons.json';\n\nimport { computed, reactive } from 'vue';\nimport Utils from './Utils';\n\nexport interface DatabaseEntry {\n  title: string;\n  clipName: string;\n  clipPath: string;\n  frameCount: number;\n  fps: number;\n  duration: number;\n  width: number;\n  height: number;\n  videoSrc: string;\n}\n\nexport class MotionDatabase {\n  readonly motionsMap = reactive(new Map<string, DatabaseEntry>());\n\n  readonly motions = computed(() => Array.from(this.motionsMap.values()));\n\n  readonly lessons = reactive(new Map<string, DanceLesson[]>());\n\n  constructor() {\n\n    videoDatabase.forEach((videoEntry) => {\n      this.motionsMap.set(videoEntry.clipName, {\n        videoSrc: `videos/${videoEntry.clipPath}`,\n        ...videoEntry,\n      });\n      this.lessons.set(videoEntry.clipName, []);\n    });\n\n    console.log(`Motion database: loaded ${this.motionsMap.size} videos`);\n    defaultLessons.forEach((lesson) => {\n      this.upsertLesson({\n        source: 'builtin',\n        ...lesson,\n      } as DanceLesson);\n    });\n    console.log(`Motion database: loaded ${defaultLessons.length} built-in lessons`);\n\n    const customLessonCount = this.loadCustomLessons();\n    console.log(`Motion database: loaded ${customLessonCount} custom lessons`);\n  }\n\n  hasLesson(lesson: DanceLesson): boolean {\n    const lessonList = this.lessons.get(lesson.header.clipName) ?? [];\n    const lessonIndex = lessonList.findIndex((val) => val._id === lesson._id);\n    return lessonIndex !== -1;\n  }\n\n  upsertLesson(lesson: DanceLesson) {\n    const lessonList = this.lessons.get(lesson.header.clipName) ?? [];\n    const existingIndex = lessonList.findIndex((les) => les._id === lesson._id);\n    if (existingIndex !== -1) lessonList[existingIndex] = lesson;\n    else lessonList.push(lesson);\n    this.lessons.set(lesson.header.clipName, lessonList);\n  }\n\n  removeLesson(lesson: DanceLesson) {\n    const lessonList = this.lessons.get(lesson.header.clipName) ?? [];\n    const lessonIndex = lessonList.findIndex((val) => val._id === lesson._id);\n    if (lessonIndex !== -1) lessonList.splice(lessonIndex, 1);\n    this.lessons.set(lesson.header.clipName, lessonList);\n  }\n\n  getLessons(videoEntry: DatabaseEntry | string) {\n    let lessons = undefined as undefined | DanceLesson[];\n    if (typeof videoEntry === 'object' && videoEntry !== null) lessons = this.lessons.get(videoEntry.clipName);\n    else lessons = this.lessons.get(videoEntry);\n    return lessons;\n  }\n\n  private static getCustomLessonIdsList(): Array<string> {\n    return JSON.parse(window.localStorage.getItem('custom-lessons') ?? '[]');\n  }\n\n  private static saveCustomLessonsIdsList(customLessonIds: Array<string>) {\n    window.localStorage.setItem('custom-lessons', JSON.stringify(customLessonIds));\n  }\n\n  private loadCustomLessons(): number {\n    const customLessonIds = MotionDatabase.getCustomLessonIdsList();\n    let countLoaded = 0;\n    for (let i = 0; i < customLessonIds.length; i += 1) {\n      const id = customLessonIds[i];\n      const custLesson = localStorage.getItem(`lesson-${id}`);\n      if (custLesson) {\n        this.upsertLesson(JSON.parse(custLesson) as DanceLesson);\n        countLoaded += 1;\n      }\n    }\n    return countLoaded;\n  }\n\n  validateLesson(lesson: DanceLesson) {\n    if (!lesson) throw new Error('Lesson is null or undefined');\n    const clipName = lesson?.header?.clipName;\n    if (!clipName) throw new Error('Clip name missing');\n    if (!this.motionsMap.has(clipName)) throw new Error(`Matching video clip not found for ${clipName}`);\n    if (!Array.isArray(lesson.activities) || lesson.activities.length < 1) throw new Error('Lesson contains no activities');\n  }\n\n  saveCustomLesson(lesson: DanceLesson) {\n    this.upsertLesson(lesson);\n    window.localStorage.setItem(`lesson-${lesson._id}`, JSON.stringify(lesson));\n\n    const custLessonIds = MotionDatabase.getCustomLessonIdsList();\n    if (custLessonIds.indexOf(lesson._id) === -1) {\n      console.log(`Added custom lesson ${lesson.header.lessonTitle} id=${lesson._id} to localstorage`);\n      custLessonIds.push(lesson._id);\n    } else {\n      console.log(`Updated custom lesson ${lesson.header.lessonTitle} id=${lesson._id} in localstorage`);\n    }\n    MotionDatabase.saveCustomLessonsIdsList(custLessonIds);\n  }\n\n  deleteCustomLesson(lesson: DanceLesson) {\n    this.removeLesson(lesson);\n\n    const custLessonIds = MotionDatabase.getCustomLessonIdsList();\n    const lessonIdIndex = custLessonIds.indexOf(lesson._id);\n    if (lessonIdIndex !== -1) custLessonIds.splice(lessonIdIndex, 1);\n    MotionDatabase.saveCustomLessonsIdsList(custLessonIds);\n\n    window.localStorage.removeItem(`lesson-${lesson._id}`);\n  }\n}\n\nexport function createBlankActivity(motion: DatabaseEntry, title: string): Activity {\n  return {\n    title,\n    startTime: 0,\n    endTime: motion.duration,\n    demoVisual: 'video',\n    userVisual: 'none',\n    practiceSpeed: 1,\n  };\n}\n\nexport function createBlankLesson(videoEntry: DatabaseEntry): DanceLesson {\n  return {\n    _id: Utils.uuidv4(),\n    source: 'custom',\n    header: {\n      clipName: videoEntry.clipName,\n      lessonTitle: 'New Lesson',\n    },\n    segmentBreaks: [0, videoEntry.duration],\n    activities: [createBlankActivity(videoEntry, 'Activity 1')],\n    fps: videoEntry.fps,\n  };\n}\n\nconst db = new MotionDatabase();\nexport default db;\n","\nimport { defineComponent } from 'vue';\nimport db, { DatabaseEntry } from '@/services/MotionDatabase';\n\nexport default defineComponent({\n  name: 'LessonCard',\n  props: {\n    motion: {\n      type: Object,\n    },\n    canCreateLesson: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  computed: {\n    lessons() {\n      if (!this.motion) return [];\n      const motion = this.motion as DatabaseEntry;\n      const lessons = db.getLessons(motion);\n      return lessons ?? [];\n    },\n  },\n  emits: ['lesson-selected', 'create-lesson-selected', 'closed'],\n});\n","import { render } from \"./LessonCard.vue?vue&type=template&id=0310a410\"\nimport script from \"./LessonCard.vue?vue&type=script&lang=ts\"\nexport * from \"./LessonCard.vue?vue&type=script&lang=ts\"\n\nimport \"./LessonCard.vue?vue&type=style&index=0&id=0310a410&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"card upload-card\">\n    <div class=\"card-header\">\n      <h4 class=\"card-header-title\">Upload File</h4>\n\n      <a class=\"card-header-icon\" @click=\"$emit('cancelled')\">\n        <i class=\"fas fa-times\"></i>\n      </a>\n    </div>\n    <div class=\"card-content\">\n      <form\n        enctype=\"multipart/form-data\"\n        novalidate\n        v-if=\"isInitial || isSaving || isFailed\"\n      >\n        <div class=\"field\">\n        </div>\n        <div class=\"field\">\n          <div class=\"control\">\n            <div class=\"dropbox is-rounded\">\n              <input\n                type=\"file\"\n                :name=\"uploadFieldName\"\n                :disabled=\"isSaving\"\n                @change=\"\n                  save($event.target.files, $event.target);\n                  fileCount = $event.target.files.length;\n                \"\n                :accept=\"uploadAccept\"\n                class=\"file-input\"\n              />\n              <p class=\"is-size-7\" v-if=\"isInitial\">\n                {{uploadInstructions}}\n              </p>\n              <p class=\"is-size-7\" v-if=\"isSaving\">\n                {{savingText}}\n              </p>\n              <div class=\"is-size-7 has-text-centered\" v-if=\"isFailed\">\n                <p>Error saving:</p>\n                <p style=\"max-width:60ch;\" class=\"has-text-danger\">{{uploadError}}</p>\n                <p><strong>Please try again.</strong></p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </form>\n      <div class=\"has-text-success\" v-if=\"isSuccess\">{{successText}}</div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nconst Status = Object.freeze({\n  Initial: 'Initial',\n  Saving: 'Saving',\n  Success: 'Success',\n  Failed: 'Failed',\n});\n\nexport default defineComponent({\n  name: 'UploadCard',\n  props: {\n    uploadAccept: {\n      type: String,\n      default: '*',\n    },\n    uploadInstructions: {\n      type: String,\n      default: 'Click here or drag your file(s) over this area',\n    },\n    savingText: {\n      type: String,\n      default: 'Processing File(s)...',\n    },\n    onFilesSelected: {\n      type: Function,\n      default: () => {},\n    },\n    successText: {\n      type: String,\n      default: 'Files uploaded successfully',\n    },\n  },\n  data() {\n    return {\n      uploadError: null,\n      currentStatus: null as null | string,\n      uploadFieldName: 'files',\n    };\n  },\n  emits: ['cancelled', 'done'],\n  computed: {\n    isInitial() { return (this as any).currentStatus === Status.Initial; },\n    isSaving() { return (this as any).currentStatus === Status.Saving; },\n    isSuccess() { return (this as any).currentStatus === Status.Success; },\n    isFailed() { return (this as any).currentStatus === Status.Failed; },\n  },\n  methods: {\n    reset() {\n      // reset form to initial state\n      this.currentStatus = Status.Initial;\n      this.uploadError = null;\n    },\n    async save(fileList: FileList) {\n      // upload data to the server\n      this.currentStatus = Status.Saving;\n\n      try {\n        const result = await this.onFilesSelected(fileList);\n        if (result) {\n          this.$emit('done');\n          this.currentStatus = Status.Success;\n        } else {\n          this.currentStatus = Status.Initial;\n        }\n      } catch (e) {\n        this.currentStatus = Status.Failed;\n        this.uploadError = e;\n      }\n    },\n  },\n  mounted() {\n    this.reset();\n  },\n});\n</script>\n\n<style lang=\"scss\">\n.upload-card {\n  .file-input {\n    opacity: 0;\n    width: 100%;\n    height: 160px;\n    position: absolute;\n    cursor: pointer;\n  }\n\n  .dropbox {\n    outline: 2px dashed gray;\n    outline-offset: -1rem;\n    min-height: 160px;\n    min-width: 320px;\n    color: dimgray;\n    padding: 1.5rem;\n    position: relative;\n    cursor: pointer;\n\n    &:hover {\n      background: lightblue;\n    }\n  }\n}\n</style>\n","\nimport { defineComponent } from 'vue';\n\nconst Status = Object.freeze({\n  Initial: 'Initial',\n  Saving: 'Saving',\n  Success: 'Success',\n  Failed: 'Failed',\n});\n\nexport default defineComponent({\n  name: 'UploadCard',\n  props: {\n    uploadAccept: {\n      type: String,\n      default: '*',\n    },\n    uploadInstructions: {\n      type: String,\n      default: 'Click here or drag your file(s) over this area',\n    },\n    savingText: {\n      type: String,\n      default: 'Processing File(s)...',\n    },\n    onFilesSelected: {\n      type: Function,\n      default: () => {},\n    },\n    successText: {\n      type: String,\n      default: 'Files uploaded successfully',\n    },\n  },\n  data() {\n    return {\n      uploadError: null,\n      currentStatus: null as null | string,\n      uploadFieldName: 'files',\n    };\n  },\n  emits: ['cancelled', 'done'],\n  computed: {\n    isInitial() { return (this as any).currentStatus === Status.Initial; },\n    isSaving() { return (this as any).currentStatus === Status.Saving; },\n    isSuccess() { return (this as any).currentStatus === Status.Success; },\n    isFailed() { return (this as any).currentStatus === Status.Failed; },\n  },\n  methods: {\n    reset() {\n      // reset form to initial state\n      this.currentStatus = Status.Initial;\n      this.uploadError = null;\n    },\n    async save(fileList: FileList) {\n      // upload data to the server\n      this.currentStatus = Status.Saving;\n\n      try {\n        const result = await this.onFilesSelected(fileList);\n        if (result) {\n          this.$emit('done');\n          this.currentStatus = Status.Success;\n        } else {\n          this.currentStatus = Status.Initial;\n        }\n      } catch (e) {\n        this.currentStatus = Status.Failed;\n        this.uploadError = e;\n      }\n    },\n  },\n  mounted() {\n    this.reset();\n  },\n});\n","import { render } from \"./UploadCard.vue?vue&type=template&id=4565a82c\"\nimport script from \"./UploadCard.vue?vue&type=script&lang=ts\"\nexport * from \"./UploadCard.vue?vue&type=script&lang=ts\"\n\nimport \"./UploadCard.vue?vue&type=style&index=0&id=4565a82c&lang=scss\"\nscript.render = render\n\nexport default script","\nimport { defineComponent, ref } from 'vue';\nimport LessonCard from '@/components/elements/LessonCard.vue';\nimport UploadCard from '@/components/elements/UploadCard.vue';\nimport db, { DatabaseEntry } from '@/services/MotionDatabase';\nimport DanceLesson from '@/model/DanceLesson';\n\nexport default defineComponent({\n  name: 'DanceMenu',\n  emits: ['dance-selected', 'pose-drawer-selected', 'create-lesson-selected'],\n  components: {\n    LessonCard,\n    UploadCard,\n  },\n  setup(props, ctx) {\n    const motionList = db.motions;\n    const selectedDance = ref(null as DatabaseEntry | null);\n    const uploadUIActive = ref(false);\n\n    function danceLessonSelected(dance: DatabaseEntry, lesson: DanceLesson) {\n      ctx.emit('dance-selected', dance, lesson);\n      selectedDance.value = null;\n    }\n\n    function createLessonSelected(dance: DatabaseEntry) {\n      ctx.emit('create-lesson-selected', dance);\n      selectedDance.value = null;\n    }\n\n    return {\n      selectedDance,\n      motionList,\n      danceLessonSelected,\n      createLessonSelected,\n      uploadUIActive,\n    };\n  },\n  methods: {\n    async uploadFiles(files: FileList) {\n      console.log('Upload files', files);\n\n      for (let i = 0; i < files.length; i += 1) {\n        const file = files.item(i);\n        if (!file) continue;\n        // eslint-disable-next-line no-await-in-loop\n        const text = await file.text();\n        const lesson = JSON.parse(text);\n        db.validateLesson(lesson);\n\n        // TODO: validate lesson\n        db.saveCustomLesson(lesson);\n      }\n      return true;\n    },\n  },\n});\n","import { render } from \"./DanceMenu.vue?vue&type=template&id=2d265ef0\"\nimport script from \"./DanceMenu.vue?vue&type=script&lang=ts\"\nexport * from \"./DanceMenu.vue?vue&type=script&lang=ts\"\n\nimport \"./DanceMenu.vue?vue&type=style&index=0&id=2d265ef0&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"learning-screen background-blur\"\n    >\n    <teleport to=\"#topbarLeft\">\n      <button class=\"button\" @click=\"$emit('back-selected')\">&lt; Back</button>\n    </teleport>\n    <teleport to=\"#topbarRight\">\n      <span class=\"tag\">{{activityId}} / {{activityCount}}</span>\n      <progress class=\"lessonProgress progress ml-2\" :max=\"activityCount\" :value=\"activityId\">\n      </progress>\n    </teleport>\n    <teleport to=\"#topbarCenter\">\n        <h3>{{activityTitle}}</h3>\n        <span class=\"tag ml-2\">Time: {{videoTime.toFixed(2)}}</span>\n    </teleport>\n\n    <div class=\"overlay\" v-show=\"activity && activity.userVisual !== 'none'\">\n      <WebcamBox :maxHeight=\"'720px'\"/>\n    </div>\n\n    <div class=\"overlay\">\n      <PausingVideoPlayer\n        :videoSrc=\"targetDance.videoSrc\"\n        :maxHeight=\"'720px'\"\n        ref=\"videoPlayer\"\n        @progress=\"onTimeChanged\"\n        @playback-completed=\"onActivityFinished\"\n        @pause-hit=\"onPauseHit\"\n        @pause-end=\"onPauseEnded\"\n        :drawPoseLandmarks=\"activity?.demoVisual === 'skeleton'\"\n        :videoOpacity=\"activity?.demoVisual === 'video' ? 1 : 0\"\n        :emphasizedJoints=\"emphasizedJoints\"\n      />\n    </div>\n\n    <div class=\"overlay instructions-overlay mb-4\">\n      <InstructionCarousel v-show=\"!activityFinished && timedInstructions.length > 0\" :sizeClass=\"'is-large'\" :instructions=\"timedInstructions\" class=\"m-2\"/>\n      <InstructionCarousel v-show=\"instructions.length > 0\" :sizeClass=\"'is-large'\" :instructions=\"instructions\" class=\"m-2\"/>\n      <InstructionCarousel v-show=\"activity.staticInstruction\" :sizeClass=\"'is-large'\"  :instructions=\"[{id:0, text:activity.staticInstruction}]\" class=\"m-2\"/>\n    </div>\n\n    <div class=\"overlay overlay-bottom overlay-right mb-6 mr-6\" v-show=\"showPlayGestureIcon\">\n      <div class=\"vcenter-parent\">\n        <div class=\"content translucent-text activityStartGestureCard is-rounded\" >\n          <GestureIcon class=\"activityEndGestureCard\" :gesture=\"'play'\" />\n          <p>Start Activity</p>\n        </div>\n      </div>\n    </div>\n    <div class=\"overlay overlay-left overlay-bottom mb-6 ml-6\" v-show=\"activityFinished\">\n      <div class=\"vcenter-parent ml-2\">\n        <div class=\"content translucent-text p-5 is-rounded activityStartGestureCard\">\n          <GestureIcon class=\"activityEndGestureCard\" :gesture=\"'backward'\" />\n          <p>Repeat this activity</p>\n        </div>\n      </div>\n    </div>\n    <div class=\"overlay overlay-right overlay-bottom mb-6 mr-6\" v-show=\"activityFinished\">\n      <div class=\"vcenter-parent\">\n        <div class=\"content translucent-text p-5 is-rounded activityStartGestureCard\">\n          <GestureIcon class=\"activityEndGestureCard\" :gesture=\"'forward'\" />\n          <p>Advance to next activity</p>\n        </div>\n      </div>\n    </div>\n\n    <teleport to=\"#belowSurface\">\n      <div>\n        <div class=\"master-bar mt-4\">\n          <SegmentedProgressBar\n            :segments=\"progressSegments\"\n            :progress=\"videoTime\"\n          />\n        </div>\n        <div class=\"mt-4 mb-4 buttons is-centered\">\n          <button\n            class=\"button\"\n            @click=\"gotoPreviousActivity\"\n            :class=\"{\n              'is-white': activityFinished,\n              'is-light': !activityFinished,\n            }\"\n            :disabled=\"activityId === 0\">Previous</button>\n          <button\n             class=\"button\"\n            @click=\"repeatActivity\"\n            :class=\"{\n              'is-white': activityFinished,\n              'is-light': !activityFinished,\n            }\"\n            :disabled=\"!activityFinished\">Repeat <i class=\"fa fa-repeat\" aria-hidden=\"true\"></i>\n          </button>\n          <button\n            class=\"button\"\n            :class=\"{\n              'is-white': showPlayGestureIcon,\n              'is-light': !showPlayGestureIcon,\n            }\"\n            @click=\"playActivity(undefined, true)\"\n            :disabled=\"!showPlayGestureIcon\">Start Activity</button>\n          <button\n            class=\"button\"\n            @click=\"gotoNextActivity\"\n            :class=\"{\n              'is-white': activityFinished,\n              'is-light': !activityFinished,\n            }\">\n            <span v-if=\"hasNextActivity\">Next</span>\n            <span v-else>Finish Lesson</span></button>\n          <button\n            class=\"button\"\n            @click=\"startSaveFrames\"\n            :disabled=\"!canSaveFrame\"\n            :class=\"{'is-loading': isSavingFrames}\">Save Frames</button>\n        </div>\n      </div>\n    </teleport>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Constants from '@/services/Constants';\nimport DanceLesson, { Activity, PauseInfo, DanceUtils } from '@/model/DanceLesson';\nimport {\n  computed, ComputedRef, defineComponent, nextTick, onBeforeUnmount, onMounted, Ref, ref, toRefs, watch,\n} from 'vue';\nimport {\n  GestureNames, setupGestureListening, setupMediaPipeListening, TrackingActions,\n} from '@/services/EventHub';\nimport { DatabaseEntry } from '@/services/MotionDatabase';\nimport motionRecorder from '@/services/MotionRecorder';\nimport InstructionCarousel, { Instruction } from '@/components/elements/InstructionCarousel.vue';\nimport { Landmark } from '@/services/MediaPipeTypes';\nimport Utils from '@/services/Utils';\nimport SegmentedProgressBar, { ProgressSegmentData, calculateProgressSegments } from '../elements/SegmentedProgressBar.vue';\nimport PausingVideoPlayer from '../elements/PausingVideoPlayer.vue';\nimport WebcamBox from '../elements/WebcamBox.vue';\nimport GestureIcon from '../elements/GestureIcon.vue';\n\nconst { DefaultPauseDuration } = Constants; // 1.5 seconds\n\nconst ActivityPlayState = Object.freeze({\n  AwaitingPlayGesture: 'AwaitingPlayGesture',\n  PendingStart: 'PendingStart',\n  Playing: 'Playing',\n  ActivityEnded: 'ActivityEnded',\n});\n\n//\n// TODO!\n//   * Update segment breaks in activity to have the first activity\n//     start time and the last activity end time.\n//\n\nconst TRACKING_ID = 'LearningScreen';\n\nfunction setupFrameRecording(activity: ComputedRef<Activity | null>, videoTime: Ref<number>, videoPlayer: Ref<null | typeof PausingVideoPlayer>, playActivity: Function) {\n  const isSavingFrames = ref(false);\n  let recordingSessionId = -1;\n\n  const lastPose = {\n    frameId: -1,\n    pose: null as null | Landmark[],\n    timestamp: 0,\n  };\n\n  setupMediaPipeListening(\n    (mpResults, frameId) => {\n      // console.log('Got mp result');\n      if (frameId !== lastPose.frameId) {\n        console.warn(`Skipping motion recording frame -- proceesed frameId ${frameId} doesn't match stored pose with id: ${lastPose.frameId}`);\n        return;\n      }\n      if (isSavingFrames.value) {\n        motionRecorder.saveMotionFrame(\n          recordingSessionId,\n          lastPose.timestamp,\n          mpResults,\n          { poseLandmarks: lastPose.pose ?? undefined },\n        );\n      }\n    },\n    (frameId) => {\n      lastPose.frameId = frameId;\n      lastPose.pose = videoPlayer.value?.currentPose ?? null;\n      lastPose.timestamp = videoTime.value;\n    },\n  );\n  const canSaveFrame = computed(() => {\n    if (isSavingFrames.value) return false;\n    if (!activity.value) return false;\n    return activity.value.demoVisual === 'skeleton' && activity.value.userVisual !== 'none';\n  });\n  async function startSaveFrames() {\n    recordingSessionId = await motionRecorder.startRecordingSession(\n      { width: 640, height: 480 },\n      videoPlayer.value?.getVideoDimensions(),\n    );\n\n    isSavingFrames.value = true;\n\n    playActivity(5, true);\n  }\n  async function concludeSaveFrames() {\n\n    await Utils.sleep(1.5);\n\n    isSavingFrames.value = false;\n\n    await motionRecorder.endRecordingSession(\n      recordingSessionId,\n      activity.value?.startTime ?? -1,\n      activity.value?.endTime ?? -1,\n    );\n  }\n\n  return {\n    isSavingFrames, canSaveFrame, startSaveFrames, concludeSaveFrames,\n  };\n}\n\nexport default defineComponent({\n  components: {\n    SegmentedProgressBar,\n    PausingVideoPlayer,\n    InstructionCarousel,\n    WebcamBox,\n    GestureIcon,\n  },\n  props: {\n    targetDance: Object,\n    targetLesson: Object,\n  },\n  setup(props, { emit }) {\n\n    const { targetLesson, targetDance } = toRefs(props);\n\n    const activityState = ref(ActivityPlayState.AwaitingPlayGesture);\n    const showPlayGestureIcon = computed(() => activityState.value === ActivityPlayState.AwaitingPlayGesture);\n\n    const videoPlayer = ref(null as null | typeof PausingVideoPlayer);\n    const videoTime = ref(0);\n\n    const activityId = ref(0);\n    const activity = computed(() => {\n      const lesson = targetLesson?.value as unknown as DanceLesson | null;\n      return lesson?.activities[activityId.value] ?? null;\n    });\n\n    const emphasizedJoints = computed(() => activity.value?.emphasizedJoints ?? []);\n    const activityTitle = computed(() => activity.value?.title ?? '');\n    const activityCount = computed(() => {\n      const lesson = targetLesson?.value as unknown as DanceLesson | null;\n      return lesson?.activities?.length ?? 0;\n    });\n    const hasNextActivity = computed(() => activityCount.value > activityId.value + 1);\n    // eslint-disable-next-line max-len\n    const activityFinished = computed(() => activityState.value === ActivityPlayState.ActivityEnded);\n    const nextActivityTitle = computed(() => {\n      if (!hasNextActivity.value) return 'Finish Lesson';\n      const lesson = targetLesson?.value as unknown as DanceLesson | null;\n\n      const nextActivity = lesson?.activities[activityId.value + 1];\n      return nextActivity?.title ?? 'Unknown';\n    });\n\n    const pauseInstructs = ref([] as Instruction[]);\n    function onPauseHit(pause: PauseInfo) {\n      if (pause.instruction) {\n        pauseInstructs.value.push({\n          id: pause.time,\n          text: pause.instruction,\n        });\n      }\n    }\n    function onPauseEnded() {\n      // Remove all pause instructions\n      pauseInstructs.value.splice(0);\n    }\n\n    const instructions = computed(() => {\n      const mActivity = activity.value;\n      const state = activityState.value;\n      if (!mActivity) return [];\n\n      const instructs: Instruction[] = [];\n\n      if ((state === ActivityPlayState.AwaitingPlayGesture || state === ActivityPlayState.PendingStart) && mActivity.startInstruction) {\n        instructs.push({\n          id: 1,\n          text: mActivity.startInstruction,\n        });\n      } else if (state === ActivityPlayState.Playing && mActivity.playingInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.playingInstruction,\n        });\n      } else if (state === ActivityPlayState.ActivityEnded && mActivity.endInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.endInstruction,\n        });\n      }\n\n      return instructs;\n    });\n    const timedInstructions = computed(() => {\n      const mActivity = activity.value;\n      const time = videoTime.value;\n      if (!mActivity) return [];\n\n      const activeTimedInstructions = mActivity.timedInstructions?.map(\n        (ti, i) => ({\n          id: i,\n          text: ti.text,\n          start: ti.startTime,\n          end: ti.endTime,\n        })\n      ).filter((ti) => ti.start <= time && time < ti.end) ?? [];\n\n      return activeTimedInstructions;\n    });\n\n    const progressSegments = computed(() => {\n      const lesson = targetLesson?.value as DanceLesson | undefined;\n      const curActivity = activity.value;\n      if (lesson && curActivity) return calculateProgressSegments(lesson, curActivity);\n      return [];\n    });\n\n    function playVideo(vidActivity: Activity, pause?: number | undefined) {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) {\n        console.error('LEARNING SCREEN:: Aborting video playback: vidPlayer is null');\n        return;\n      }\n\n      activityState.value = ActivityPlayState.PendingStart;\n\n      vidPlayer.play(\n        vidActivity.startTime,\n        vidActivity.endTime,\n        vidActivity.practiceSpeed ?? 1,\n        vidActivity.pauses ?? [],\n        pause ?? DefaultPauseDuration,\n        () => {\n          activityState.value = ActivityPlayState.Playing;\n        },\n      );\n    }\n\n    function playActivity(pause?: number | undefined, forcePlay?: boolean | undefined) {\n\n      pauseInstructs.value.splice(0);\n      activityState.value = ActivityPlayState.AwaitingPlayGesture;\n      const vidActivity = activity.value;\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer || !vidActivity) {\n        console.error('LEARNING SCREEN:: Aborting video playback: vidPlayer or lessonActivity is null', vidPlayer, vidActivity);\n        return;\n      }\n      const startingNow = forcePlay || (activityId.value !== 0 && !DanceUtils.shouldPauseBeforeActivity(vidActivity));\n\n      vidPlayer.setTime(vidActivity.startTime);\n\n      if (startingNow) {\n        playVideo(vidActivity, pause);\n        console.log(`LEARNING SCREEN:: Scheduling playback for activity ${activityId.value}`);\n      } else {\n        console.log(`LEARNING SCREEN:: Setting start & pausing for userinput for activity ${activityId.value}`);\n      }\n    }\n\n    function gotoActivity(delta: number) {\n      activityState.value = ActivityPlayState.AwaitingPlayGesture;\n      if (!hasNextActivity.value) {\n        emit('lesson-completed');\n        return;\n      }\n      if (activityId.value === 0 && delta < 0) {\n        // Don't adjust activityId - we can't go back (simply repeat).\n        playActivity();\n        return;\n      }\n      activityId.value += delta;\n      playActivity();\n    }\n    function repeatActivity() {\n      gotoActivity(0);\n    }\n    function gotoPreviousActivity() {\n      gotoActivity(-1);\n    }\n\n    function gotoNextActivity() {\n      gotoActivity(1);\n    }\n\n    const {\n      isSavingFrames, canSaveFrame, startSaveFrames, concludeSaveFrames,\n    } = setupFrameRecording(activity, videoTime, videoPlayer, playActivity);\n\n    function onActivityFinished() {\n      activityState.value = ActivityPlayState.ActivityEnded;\n      console.log('LEARNING SCREEN:: Activity finished');\n\n      if (isSavingFrames.value) concludeSaveFrames();\n    }\n\n    const isTrackingUser = computed(() => {\n      if (activity.value?.userVisual === 'skeleton') return true;\n      if (activityState.value === ActivityPlayState.ActivityEnded || activityState.value === ActivityPlayState.AwaitingPlayGesture) return true;\n      if (isSavingFrames.value) return true;\n      return false;\n    });\n    watch(isTrackingUser, (val) => {\n      if (val) TrackingActions.requestTracking(TRACKING_ID);\n      else TrackingActions.endTrackingRequest(TRACKING_ID);\n    });\n\n    onMounted(() => {\n      nextTick(() => {\n        if (isTrackingUser.value) TrackingActions.requestTracking(TRACKING_ID);\n        else TrackingActions.endTrackingRequest(TRACKING_ID);\n      });\n    });\n\n    setupGestureListening({\n      [GestureNames.pointRight]: () => {\n        if (!activityFinished.value) return;\n        gotoNextActivity();\n      },\n      [GestureNames.pointLeft]: () => {\n        if (!activityFinished.value) return;\n        playActivity();\n      },\n      [GestureNames.namaste]: () => {\n        if (activityState.value === ActivityPlayState.AwaitingPlayGesture) {\n          playActivity(undefined, true);\n        }\n      },\n    });\n    onBeforeUnmount(() => {\n      TrackingActions.endTrackingRequest(TRACKING_ID);\n    });\n\n    onMounted(() => {\n      playActivity();\n    });\n\n    return {\n      activityState,\n      ActivityPlayState,\n      showPlayGestureIcon,\n      playActivity,\n      progressSegments,\n      activity,\n      activityId,\n      activityCount,\n      activityTitle,\n      emphasizedJoints,\n      nextActivityTitle,\n      instructions,\n      timedInstructions,\n      videoPlayer,\n      activityFinished,\n      videoTime,\n      onActivityFinished,\n\n      onPauseHit,\n      onPauseEnded,\n\n      gotoPreviousActivity,\n      repeatActivity,\n      gotoNextActivity,\n      hasNextActivity,\n\n      canSaveFrame,\n      isSavingFrames,\n      startSaveFrames,\n      isTrackingUser,\n    };\n  },\n  methods: {\n    onTimeChanged(time: number) {\n      this.videoTime = time;\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n.learning-screen {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n.master-bar {\n  width: 1280px;\n  // margin: 0 auto;\n  // padding: 1rem 1rem 1rem 1rem;\n  // border-radius: 0 0 0.5rem 0.5rem;\n}\n\n.instructions-overlay {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n.lessonProgress {\n  width: 128px;\n}\n\n.activityEndGestureCard {\n  max-width: 4rem;\n}\n\n.activityStartGestureCard {\n  max-width: 8rem;\n}\n</style>\n","const Constants = Object.freeze({\n  DefaultPauseDuration: 1.5,\n});\nexport default Constants;\n","export interface TimedInstruction {\n  startTime: number;\n  endTime: number;\n  text: string;\n}\n\nexport interface PauseInfo {\n    time: number;\n    pauseDuration?: number;\n    instruction?: string;\n    manualResume?: boolean;\n}\n\nexport interface Activity {\n  title: string;\n  startTime: number;\n  endTime: number;\n  demoVisual: 'video' | 'skeleton' | 'none';\n  userVisual: 'video' | 'skeleton' | 'none'; // If the user's webcam should be on\n  emphasizedJoints?: number[];\n  focusedSegments?: number[];\n  pauses?: Array<PauseInfo>;\n  practiceSpeed?: number;\n  startInstruction?: string;\n  playingInstruction?: string;\n  staticInstruction?: string;\n  timedInstructions?: Array<TimedInstruction>;\n  endInstruction?: string;\n}\n\nexport default interface DanceLesson {\n  _id: string;\n  source: 'builtin' | 'custom';\n  header: {\n    clipName: string;\n    lessonTitle: string;\n  };\n  segmentBreaks: number[];\n  activities: Array<Activity>;\n  fps: number;\n  // poseScope: 'all' | 'upperBody';\n  // eslint-disable-next-line\n}\n\nexport class DanceUtils {\n  static shouldPauseBeforeActivity(activity: Activity) {\n    return activity.userVisual !== 'none';\n  }\n}\n","import RecordRTC, { invokeSaveAsDialog } from 'recordrtc';\n\nexport default class ScreenRecorder {\n\n  private recorder: RecordRTC | null = null;\n\n  async startRecording() {\n\n    const captureStream = await (navigator.mediaDevices as any).getDisplayMedia({});\n\n    this.recorder = new RecordRTC(captureStream);\n    this.recorder.startRecording();\n  }\n\n  async endRecording(): Promise<Blob> {\n    if (!this.recorder) throw new Error('Recording not started!');\n    const { recorder } = this;\n\n    return new Promise((res, rej) => {\n      try {\n        recorder.stopRecording(() => {\n          res(recorder.getBlob());\n        });\n      } catch (e) {\n        rej(e);\n      }\n    });\n  }\n\n}\n","import { MpHolisticResults } from './MediaPipeTypes';\nimport Utils from './Utils';\nimport { saveBlob } from './WebcamProvider';\nimport ScreenRecorder from './ScreenRecorder';\n\nexport interface Dimensions {\n  width: number;\n  height: number;\n}\n\ninterface RecordingSession {\n  frameTimestamps: number[];\n  userDimension: Dimensions;\n  userFrames: MpHolisticResults[];\n  demoDimension: Dimensions;\n  demoFrames: MpHolisticResults[];\n}\n\nexport class MotionRecorder {\n\n  private recordingSessions: Record<number, RecordingSession> = {};\n\n  private recordingSessionNextId = 0;\n\n  private screenRecorder = new ScreenRecorder();\n\n  async startRecordingSession(userDims: Dimensions, demoDims: Dimensions): Promise<number> {\n    this.recordingSessions[this.recordingSessionNextId] = {\n      frameTimestamps: [],\n      userDimension: userDims,\n      userFrames: [],\n      demoDimension: demoDims,\n      demoFrames: [],\n    };\n    this.recordingSessionNextId += 1;\n\n    await this.screenRecorder.startRecording();\n    return this.recordingSessionNextId - 1;\n  }\n\n  saveMotionFrame(sessionId: number, timestamp: number, userFrame: MpHolisticResults, demoFrame: MpHolisticResults) {\n    const session = this.recordingSessions[sessionId];\n    if (!session) throw new Error(`Recording session ${sessionId} wasn't found!`);\n\n    debugger;\n    if (userFrame.image) delete userFrame.image;\n    session.frameTimestamps.push(timestamp);\n    session.userFrames.push(userFrame);\n    session.demoFrames.push(demoFrame);\n  }\n\n  async endRecordingSession(sessionId: number, start: number, end: number) {\n    const session = this.recordingSessions[sessionId];\n    if (!session) throw new Error(`Recording session ${sessionId} wasn't found!`);\n\n    const recordedBlob = await this.screenRecorder.endRecording();\n    saveBlob(recordedBlob, 'recording.webm');\n\n    const mSession = { startTime: start, endTime: end, ...session };\n\n    Utils.PromptDownloadFile(`RecordedSession-${sessionId}.json`, JSON.stringify(mSession));\n  }\n}\n\nconst motionRecorder = new MotionRecorder();\n\nexport default motionRecorder;\n","<template>\n  <div class=\"segmented-progress-bar\">\n    <progress\n      v-for=\"seg in segmentsData\"\n      :key=\"seg.id\"\n      :class=\"[{ 'is-disabled': !enableAll && !seg.enabled, [seg.cssClass]: enableAll || seg.enabled, 'is-dark': !enableAll && !seg.enabled}, ]\"\n      class=\"progress is-large\"\n      :max=\"seg.max - seg.min\"\n      :value=\"progress - seg.min\"\n      :style=\"{ 'flex-grow': (seg.max - seg.min) }\"\n    ></progress>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, toRefs } from 'vue';\nimport DanceLesson, { Activity } from '@/model/DanceLesson';\n\nexport interface ProgressSegmentData {\n  min: number;\n  max: number;\n  enabled: boolean;\n}\n\nexport function calculateProgressSegments(lesson: DanceLesson, activity: Activity) {\n  if (!lesson) return [];\n\n  let last = undefined as undefined | number;\n  const segs = lesson.segmentBreaks.map((timestamp, i) => {\n    let segData = undefined as undefined | ProgressSegmentData;\n    if (last !== undefined) {\n      segData = {\n        min: last,\n        max: timestamp,\n        enabled: activity?.focusedSegments ? activity.focusedSegments.indexOf(i - 1) !== -1 : true,\n      };\n    }\n    last = timestamp;\n    return segData;\n  }).filter((x) => x !== undefined);\n\n  return segs as ProgressSegmentData[];\n}\n\nconst cssClassOptions = [\n  'is-info',\n  'is-success',\n  'is-warning',\n  'is-primary',\n  'is-danger',\n];\n\nexport default defineComponent({\n  name: 'SegmentedProgressBar',\n  props: {\n    segments: {\n      default: Array,\n      type: Array,\n    },\n    progress: {\n      default: 0,\n      type: Number,\n    },\n    enableAll: {\n      default: false,\n      type: Boolean,\n    },\n  },\n  setup(props) {\n    const {\n      segments,\n    } = toRefs(props);\n\n    const segmentsData = computed(\n      () => segments.value.map(\n        (seg, i) => ({\n          id: i,\n          cssClass: cssClassOptions[i % cssClassOptions.length],\n          ...(seg as ProgressSegmentData),\n        }),\n      ),\n    );\n\n    return {\n      segmentsData,\n    };\n  },\n});\n\n</script>\n\n<style lang=\"scss\">\n.segmented-progress-bar {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n\n  progress.progress {\n    border-radius: 0.5rem;\n    flex-basis: 10px;\n    margin-bottom: auto;\n    // border: 2px solid #BBB;\n\n    -webkit-appearance: none;\n    appearance: none;\n\n    &.is-disabled::-webkit-progress-bar,\n    &.is-disabled {\n      background: #888;\n    }\n\n    &.is-disabled::-moz-progress-bar,\n    &.is-disabled::-webkit-progress-value,\n    &.is-disabled::-ms-fill {\n      background: #888;\n    }\n  }\n}\n</style>\n","\nimport { defineComponent, computed, toRefs } from 'vue';\nimport DanceLesson, { Activity } from '@/model/DanceLesson';\n\nexport interface ProgressSegmentData {\n  min: number;\n  max: number;\n  enabled: boolean;\n}\n\nexport function calculateProgressSegments(lesson: DanceLesson, activity: Activity) {\n  if (!lesson) return [];\n\n  let last = undefined as undefined | number;\n  const segs = lesson.segmentBreaks.map((timestamp, i) => {\n    let segData = undefined as undefined | ProgressSegmentData;\n    if (last !== undefined) {\n      segData = {\n        min: last,\n        max: timestamp,\n        enabled: activity?.focusedSegments ? activity.focusedSegments.indexOf(i - 1) !== -1 : true,\n      };\n    }\n    last = timestamp;\n    return segData;\n  }).filter((x) => x !== undefined);\n\n  return segs as ProgressSegmentData[];\n}\n\nconst cssClassOptions = [\n  'is-info',\n  'is-success',\n  'is-warning',\n  'is-primary',\n  'is-danger',\n];\n\nexport default defineComponent({\n  name: 'SegmentedProgressBar',\n  props: {\n    segments: {\n      default: Array,\n      type: Array,\n    },\n    progress: {\n      default: 0,\n      type: Number,\n    },\n    enableAll: {\n      default: false,\n      type: Boolean,\n    },\n  },\n  setup(props) {\n    const {\n      segments,\n    } = toRefs(props);\n\n    const segmentsData = computed(\n      () => segments.value.map(\n        (seg, i) => ({\n          id: i,\n          cssClass: cssClassOptions[i % cssClassOptions.length],\n          ...(seg as ProgressSegmentData),\n        }),\n      ),\n    );\n\n    return {\n      segmentsData,\n    };\n  },\n});\n\n","import { render } from \"./SegmentedProgressBar.vue?vue&type=template&id=5bf959ee\"\nimport script from \"./SegmentedProgressBar.vue?vue&type=script&lang=ts\"\nexport * from \"./SegmentedProgressBar.vue?vue&type=script&lang=ts\"\n\nimport \"./SegmentedProgressBar.vue?vue&type=style&index=0&id=5bf959ee&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"is-relative\" :style=\"{'max-height': maxHeight}\">\n    <VideoPlayer\n      ref=\"videoPlayer\"\n      :videoBaseUrl=\"videoSrc\"\n      @progress=\"onProgress\"\n      @playback-completed=\"onSegmentPlaybackCompleted\"\n      :videoOpacity=\"videoOpacity\"\n      :drawPoseLandmarks=\"drawPoseLandmarks\"\n      :setDrawStyle=\"setDrawStyle\"\n      :maxHeight=\"maxHeight\"\n      :emphasizedJoints=\"emphasizedJoints\"\n      :emphasizedJointStyle=\"emphasizedJointStyle\"\n      />\n  </div>\n</template>\n\n<script lang=\"ts\">\n\nimport Constants from '@/services/Constants';\nimport { PauseInfo } from '@/model/DanceLesson';\nimport {\n  computed, defineComponent, onBeforeUnmount, ref,\n} from 'vue';\nimport VideoPlayer from './VideoPlayer.vue';\n\nconst DEFAULT_PAUSE_DURATION = Constants.DefaultPauseDuration;\n\ntype PlaySegment = {\n  from: number;\n  to: number;\n  speed: number;\n  pause: PauseInfo | null;\n}\nfunction computePlaySegments(from: number, to: number, speed: number, pauses: PauseInfo[]) {\n  const segs: PlaySegment[] = [];\n\n  function nextPauseIndex(prevIndex: number): number {\n    const pTime = Math.max((pauses[prevIndex]?.time ?? 0), from);\n    let pauseIndex = prevIndex + 1;\n    for (; pauseIndex < pauses.length; pauseIndex += 1) {\n      const pi = pauses[pauseIndex];\n      if (pi.time > pTime) break;\n    }\n    return pauseIndex;\n  }\n\n  let segStartTime = from;\n  let pauseIndex = nextPauseIndex(-1);\n  while (pauseIndex < pauses.length) {\n    segs.push({\n      from: segStartTime,\n      to: pauses[pauseIndex].time,\n      speed,\n      pause: pauses[pauseIndex],\n    });\n    segStartTime = pauses[pauseIndex].time;\n    pauseIndex = nextPauseIndex(pauseIndex);\n  }\n  segs.push({\n    from: segStartTime,\n    to,\n    speed,\n    pause: null,\n  });\n\n  return segs;\n}\n\nexport default defineComponent({\n  name: 'PausingVideoPlayer',\n  components: { VideoPlayer },\n  props: {\n    videoSrc: {\n      default: '',\n    },\n    drawPoseLandmarks: {\n      type: Boolean,\n      default: false,\n    },\n    videoOpacity: {\n      type: Number,\n      default: 1,\n    },\n    setDrawStyle: {\n      type: Function,\n      default: (canvasCtx: CanvasRenderingContext2D) => {\n        if (!canvasCtx) return;\n\n        /* eslint-disable no-param-reassign */\n        canvasCtx.strokeStyle = 'rgba(250, 200, 250, 0.95)';\n        canvasCtx.lineWidth = 7;\n        canvasCtx.lineCap = 'round';\n        /* eslint-enable no-param-reassign */\n      },\n    },\n    emphasizedJoints: {\n      type: Array,\n      default: Array,\n    },\n    emphasizedJointStyle: {\n      type: String,\n      default: 'red',\n    },\n    maxHeight: {\n      type: String,\n    },\n  },\n  emits: ['playback-completed', 'progress', 'pause-hit', 'pause-end'],\n  setup(props, { emit }) {\n    const videoPlayer = ref(null as null | typeof VideoPlayer);\n\n    let playTimeoutId = undefined as undefined | number;\n\n    function setTime(time: number) {\n      const vidPlayer = videoPlayer.value;\n      clearTimeout(playTimeoutId);\n      if (vidPlayer) vidPlayer.setTime(time);\n      emit('progress', time);\n    }\n\n    function onProgress(time: number) {\n      emit('progress', time);\n    }\n\n    function playSegment(seg: PlaySegment, delaySecs: number, emitResume?: boolean, onPlayStart?: () => void) {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) return;\n\n      clearTimeout(playTimeoutId);\n      playTimeoutId = setTimeout(() => {\n        if (emitResume ?? false) {\n          emit('pause-end');\n        }\n        vidPlayer.playVideo(seg.from, seg.to, seg.speed);\n        if (onPlayStart) onPlayStart();\n      }, 1000 * delaySecs);\n    }\n    onBeforeUnmount(() => {\n      clearTimeout(playTimeoutId);\n    });\n\n    let playingSegments: PlaySegment[] = [];\n    let playingSegmentIndex = 0;\n\n    function play(\n      from: number,\n      to: number,\n      speed: number,\n      pauses: Array<PauseInfo>,\n      playDelaySecs: number,\n      onPlayStart?: () => void,\n    ) {\n      clearTimeout(playTimeoutId);\n      setTime(from);\n      playingSegments = computePlaySegments(from, to, speed, pauses);\n      playingSegmentIndex = 0;\n\n      playSegment(playingSegments[playingSegmentIndex], playDelaySecs, false, onPlayStart);\n    }\n    function onSegmentPlaybackCompleted() {\n      const { pause, to } = playingSegments[playingSegmentIndex];\n      playingSegmentIndex += 1;\n      if (playingSegmentIndex >= playingSegments.length) {\n        setTime(to);\n        emit('playback-completed');\n        return;\n      }\n\n      if (!pause) throw new Error('Expected there to be a pause obj');\n      const nextSeg = playingSegments[playingSegmentIndex];\n\n      emit('pause-hit', pause);\n      const manualResume = pause.manualResume ?? false;\n      if (!manualResume) {\n        playSegment(nextSeg, pause.pauseDuration ?? DEFAULT_PAUSE_DURATION, true);\n      }\n    }\n\n    const currentPose = computed(() => videoPlayer.value?.currentPose ?? null);\n\n    return {\n      videoPlayer,\n      setTime,\n      onProgress,\n      onSegmentPlaybackCompleted,\n      play,\n      currentPose,\n    };\n  },\n  methods: {\n    getVideoDimensions() {\n      return (this.$refs.videoPlayer as typeof VideoPlayer)?.getVideoDimensions();\n    },\n    getVideoTime(): number {\n      return (this.videoPlayer as any)?.getVideoTime() ?? 0;\n    },\n  },\n});\n</script>\n\n<style>\n\n</style>\n","<template>\n  <div\n    class=\"is-relative video-player-container\"\n    :style=\"{\n      'max-height': maxHeight\n    }\"\n  >\n    <video\n      :src=\"videoUrl\"\n      :style=\"{\n        'max-height': maxHeight,\n        opacity: '' + videoOpacity,\n      }\"\n      ref=\"videoElement\"\n      @loadedmetadata=\"scheduleCanvasResizing\"\n      @ended=\"endReported = true\"\n    ></video>\n    <canvas class=\"is-overlay\" ref=\"canvasElement\"> </canvas>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { DrawPose } from '@/services/MediaPipe';\nimport { Landmark } from '@/services/MediaPipeTypes';\nimport poseProvider from '@/services/PoseProvider';\nimport {\n  computed,\n  defineComponent,\n  toRefs,\n  onMounted,\n  onBeforeUnmount,\n  ref,\n  nextTick,\n  Ref,\n  watch,\n} from 'vue';\n\nfunction onResize(canvasE: HTMLCanvasElement, videoE: HTMLVideoElement, modified: Ref<boolean>) {\n  nextTick(() => {\n    if (!canvasE || !videoE) return;\n\n    if (canvasE.width !== videoE.offsetWidth) {\n      // eslint-disable-next-line no-param-reassign\n      canvasE.width = videoE.offsetWidth;\n      // eslint-disable-next-line no-param-reassign\n      modified.value = true;\n    }\n    if (canvasE.height !== videoE.offsetHeight) {\n      // eslint-disable-next-line no-param-reassign\n      canvasE.height = videoE.offsetHeight;\n      // eslint-disable-next-line no-param-reassign\n      modified.value = true;\n    }\n  });\n}\n\nfunction setupCanvasResizing(\n  videoElement: Ref<null | HTMLVideoElement>,\n  canvasElement: Ref<null | HTMLCanvasElement>,\n  modified: Ref<boolean>,\n) {\n  function resizeCanvas() {\n    const videoE = videoElement.value;\n    const canvasE = canvasElement.value;\n    if (videoE && canvasE) onResize(canvasE, videoE, modified);\n  }\n  onMounted(() => {\n    window.addEventListener('resize', resizeCanvas);\n    nextTick(resizeCanvas);\n  });\n  onBeforeUnmount(() => {\n    window.removeEventListener('resize', resizeCanvas);\n  });\n  return resizeCanvas;\n}\n\nfunction setupVideoPlaying(\n  videoElement: Ref<HTMLVideoElement | null>,\n  startTime: Ref<number>,\n  endTime: Ref<number>,\n  startProgressUpdating: () => void,\n  endReported: Ref<boolean>,\n) {\n  function playVideo(\n    from: number,\n    to: number,\n    speed: number,\n  ) {\n    // console.log(`VideoPlayer :: Starting playback from ${from} to ${to} @ ${speed.toPrecision(2)}`);\n\n    // eslint-disable-next-line no-param-reassign\n    endReported.value = false;\n    // eslint-disable-next-line no-param-reassign\n    startTime.value = from;\n    // eslint-disable-next-line no-param-reassign\n    endTime.value = to;\n\n    const videoE = videoElement.value;\n    if (!videoE) {\n      console.error(\"VideoE is null - can't start playback\");\n      return;\n    }\n\n    videoE.pause();\n    videoE.playbackRate = speed;\n    videoE.currentTime = from;\n\n    nextTick(() => {\n      startProgressUpdating();\n      videoE.play();\n    });\n  }\n\n  function pauseVideo() {\n    const videoE = videoElement.value;\n    if (!videoE) {\n      console.error(\"VideoE is null - can't start playback\");\n      return;\n    }\n    videoE.pause();\n  }\n\n  return { playVideo, pauseVideo };\n}\n\nexport default defineComponent({\n  name: 'VideoPlayer',\n  props: {\n    videoBaseUrl: String,\n    maxHeight: String,\n    drawPoseLandmarks: {\n      type: Boolean,\n      default: false,\n    },\n    videoOpacity: {\n      type: Number,\n      default: 1,\n    },\n    fps: {\n      type: Number,\n      default: 30,\n    },\n    setDrawStyle: {\n      type: Function,\n      default: () => {},\n    },\n    emphasizedJoints: {\n      type: Array,\n      default: Array,\n    },\n    emphasizedJointStyle: {\n      type: String,\n      default: 'red',\n    },\n  },\n  emits: [\n    'playback-completed',\n    'progress',\n  ],\n  setup(props, ctx) {\n    const {\n      videoBaseUrl, drawPoseLandmarks, fps, setDrawStyle, emphasizedJoints, emphasizedJointStyle,\n    } = toRefs(props);\n\n    const videoElement = ref(null as null | HTMLVideoElement);\n    const canvasElement = ref(null as null | HTMLCanvasElement);\n    const canvasCtx = computed(() => canvasElement.value?.getContext('2d') as CanvasRenderingContext2D | null);\n\n    const startTime = ref(0);\n    const endTime = ref(0);\n    const videoUrl = computed(() => videoBaseUrl?.value ?? '');\n    const currentTime = ref(0);\n    const canvasModified = ref(false);\n\n    const resizeCanvas = setupCanvasResizing(videoElement, canvasElement, canvasModified);\n    const endReported = ref(false);\n\n    const poses = ref([] as Readonly<Array<Readonly<Array<Readonly<Landmark>>>>>);\n    const currentPose = computed(() => {\n      const frame = Math.floor(currentTime.value * fps.value);\n      const pose = poses.value[frame] ?? [];\n      return pose;\n    });\n\n    let prevTime = -1;\n    let timerId = -1;\n    function onTimeUpdated() {\n      const vidElement = videoElement.value;\n      if (!vidElement) return;\n\n      const time = vidElement.currentTime;\n      if (time === prevTime) return;\n      prevTime = time;\n\n      currentTime.value = time;\n\n      if (time + 1 / 60 >= endTime.value || endReported.value) {\n        vidElement.pause();\n        vidElement.currentTime = endTime.value; // pin to end time\n        ctx.emit('progress', endTime.value);\n        console.log('VideoPlayer :: playback-completed');\n        ctx.emit('playback-completed');\n        clearInterval(timerId);\n        timerId = -1;\n      } else {\n        ctx.emit('progress', time);\n      }\n    }\n\n    const startProgressUpdating = () => {\n      if (timerId !== -1) clearInterval(timerId);\n      timerId = setInterval(onTimeUpdated, 1000 / 30);\n    };\n\n    const { playVideo, pauseVideo } = setupVideoPlaying(\n      videoElement,\n      startTime,\n      endTime,\n      startProgressUpdating,\n      endReported,\n    );\n\n    function scheduleCanvasResizing() {\n      setTimeout(() => {\n        nextTick(resizeCanvas);\n      }, 100);\n    }\n\n    // Update pose drawing\n    function clearDrawing() {\n      const canvasE = canvasElement.value;\n      const drawCtx = canvasCtx.value;\n      if (!canvasE || !drawCtx) return;\n      drawCtx.clearRect(0, 0, canvasE.width, canvasE.height);\n    }\n    function drawPose(lms: Landmark[]) {\n      const drawCtx = canvasCtx.value;\n      if (!drawCtx) return;\n      setDrawStyle.value(drawCtx);\n      DrawPose(drawCtx, lms, {\n        emphasizedJoints: emphasizedJoints.value as number[],\n        emphasisStroke: emphasizedJointStyle.value,\n      });\n    }\n\n    watch([videoBaseUrl, drawPoseLandmarks], async () => {\n      if (!drawPoseLandmarks.value) {\n        poses.value = [];\n        return;\n      }\n\n      poses.value = await poseProvider.GetPose(videoBaseUrl?.value ?? '');\n    });\n    watch([canvasModified, currentPose, drawPoseLandmarks], () => {\n      canvasModified.value = false;\n      clearDrawing();\n\n      if (drawPoseLandmarks.value) {\n        drawPose(currentPose.value as any);\n      }\n    });\n\n    return {\n      videoUrl,\n      resizeCanvas,\n      videoElement,\n      canvasElement,\n      playVideo,\n      pauseVideo,\n      endTime,\n      scheduleCanvasResizing,\n      poses,\n      currentTime,\n      currentPose,\n      endReported,\n\n      getVideoDimensions: () => ({\n        height: videoElement.value?.height ?? 0,\n        width: videoElement.value?.width ?? 0,\n      }),\n    };\n  },\n  methods: {\n    setTime(time: number, keepPlaying?: boolean | undefined) {\n      const videoE = this.videoElement;\n      if (videoE) {\n        videoE.currentTime = time;\n      }\n      const pauseVideo = !(keepPlaying ?? false);\n      if (videoE && pauseVideo) videoE.pause();\n    },\n    getVideoTime() {\n      return this.videoElement?.currentTime ?? 0;\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n.video-player-container {\n  canvas {\n    margin: auto;\n  }\n\n  video {\n    border-radius: 0.25rem;\n    display: block;\n    margin: auto;\n  }\n}\n</style>\n","// import parse from 'csv-parse';\n\nimport Parser, { Row } from '@gregoranders/csv';\nimport { Landmark } from '@/services/MediaPipeTypes';\n\nexport class PoseProvider {\n\n  private poseFiles: Map<string, Readonly<Array<Readonly<Array<Readonly<Landmark>>>>>> = new Map();\n\n  async GetPose(videoName: string) {\n    if (videoName.length < 4) return [];\n\n    const poseFilename = videoName.replace('dances', 'poses').replace('.mp4', '.poses.csv')\n    const cached = this.poseFiles.get(poseFilename);\n    if (cached !== undefined) return cached;\n\n    const stored = localStorage.getItem(poseFilename);\n    if (stored !== null) {\n      const poses = JSON.parse(stored) as Readonly<Array<Readonly<Array<Readonly<Landmark>>>>>;\n      this.poseFiles.set(poseFilename, Object.freeze(poses));\n      return poses;\n    }\n\n    const poseFile = await PoseProvider.getPoseFile(poseFilename);\n    const poses = PoseProvider.convertToPoseList(poseFile);\n    this.poseFiles.set(poseFilename, poses);\n\n    localStorage.setItem(poseFilename, JSON.stringify(poses));\n\n    return poses;\n  }\n\n  private static async getPoseFile(url: string) {\n\n    const response = await fetch(url);\n    if (!response.ok) throw new Error(`Error fetching pose file: ${response.statusText}`);\n\n    const text = await response.text();\n\n    return new Parser().parse(text);\n  }\n\n  private static convertToPoseList(csv: readonly Row[]) {\n    const temp = csv.map((row) => PoseProvider.convertRow(row));\n    return Object.freeze(temp.filter((x) => x.length > 0));\n  }\n\n  private static convertRow(row: Row) {\n    if (row.length === 0) return [];\n    if (row[0].startsWith('#')) return [];\n\n    const lms = [] as Array<Readonly<Landmark>>;\n    for (let i = 0; i + 2 < row.length; i += 3) {\n      lms.push(\n        Object.freeze({\n          x: Number.parseFloat(row[i]),\n          y: Number.parseFloat(row[i + 1]),\n          visibility: Number.parseFloat(row[i + 2]),\n        }),\n      );\n    }\n\n    return Object.freeze(lms);\n  }\n}\n\nconst poseProvider = new PoseProvider();\n\nexport default poseProvider;\n","\nimport { DrawPose } from '@/services/MediaPipe';\nimport { Landmark } from '@/services/MediaPipeTypes';\nimport poseProvider from '@/services/PoseProvider';\nimport {\n  computed,\n  defineComponent,\n  toRefs,\n  onMounted,\n  onBeforeUnmount,\n  ref,\n  nextTick,\n  Ref,\n  watch,\n} from 'vue';\n\nfunction onResize(canvasE: HTMLCanvasElement, videoE: HTMLVideoElement, modified: Ref<boolean>) {\n  nextTick(() => {\n    if (!canvasE || !videoE) return;\n\n    if (canvasE.width !== videoE.offsetWidth) {\n      // eslint-disable-next-line no-param-reassign\n      canvasE.width = videoE.offsetWidth;\n      // eslint-disable-next-line no-param-reassign\n      modified.value = true;\n    }\n    if (canvasE.height !== videoE.offsetHeight) {\n      // eslint-disable-next-line no-param-reassign\n      canvasE.height = videoE.offsetHeight;\n      // eslint-disable-next-line no-param-reassign\n      modified.value = true;\n    }\n  });\n}\n\nfunction setupCanvasResizing(\n  videoElement: Ref<null | HTMLVideoElement>,\n  canvasElement: Ref<null | HTMLCanvasElement>,\n  modified: Ref<boolean>,\n) {\n  function resizeCanvas() {\n    const videoE = videoElement.value;\n    const canvasE = canvasElement.value;\n    if (videoE && canvasE) onResize(canvasE, videoE, modified);\n  }\n  onMounted(() => {\n    window.addEventListener('resize', resizeCanvas);\n    nextTick(resizeCanvas);\n  });\n  onBeforeUnmount(() => {\n    window.removeEventListener('resize', resizeCanvas);\n  });\n  return resizeCanvas;\n}\n\nfunction setupVideoPlaying(\n  videoElement: Ref<HTMLVideoElement | null>,\n  startTime: Ref<number>,\n  endTime: Ref<number>,\n  startProgressUpdating: () => void,\n  endReported: Ref<boolean>,\n) {\n  function playVideo(\n    from: number,\n    to: number,\n    speed: number,\n  ) {\n    // console.log(`VideoPlayer :: Starting playback from ${from} to ${to} @ ${speed.toPrecision(2)}`);\n\n    // eslint-disable-next-line no-param-reassign\n    endReported.value = false;\n    // eslint-disable-next-line no-param-reassign\n    startTime.value = from;\n    // eslint-disable-next-line no-param-reassign\n    endTime.value = to;\n\n    const videoE = videoElement.value;\n    if (!videoE) {\n      console.error(\"VideoE is null - can't start playback\");\n      return;\n    }\n\n    videoE.pause();\n    videoE.playbackRate = speed;\n    videoE.currentTime = from;\n\n    nextTick(() => {\n      startProgressUpdating();\n      videoE.play();\n    });\n  }\n\n  function pauseVideo() {\n    const videoE = videoElement.value;\n    if (!videoE) {\n      console.error(\"VideoE is null - can't start playback\");\n      return;\n    }\n    videoE.pause();\n  }\n\n  return { playVideo, pauseVideo };\n}\n\nexport default defineComponent({\n  name: 'VideoPlayer',\n  props: {\n    videoBaseUrl: String,\n    maxHeight: String,\n    drawPoseLandmarks: {\n      type: Boolean,\n      default: false,\n    },\n    videoOpacity: {\n      type: Number,\n      default: 1,\n    },\n    fps: {\n      type: Number,\n      default: 30,\n    },\n    setDrawStyle: {\n      type: Function,\n      default: () => {},\n    },\n    emphasizedJoints: {\n      type: Array,\n      default: Array,\n    },\n    emphasizedJointStyle: {\n      type: String,\n      default: 'red',\n    },\n  },\n  emits: [\n    'playback-completed',\n    'progress',\n  ],\n  setup(props, ctx) {\n    const {\n      videoBaseUrl, drawPoseLandmarks, fps, setDrawStyle, emphasizedJoints, emphasizedJointStyle,\n    } = toRefs(props);\n\n    const videoElement = ref(null as null | HTMLVideoElement);\n    const canvasElement = ref(null as null | HTMLCanvasElement);\n    const canvasCtx = computed(() => canvasElement.value?.getContext('2d') as CanvasRenderingContext2D | null);\n\n    const startTime = ref(0);\n    const endTime = ref(0);\n    const videoUrl = computed(() => videoBaseUrl?.value ?? '');\n    const currentTime = ref(0);\n    const canvasModified = ref(false);\n\n    const resizeCanvas = setupCanvasResizing(videoElement, canvasElement, canvasModified);\n    const endReported = ref(false);\n\n    const poses = ref([] as Readonly<Array<Readonly<Array<Readonly<Landmark>>>>>);\n    const currentPose = computed(() => {\n      const frame = Math.floor(currentTime.value * fps.value);\n      const pose = poses.value[frame] ?? [];\n      return pose;\n    });\n\n    let prevTime = -1;\n    let timerId = -1;\n    function onTimeUpdated() {\n      const vidElement = videoElement.value;\n      if (!vidElement) return;\n\n      const time = vidElement.currentTime;\n      if (time === prevTime) return;\n      prevTime = time;\n\n      currentTime.value = time;\n\n      if (time + 1 / 60 >= endTime.value || endReported.value) {\n        vidElement.pause();\n        vidElement.currentTime = endTime.value; // pin to end time\n        ctx.emit('progress', endTime.value);\n        console.log('VideoPlayer :: playback-completed');\n        ctx.emit('playback-completed');\n        clearInterval(timerId);\n        timerId = -1;\n      } else {\n        ctx.emit('progress', time);\n      }\n    }\n\n    const startProgressUpdating = () => {\n      if (timerId !== -1) clearInterval(timerId);\n      timerId = setInterval(onTimeUpdated, 1000 / 30);\n    };\n\n    const { playVideo, pauseVideo } = setupVideoPlaying(\n      videoElement,\n      startTime,\n      endTime,\n      startProgressUpdating,\n      endReported,\n    );\n\n    function scheduleCanvasResizing() {\n      setTimeout(() => {\n        nextTick(resizeCanvas);\n      }, 100);\n    }\n\n    // Update pose drawing\n    function clearDrawing() {\n      const canvasE = canvasElement.value;\n      const drawCtx = canvasCtx.value;\n      if (!canvasE || !drawCtx) return;\n      drawCtx.clearRect(0, 0, canvasE.width, canvasE.height);\n    }\n    function drawPose(lms: Landmark[]) {\n      const drawCtx = canvasCtx.value;\n      if (!drawCtx) return;\n      setDrawStyle.value(drawCtx);\n      DrawPose(drawCtx, lms, {\n        emphasizedJoints: emphasizedJoints.value as number[],\n        emphasisStroke: emphasizedJointStyle.value,\n      });\n    }\n\n    watch([videoBaseUrl, drawPoseLandmarks], async () => {\n      if (!drawPoseLandmarks.value) {\n        poses.value = [];\n        return;\n      }\n\n      poses.value = await poseProvider.GetPose(videoBaseUrl?.value ?? '');\n    });\n    watch([canvasModified, currentPose, drawPoseLandmarks], () => {\n      canvasModified.value = false;\n      clearDrawing();\n\n      if (drawPoseLandmarks.value) {\n        drawPose(currentPose.value as any);\n      }\n    });\n\n    return {\n      videoUrl,\n      resizeCanvas,\n      videoElement,\n      canvasElement,\n      playVideo,\n      pauseVideo,\n      endTime,\n      scheduleCanvasResizing,\n      poses,\n      currentTime,\n      currentPose,\n      endReported,\n\n      getVideoDimensions: () => ({\n        height: videoElement.value?.height ?? 0,\n        width: videoElement.value?.width ?? 0,\n      }),\n    };\n  },\n  methods: {\n    setTime(time: number, keepPlaying?: boolean | undefined) {\n      const videoE = this.videoElement;\n      if (videoE) {\n        videoE.currentTime = time;\n      }\n      const pauseVideo = !(keepPlaying ?? false);\n      if (videoE && pauseVideo) videoE.pause();\n    },\n    getVideoTime() {\n      return this.videoElement?.currentTime ?? 0;\n    },\n  },\n});\n","import { render } from \"./VideoPlayer.vue?vue&type=template&id=8096110c\"\nimport script from \"./VideoPlayer.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoPlayer.vue?vue&type=script&lang=ts\"\n\nimport \"./VideoPlayer.vue?vue&type=style&index=0&id=8096110c&lang=scss\"\nscript.render = render\n\nexport default script","\n\nimport Constants from '@/services/Constants';\nimport { PauseInfo } from '@/model/DanceLesson';\nimport {\n  computed, defineComponent, onBeforeUnmount, ref,\n} from 'vue';\nimport VideoPlayer from './VideoPlayer.vue';\n\nconst DEFAULT_PAUSE_DURATION = Constants.DefaultPauseDuration;\n\ntype PlaySegment = {\n  from: number;\n  to: number;\n  speed: number;\n  pause: PauseInfo | null;\n}\nfunction computePlaySegments(from: number, to: number, speed: number, pauses: PauseInfo[]) {\n  const segs: PlaySegment[] = [];\n\n  function nextPauseIndex(prevIndex: number): number {\n    const pTime = Math.max((pauses[prevIndex]?.time ?? 0), from);\n    let pauseIndex = prevIndex + 1;\n    for (; pauseIndex < pauses.length; pauseIndex += 1) {\n      const pi = pauses[pauseIndex];\n      if (pi.time > pTime) break;\n    }\n    return pauseIndex;\n  }\n\n  let segStartTime = from;\n  let pauseIndex = nextPauseIndex(-1);\n  while (pauseIndex < pauses.length) {\n    segs.push({\n      from: segStartTime,\n      to: pauses[pauseIndex].time,\n      speed,\n      pause: pauses[pauseIndex],\n    });\n    segStartTime = pauses[pauseIndex].time;\n    pauseIndex = nextPauseIndex(pauseIndex);\n  }\n  segs.push({\n    from: segStartTime,\n    to,\n    speed,\n    pause: null,\n  });\n\n  return segs;\n}\n\nexport default defineComponent({\n  name: 'PausingVideoPlayer',\n  components: { VideoPlayer },\n  props: {\n    videoSrc: {\n      default: '',\n    },\n    drawPoseLandmarks: {\n      type: Boolean,\n      default: false,\n    },\n    videoOpacity: {\n      type: Number,\n      default: 1,\n    },\n    setDrawStyle: {\n      type: Function,\n      default: (canvasCtx: CanvasRenderingContext2D) => {\n        if (!canvasCtx) return;\n\n        /* eslint-disable no-param-reassign */\n        canvasCtx.strokeStyle = 'rgba(250, 200, 250, 0.95)';\n        canvasCtx.lineWidth = 7;\n        canvasCtx.lineCap = 'round';\n        /* eslint-enable no-param-reassign */\n      },\n    },\n    emphasizedJoints: {\n      type: Array,\n      default: Array,\n    },\n    emphasizedJointStyle: {\n      type: String,\n      default: 'red',\n    },\n    maxHeight: {\n      type: String,\n    },\n  },\n  emits: ['playback-completed', 'progress', 'pause-hit', 'pause-end'],\n  setup(props, { emit }) {\n    const videoPlayer = ref(null as null | typeof VideoPlayer);\n\n    let playTimeoutId = undefined as undefined | number;\n\n    function setTime(time: number) {\n      const vidPlayer = videoPlayer.value;\n      clearTimeout(playTimeoutId);\n      if (vidPlayer) vidPlayer.setTime(time);\n      emit('progress', time);\n    }\n\n    function onProgress(time: number) {\n      emit('progress', time);\n    }\n\n    function playSegment(seg: PlaySegment, delaySecs: number, emitResume?: boolean, onPlayStart?: () => void) {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) return;\n\n      clearTimeout(playTimeoutId);\n      playTimeoutId = setTimeout(() => {\n        if (emitResume ?? false) {\n          emit('pause-end');\n        }\n        vidPlayer.playVideo(seg.from, seg.to, seg.speed);\n        if (onPlayStart) onPlayStart();\n      }, 1000 * delaySecs);\n    }\n    onBeforeUnmount(() => {\n      clearTimeout(playTimeoutId);\n    });\n\n    let playingSegments: PlaySegment[] = [];\n    let playingSegmentIndex = 0;\n\n    function play(\n      from: number,\n      to: number,\n      speed: number,\n      pauses: Array<PauseInfo>,\n      playDelaySecs: number,\n      onPlayStart?: () => void,\n    ) {\n      clearTimeout(playTimeoutId);\n      setTime(from);\n      playingSegments = computePlaySegments(from, to, speed, pauses);\n      playingSegmentIndex = 0;\n\n      playSegment(playingSegments[playingSegmentIndex], playDelaySecs, false, onPlayStart);\n    }\n    function onSegmentPlaybackCompleted() {\n      const { pause, to } = playingSegments[playingSegmentIndex];\n      playingSegmentIndex += 1;\n      if (playingSegmentIndex >= playingSegments.length) {\n        setTime(to);\n        emit('playback-completed');\n        return;\n      }\n\n      if (!pause) throw new Error('Expected there to be a pause obj');\n      const nextSeg = playingSegments[playingSegmentIndex];\n\n      emit('pause-hit', pause);\n      const manualResume = pause.manualResume ?? false;\n      if (!manualResume) {\n        playSegment(nextSeg, pause.pauseDuration ?? DEFAULT_PAUSE_DURATION, true);\n      }\n    }\n\n    const currentPose = computed(() => videoPlayer.value?.currentPose ?? null);\n\n    return {\n      videoPlayer,\n      setTime,\n      onProgress,\n      onSegmentPlaybackCompleted,\n      play,\n      currentPose,\n    };\n  },\n  methods: {\n    getVideoDimensions() {\n      return (this.$refs.videoPlayer as typeof VideoPlayer)?.getVideoDimensions();\n    },\n    getVideoTime(): number {\n      return (this.videoPlayer as any)?.getVideoTime() ?? 0;\n    },\n  },\n});\n","import { render } from \"./PausingVideoPlayer.vue?vue&type=template&id=3147f088\"\nimport script from \"./PausingVideoPlayer.vue?vue&type=script&lang=ts\"\nexport * from \"./PausingVideoPlayer.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"is-relative webcam-box\">\n    <video\n      ref=\"videoE\" muted disablePictureInPicture\n      :style=\"{\n        'max-height': maxHeight,\n      }\"\n    ></video>\n    <div class=\"is-overlay\" v-if=\"webcamStatus !== 'running'\">\n      <div class=\"vcenter-parent\">\n        <div class=\"notification\" v-if=\"this.webcamStartError !== null\">\n          {{this.webcamStartError}}\n        </div>\n        <button\n          @click=\"startWebcam\"\n          class=\"button is-primary\"\n          v-show=\"webcamStatus !== 'running'\"\n          :class=\"{'is-loading': webcamStatus==='loading'}\">\n          Start Webcam\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\n\nimport {\n  defineComponent, onBeforeUnmount, onMounted, ref, watch,\n} from 'vue';\n\nimport webcamProvider from '@/services/WebcamProvider';\n\nexport default defineComponent({\n  name: 'WebcamBox',\n  props: {\n    enableRecordButton: {\n      type: Boolean,\n      default: false,\n    },\n    maxHeight: {\n      type: String,\n    },\n  },\n  setup() {\n    // const enableRecordButton = toRefs(props);\n\n    const videoE = ref(null as null | HTMLVideoElement);\n    const webcamStartError = ref(null as null | any);\n\n    onMounted(() => {\n      if (!videoE.value) throw new Error('videoE is null');\n      if (webcamProvider.webcamStatus.value === 'running') {\n        webcamProvider.connectVideoElement(videoE.value);\n      }\n    });\n    watch(webcamProvider.webcamStatus, (status) => {\n      if (status === 'running' && videoE.value) {\n        webcamProvider.connectVideoElement(videoE.value);\n      }\n    });\n    onBeforeUnmount(() => {\n      if (!videoE.value) throw new Error('videoE is null');\n      webcamProvider.disconnectVideoElement(videoE.value);\n    });\n\n    return {\n      videoE,\n      webcamStartError,\n      webcamProvider,\n      webcamStatus: webcamProvider.webcamStatus,\n      isRecording: webcamProvider.isRecording,\n    };\n  },\n  methods: {\n    async startWebcam() {\n      this.webcamStartError = null;\n\n      try {\n        await webcamProvider.startWebcam();\n      } catch (e) {\n        this.webcamStartError = e;\n      }\n\n      if (!this.videoE) throw new Error('videoE is null');\n      await webcamProvider.connectVideoElement(this.videoE);\n    },\n    playVideo() {\n      if (!this.videoE) throw new Error('videoE is null');\n      this.videoE.play();\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n.webcam-box {\n\n  max-width: 100%;\n  max-height: 100%;\n\n  video {\n    background: rgba(128, 128, 128, 0.5);\n    width: 1280px;\n    // height: 720px;\n    max-height: 100%;\n    max-width: 100%;\n\n    transform: scaleX(-1);\n  }\n}\n</style>\n","\n\nimport {\n  defineComponent, onBeforeUnmount, onMounted, ref, watch,\n} from 'vue';\n\nimport webcamProvider from '@/services/WebcamProvider';\n\nexport default defineComponent({\n  name: 'WebcamBox',\n  props: {\n    enableRecordButton: {\n      type: Boolean,\n      default: false,\n    },\n    maxHeight: {\n      type: String,\n    },\n  },\n  setup() {\n    // const enableRecordButton = toRefs(props);\n\n    const videoE = ref(null as null | HTMLVideoElement);\n    const webcamStartError = ref(null as null | any);\n\n    onMounted(() => {\n      if (!videoE.value) throw new Error('videoE is null');\n      if (webcamProvider.webcamStatus.value === 'running') {\n        webcamProvider.connectVideoElement(videoE.value);\n      }\n    });\n    watch(webcamProvider.webcamStatus, (status) => {\n      if (status === 'running' && videoE.value) {\n        webcamProvider.connectVideoElement(videoE.value);\n      }\n    });\n    onBeforeUnmount(() => {\n      if (!videoE.value) throw new Error('videoE is null');\n      webcamProvider.disconnectVideoElement(videoE.value);\n    });\n\n    return {\n      videoE,\n      webcamStartError,\n      webcamProvider,\n      webcamStatus: webcamProvider.webcamStatus,\n      isRecording: webcamProvider.isRecording,\n    };\n  },\n  methods: {\n    async startWebcam() {\n      this.webcamStartError = null;\n\n      try {\n        await webcamProvider.startWebcam();\n      } catch (e) {\n        this.webcamStartError = e;\n      }\n\n      if (!this.videoE) throw new Error('videoE is null');\n      await webcamProvider.connectVideoElement(this.videoE);\n    },\n    playVideo() {\n      if (!this.videoE) throw new Error('videoE is null');\n      this.videoE.play();\n    },\n  },\n});\n","import { render } from \"./WebcamBox.vue?vue&type=template&id=584a541e\"\nimport script from \"./WebcamBox.vue?vue&type=script&lang=ts\"\nexport * from \"./WebcamBox.vue?vue&type=script&lang=ts\"\n\nimport \"./WebcamBox.vue?vue&type=style&index=0&id=584a541e&lang=scss\"\nscript.render = render\n\nexport default script","\nimport Constants from '@/services/Constants';\nimport DanceLesson, { Activity, PauseInfo, DanceUtils } from '@/model/DanceLesson';\nimport {\n  computed, ComputedRef, defineComponent, nextTick, onBeforeUnmount, onMounted, Ref, ref, toRefs, watch,\n} from 'vue';\nimport {\n  GestureNames, setupGestureListening, setupMediaPipeListening, TrackingActions,\n} from '@/services/EventHub';\nimport { DatabaseEntry } from '@/services/MotionDatabase';\nimport motionRecorder from '@/services/MotionRecorder';\nimport InstructionCarousel, { Instruction } from '@/components/elements/InstructionCarousel.vue';\nimport { Landmark } from '@/services/MediaPipeTypes';\nimport Utils from '@/services/Utils';\nimport SegmentedProgressBar, { ProgressSegmentData, calculateProgressSegments } from '../elements/SegmentedProgressBar.vue';\nimport PausingVideoPlayer from '../elements/PausingVideoPlayer.vue';\nimport WebcamBox from '../elements/WebcamBox.vue';\nimport GestureIcon from '../elements/GestureIcon.vue';\n\nconst { DefaultPauseDuration } = Constants; // 1.5 seconds\n\nconst ActivityPlayState = Object.freeze({\n  AwaitingPlayGesture: 'AwaitingPlayGesture',\n  PendingStart: 'PendingStart',\n  Playing: 'Playing',\n  ActivityEnded: 'ActivityEnded',\n});\n\n//\n// TODO!\n//   * Update segment breaks in activity to have the first activity\n//     start time and the last activity end time.\n//\n\nconst TRACKING_ID = 'LearningScreen';\n\nfunction setupFrameRecording(activity: ComputedRef<Activity | null>, videoTime: Ref<number>, videoPlayer: Ref<null | typeof PausingVideoPlayer>, playActivity: Function) {\n  const isSavingFrames = ref(false);\n  let recordingSessionId = -1;\n\n  const lastPose = {\n    frameId: -1,\n    pose: null as null | Landmark[],\n    timestamp: 0,\n  };\n\n  setupMediaPipeListening(\n    (mpResults, frameId) => {\n      // console.log('Got mp result');\n      if (frameId !== lastPose.frameId) {\n        console.warn(`Skipping motion recording frame -- proceesed frameId ${frameId} doesn't match stored pose with id: ${lastPose.frameId}`);\n        return;\n      }\n      if (isSavingFrames.value) {\n        motionRecorder.saveMotionFrame(\n          recordingSessionId,\n          lastPose.timestamp,\n          mpResults,\n          { poseLandmarks: lastPose.pose ?? undefined },\n        );\n      }\n    },\n    (frameId) => {\n      lastPose.frameId = frameId;\n      lastPose.pose = videoPlayer.value?.currentPose ?? null;\n      lastPose.timestamp = videoTime.value;\n    },\n  );\n  const canSaveFrame = computed(() => {\n    if (isSavingFrames.value) return false;\n    if (!activity.value) return false;\n    return activity.value.demoVisual === 'skeleton' && activity.value.userVisual !== 'none';\n  });\n  async function startSaveFrames() {\n    recordingSessionId = await motionRecorder.startRecordingSession(\n      { width: 640, height: 480 },\n      videoPlayer.value?.getVideoDimensions(),\n    );\n\n    isSavingFrames.value = true;\n\n    playActivity(5, true);\n  }\n  async function concludeSaveFrames() {\n\n    await Utils.sleep(1.5);\n\n    isSavingFrames.value = false;\n\n    await motionRecorder.endRecordingSession(\n      recordingSessionId,\n      activity.value?.startTime ?? -1,\n      activity.value?.endTime ?? -1,\n    );\n  }\n\n  return {\n    isSavingFrames, canSaveFrame, startSaveFrames, concludeSaveFrames,\n  };\n}\n\nexport default defineComponent({\n  components: {\n    SegmentedProgressBar,\n    PausingVideoPlayer,\n    InstructionCarousel,\n    WebcamBox,\n    GestureIcon,\n  },\n  props: {\n    targetDance: Object,\n    targetLesson: Object,\n  },\n  setup(props, { emit }) {\n\n    const { targetLesson, targetDance } = toRefs(props);\n\n    const activityState = ref(ActivityPlayState.AwaitingPlayGesture);\n    const showPlayGestureIcon = computed(() => activityState.value === ActivityPlayState.AwaitingPlayGesture);\n\n    const videoPlayer = ref(null as null | typeof PausingVideoPlayer);\n    const videoTime = ref(0);\n\n    const activityId = ref(0);\n    const activity = computed(() => {\n      const lesson = targetLesson?.value as unknown as DanceLesson | null;\n      return lesson?.activities[activityId.value] ?? null;\n    });\n\n    const emphasizedJoints = computed(() => activity.value?.emphasizedJoints ?? []);\n    const activityTitle = computed(() => activity.value?.title ?? '');\n    const activityCount = computed(() => {\n      const lesson = targetLesson?.value as unknown as DanceLesson | null;\n      return lesson?.activities?.length ?? 0;\n    });\n    const hasNextActivity = computed(() => activityCount.value > activityId.value + 1);\n    // eslint-disable-next-line max-len\n    const activityFinished = computed(() => activityState.value === ActivityPlayState.ActivityEnded);\n    const nextActivityTitle = computed(() => {\n      if (!hasNextActivity.value) return 'Finish Lesson';\n      const lesson = targetLesson?.value as unknown as DanceLesson | null;\n\n      const nextActivity = lesson?.activities[activityId.value + 1];\n      return nextActivity?.title ?? 'Unknown';\n    });\n\n    const pauseInstructs = ref([] as Instruction[]);\n    function onPauseHit(pause: PauseInfo) {\n      if (pause.instruction) {\n        pauseInstructs.value.push({\n          id: pause.time,\n          text: pause.instruction,\n        });\n      }\n    }\n    function onPauseEnded() {\n      // Remove all pause instructions\n      pauseInstructs.value.splice(0);\n    }\n\n    const instructions = computed(() => {\n      const mActivity = activity.value;\n      const state = activityState.value;\n      if (!mActivity) return [];\n\n      const instructs: Instruction[] = [];\n\n      if ((state === ActivityPlayState.AwaitingPlayGesture || state === ActivityPlayState.PendingStart) && mActivity.startInstruction) {\n        instructs.push({\n          id: 1,\n          text: mActivity.startInstruction,\n        });\n      } else if (state === ActivityPlayState.Playing && mActivity.playingInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.playingInstruction,\n        });\n      } else if (state === ActivityPlayState.ActivityEnded && mActivity.endInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.endInstruction,\n        });\n      }\n\n      return instructs;\n    });\n    const timedInstructions = computed(() => {\n      const mActivity = activity.value;\n      const time = videoTime.value;\n      if (!mActivity) return [];\n\n      const activeTimedInstructions = mActivity.timedInstructions?.map(\n        (ti, i) => ({\n          id: i,\n          text: ti.text,\n          start: ti.startTime,\n          end: ti.endTime,\n        })\n      ).filter((ti) => ti.start <= time && time < ti.end) ?? [];\n\n      return activeTimedInstructions;\n    });\n\n    const progressSegments = computed(() => {\n      const lesson = targetLesson?.value as DanceLesson | undefined;\n      const curActivity = activity.value;\n      if (lesson && curActivity) return calculateProgressSegments(lesson, curActivity);\n      return [];\n    });\n\n    function playVideo(vidActivity: Activity, pause?: number | undefined) {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) {\n        console.error('LEARNING SCREEN:: Aborting video playback: vidPlayer is null');\n        return;\n      }\n\n      activityState.value = ActivityPlayState.PendingStart;\n\n      vidPlayer.play(\n        vidActivity.startTime,\n        vidActivity.endTime,\n        vidActivity.practiceSpeed ?? 1,\n        vidActivity.pauses ?? [],\n        pause ?? DefaultPauseDuration,\n        () => {\n          activityState.value = ActivityPlayState.Playing;\n        },\n      );\n    }\n\n    function playActivity(pause?: number | undefined, forcePlay?: boolean | undefined) {\n\n      pauseInstructs.value.splice(0);\n      activityState.value = ActivityPlayState.AwaitingPlayGesture;\n      const vidActivity = activity.value;\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer || !vidActivity) {\n        console.error('LEARNING SCREEN:: Aborting video playback: vidPlayer or lessonActivity is null', vidPlayer, vidActivity);\n        return;\n      }\n      const startingNow = forcePlay || (activityId.value !== 0 && !DanceUtils.shouldPauseBeforeActivity(vidActivity));\n\n      vidPlayer.setTime(vidActivity.startTime);\n\n      if (startingNow) {\n        playVideo(vidActivity, pause);\n        console.log(`LEARNING SCREEN:: Scheduling playback for activity ${activityId.value}`);\n      } else {\n        console.log(`LEARNING SCREEN:: Setting start & pausing for userinput for activity ${activityId.value}`);\n      }\n    }\n\n    function gotoActivity(delta: number) {\n      activityState.value = ActivityPlayState.AwaitingPlayGesture;\n      if (!hasNextActivity.value) {\n        emit('lesson-completed');\n        return;\n      }\n      if (activityId.value === 0 && delta < 0) {\n        // Don't adjust activityId - we can't go back (simply repeat).\n        playActivity();\n        return;\n      }\n      activityId.value += delta;\n      playActivity();\n    }\n    function repeatActivity() {\n      gotoActivity(0);\n    }\n    function gotoPreviousActivity() {\n      gotoActivity(-1);\n    }\n\n    function gotoNextActivity() {\n      gotoActivity(1);\n    }\n\n    const {\n      isSavingFrames, canSaveFrame, startSaveFrames, concludeSaveFrames,\n    } = setupFrameRecording(activity, videoTime, videoPlayer, playActivity);\n\n    function onActivityFinished() {\n      activityState.value = ActivityPlayState.ActivityEnded;\n      console.log('LEARNING SCREEN:: Activity finished');\n\n      if (isSavingFrames.value) concludeSaveFrames();\n    }\n\n    const isTrackingUser = computed(() => {\n      if (activity.value?.userVisual === 'skeleton') return true;\n      if (activityState.value === ActivityPlayState.ActivityEnded || activityState.value === ActivityPlayState.AwaitingPlayGesture) return true;\n      if (isSavingFrames.value) return true;\n      return false;\n    });\n    watch(isTrackingUser, (val) => {\n      if (val) TrackingActions.requestTracking(TRACKING_ID);\n      else TrackingActions.endTrackingRequest(TRACKING_ID);\n    });\n\n    onMounted(() => {\n      nextTick(() => {\n        if (isTrackingUser.value) TrackingActions.requestTracking(TRACKING_ID);\n        else TrackingActions.endTrackingRequest(TRACKING_ID);\n      });\n    });\n\n    setupGestureListening({\n      [GestureNames.pointRight]: () => {\n        if (!activityFinished.value) return;\n        gotoNextActivity();\n      },\n      [GestureNames.pointLeft]: () => {\n        if (!activityFinished.value) return;\n        playActivity();\n      },\n      [GestureNames.namaste]: () => {\n        if (activityState.value === ActivityPlayState.AwaitingPlayGesture) {\n          playActivity(undefined, true);\n        }\n      },\n    });\n    onBeforeUnmount(() => {\n      TrackingActions.endTrackingRequest(TRACKING_ID);\n    });\n\n    onMounted(() => {\n      playActivity();\n    });\n\n    return {\n      activityState,\n      ActivityPlayState,\n      showPlayGestureIcon,\n      playActivity,\n      progressSegments,\n      activity,\n      activityId,\n      activityCount,\n      activityTitle,\n      emphasizedJoints,\n      nextActivityTitle,\n      instructions,\n      timedInstructions,\n      videoPlayer,\n      activityFinished,\n      videoTime,\n      onActivityFinished,\n\n      onPauseHit,\n      onPauseEnded,\n\n      gotoPreviousActivity,\n      repeatActivity,\n      gotoNextActivity,\n      hasNextActivity,\n\n      canSaveFrame,\n      isSavingFrames,\n      startSaveFrames,\n      isTrackingUser,\n    };\n  },\n  methods: {\n    onTimeChanged(time: number) {\n      this.videoTime = time;\n    },\n  },\n});\n","import { render } from \"./LearningScreen.vue?vue&type=template&id=9452b712\"\nimport script from \"./LearningScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./LearningScreen.vue?vue&type=script&lang=ts\"\n\nimport \"./LearningScreen.vue?vue&type=style&index=0&id=9452b712&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n   <div class=\"webcam-prompt-card vcenter-parent\" >\n        <div class=\"card\">\n          <div class=\"card-header\">\n            <h3 class=\"card-header-title\">\n            Webcam Access Needed\n            </h3>\n          </div>\n          <div class=\"card-content\">\n            <div class=\"content\">\n              <p>\n                During the lesson, you'll step back from your computer\n                and control this app with gestures. Later on, we'll also\n                use your webcam to give you tips on your technique.\n              </p>\n              <p class=\"notification is-warning\">\n                Please <strong>stop other programs that are using your webcam</strong>. On most computers, only one app is able to use the webcam at a time.\n              </p>\n              <p>\n                <strong>To continue, please grant access to your webcam.</strong>\n              </p>\n            </div>\n          </div>\n          <div class=\"card-content\">\n            <div class=\"buttons is-right\">\n              <a @click=\"$emit('cancelSelected')\" class=\"is-inverted button is-danger\">\n                Cancel\n              </a>\n              <a @click=\"$emit('startWebcamSelected')\" class=\"button is-primary\">\n                Start Webcam\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n</template>\n\n<script>\n\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  name: 'WebcamPromptCard',\n});\n</script>\n\n<style lang=\"scss\">\n\n.webcam-prompt-card .content {\n  max-width: 60ch;\n  text-align: left;\n}\n</style>\n","import { render } from \"./WebcamPromptCard.vue?vue&type=template&id=07a96404\"\nimport script from \"./WebcamPromptCard.vue?vue&type=script&lang=js\"\nexport * from \"./WebcamPromptCard.vue?vue&type=script&lang=js\"\n\nimport \"./WebcamPromptCard.vue?vue&type=style&index=0&id=07a96404&lang=scss\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"pose-drawer p-4 content\">\n    <teleport to=\"#topbarLeft\">\n      <button class=\"button\" @click=\"$emit('back-selected')\">&lt; Back</button>\n    </teleport>\n\n    <teleport to='#belowSurface'>\n      <span class=\"is-pulled-right mt-4\">\n        <button class=\"button mr-2\"  @click=\"playVideo\">Play</button>\n        <button class=\"button\" @click=\"pauseVideo\">Pause</button>\n      </span>\n    </teleport>\n    <h3>Pose Drawer Test</h3>\n\n    <div class=\"dropdown\" :class=\"{ 'is-active': dropdownOpen}\">\n      <div class=\"dropdown-trigger\">\n        <button class=\"button\" @click=\"dropdownOpen = !dropdownOpen\">\n          <span>Select a dance</span>\n          <span class=\"icon is-small\">\n            <i class=\"fas fa-angle-down\" aria-hidden=\"true\"></i>\n          </span>\n        </button>\n      </div>\n      <div class=\"dropdown-menu\">\n        <div class=\"dropdown-content\">\n          <a v-for=\"motion in motions\"\n                  :key=\"motion.title\"\n                  class=\"dropdown-item\"\n            @click=\"loadMotion(motion)\">\n            {{motion.title}}\n          </a>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"columns\">\n      <div class=\"column\">\n        <h4 class=\"mt-4\">{{clipName}}</h4>\n\n        <div class=\"notification is-danger\" v-show=\"error\">\n          {{error}}\n        </div>\n\n        <div class=\"table-container\" style=\"overflow:auto auto; max-height: 500px;\">\n          <table class=\"table is-fullwidth is-hoverable is-bordered\" v-if=\"videoPlayer && videoPlayer.cPose\">\n            <thead>\n              <tr>\n                <th>id</th>\n                <th>x</th>\n                <th>y</th>\n                <th>vis</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(lm, index) in videoPlayer.cPose\" :key=\"index\">\n                <td>{{index}}</td>\n                <td>{{lm.x}}</td>\n                <td>{{lm.y}}</td>\n                <td>{{lm.visibility}}</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n      <div class=\"column is-one-third\">\n        <VideoPlayer\n        :videoBaseUrl=\"videoSrc\"\n        :height=\"'500px'\"\n        ref=\"videoPlayer\"\n        :drawPoseLandmarks=\"true\"\n        @progress=\"onProgress\"/>\n      </div>\n    </div>\n\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport db, { DatabaseEntry } from '@/services/MotionDatabase';\nimport {\n  computed, defineComponent, ref,\n} from 'vue';\n\nimport VideoPlayer from '@/components/elements/VideoPlayer.vue';\n\nexport default defineComponent({\n  name: 'PoseDrawerTest',\n  components: { VideoPlayer },\n  setup() {\n    const { motions } = db;\n    const videoPlayer = ref(null as null | typeof VideoPlayer);\n    const dropdownOpen = ref(false);\n    const clipName = ref('');\n    const videoSrc = computed(() => (clipName.value ? (`dances/${clipName.value}.mp4`) : ''));\n    const videoTime = ref(0);\n    const fps = ref(30);\n    const error = ref(null as string | null);\n\n    async function loadMotion(motion: DatabaseEntry) {\n      error.value = null;\n      dropdownOpen.value = false;\n      clipName.value = motion.clipName;\n      fps.value = motion.fps;\n    }\n\n    function playVideo() {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) return;\n      vidPlayer.playVideo(0, 1000, 0.5);\n    }\n    function pauseVideo() {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) return;\n      vidPlayer.pauseVideo();\n    }\n\n    function onProgress(time: number) {\n      videoTime.value = time;\n    }\n\n    return {\n      motions,\n      videoPlayer,\n      error,\n      loadMotion,\n      dropdownOpen,\n      clipName,\n      videoSrc,\n      playVideo,\n      pauseVideo,\n      onProgress,\n    };\n  },\n});\n</script>\n\n<style>\n\n.pose-drawer {\n  margin: auto;\n  width: 1280px;\n  height: 720px;\n  position: relative;\n  background: white;\n  box-sizing: border-box;\n}\n</style>\n","\nimport db, { DatabaseEntry } from '@/services/MotionDatabase';\nimport {\n  computed, defineComponent, ref,\n} from 'vue';\n\nimport VideoPlayer from '@/components/elements/VideoPlayer.vue';\n\nexport default defineComponent({\n  name: 'PoseDrawerTest',\n  components: { VideoPlayer },\n  setup() {\n    const { motions } = db;\n    const videoPlayer = ref(null as null | typeof VideoPlayer);\n    const dropdownOpen = ref(false);\n    const clipName = ref('');\n    const videoSrc = computed(() => (clipName.value ? (`dances/${clipName.value}.mp4`) : ''));\n    const videoTime = ref(0);\n    const fps = ref(30);\n    const error = ref(null as string | null);\n\n    async function loadMotion(motion: DatabaseEntry) {\n      error.value = null;\n      dropdownOpen.value = false;\n      clipName.value = motion.clipName;\n      fps.value = motion.fps;\n    }\n\n    function playVideo() {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) return;\n      vidPlayer.playVideo(0, 1000, 0.5);\n    }\n    function pauseVideo() {\n      const vidPlayer = videoPlayer.value;\n      if (!vidPlayer) return;\n      vidPlayer.pauseVideo();\n    }\n\n    function onProgress(time: number) {\n      videoTime.value = time;\n    }\n\n    return {\n      motions,\n      videoPlayer,\n      error,\n      loadMotion,\n      dropdownOpen,\n      clipName,\n      videoSrc,\n      playVideo,\n      pauseVideo,\n      onProgress,\n    };\n  },\n});\n","import { render } from \"./PoseDrawerTest.vue?vue&type=template&id=9399757c\"\nimport script from \"./PoseDrawerTest.vue?vue&type=script&lang=ts\"\nexport * from \"./PoseDrawerTest.vue?vue&type=script&lang=ts\"\n\nimport \"./PoseDrawerTest.vue?vue&type=style&index=0&id=9399757c&lang=css\"\nscript.render = render\n\nexport default script","<template>\n    <teleport to=\"#topbarLeft\">\n\n    </teleport>\n\n    <section class=\"section create-lesson-screen\">\n      <div class=\"hero is-primary block\">\n        <div class=\"hero-body\">\n          <div class=\"container\">\n            <p class=\"title\">\n              Lesson Creation\n            </p>\n            <p class=\"subtitle\">\n              <span v-if=\"state === LessonCreationState.SelectOpenState\">Tempalte Selection</span>\n              <span v-else>Editing &quot;{{lessonUnderConstruction.header.lessonTitle}}&quot;</span>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"container block\"><button class=\"button\" @click=\"$emit('back-selected')\">&lt; Back</button></div>\n\n      <div v-if=\"state === LessonCreationState.SelectOpenLesson\" class=\"container has-text-centered\">\n        <div class=\"card block center-block has-text-left\">\n          <div class=\"card-header\">\n            <h4 class=\"card-header-title\">Pick a template:</h4>\n          </div>\n          <div class=\"card-content menu\">\n            <ul class=\"menu-list\">\n              <li>\n                <a @click=\"activeLessonSelectionIndex = -1\"\n                  :class=\"{'is-active': activeLessonSelectionIndex === -1}\">(start from scratch)</a>\n              </li>\n              <li v-for=\"(lesson, i) in lessons\" :key=\"lesson._id\">\n                <a @click=\"activeLessonSelectionIndex = i\" :class=\"{'is-active': activeLessonSelectionIndex === i}\">\n                  <strong>#{{i+1}}</strong>&nbsp;{{lesson.header.lessonTitle}}\n                </a>\n              </li>\n            </ul>\n          </div>\n          <div class=\"card-footer\" v-if=\"canEditActiveLesson\">\n            <a class=\"card-footer-item\" @click=\"startCreation(false)\">Edit</a>\n          </div><div class=\"card-footer\">\n            <a class=\"card-footer-item\" @click=\"startCreation(true)\">\n              <span v-if=\"activeLessonSelectionIndex === -1\">Start New</span>\n              <span v-else>Use as Template</span>\n            </a>\n          </div>\n        </div>\n      </div>\n\n      <div v-if=\"state === LessonCreationState.ModifyLesson\" class=\"block\">\n        <div class=\"columns is-multiline is-centered\">\n          <div class=\"column is-narrow\">\n            <div class=\"box\">\n              <h5 class=\"title is-5\">Lesson</h5>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label is-normal\">\n                  <label class=\"label\">Clip</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input class=\"input\" disabled type=\"text\" :value=\"motion.title\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label is-normal\">\n                  <label class=\"label\">Title</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input class=\"input\" type=\"text\" v-model=\"lessonUnderConstruction.header.lessonTitle\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field\">\n                <label class=\"label\">Segments</label>\n                <div class=\"control block\">\n                  <SegmentedProgressBar\n                  :segments=\"progressSegments\"\n                    :progress=\"motion.duration\"\n                    :enableAll=\"true\"/>\n                  </div>\n                  <div class=\"control block\">\n                    <div class=\"block\">\n                      <span class=\"m-1\" v-for=\"(segBreak, i) in lessonUnderConstruction.segmentBreaks\" :key=\"i\">\n                        <input\n                            class=\"input narrow-number-input\"\n                            :key=\"i\"\n                            type=\"number\"\n                            v-model=\"lessonUnderConstruction.segmentBreaks[i]\"\n                            :min=\"lessonUnderConstruction.segmentBreaks[i - 1] ?? 0\"\n                            :step=\"0.01\"\n                            :max=\"lessonUnderConstruction.segmentBreaks[i + 1] ?? motion.duration\" />\n                      </span>\n                    </div>\n                    <div class=\"block has-text-right\">\n                      <!-- <span>Add New</span> -->\n                      <input\n                          class=\"input narrow-number-input is-info\"\n                          type=\"number\"\n                          v-model=\"newSegmentVal\"\n                          :min=\"0\"\n                          :step=\"0.01\"\n                          :max=\"motion.duration\" />\n                      <button class=\"ml-1 button is-info is-light\" @click=\"addSegmentBreak(newSegmentVal)\">Add Segment</button>\n                    </div>\n                  </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Activities</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <ul class=\"menu-list\">\n                        <li v-for=\"(activity, i) in lessonUnderConstruction.activities\" :key=\"i\">\n                          <a :class=\"{'is-active': activeActivityIndex === i}\" @click=\"selectActivity(i)\"><strong>{{i+1}}&nbsp;</strong>&nbsp;{{activity.title}}</a>\n                        </li>\n                        <li><a @click=\"addActivity()\">&plus; Add Activity</a></li>\n                        <li v-if=\"lessonUnderConstruction.activities.length === 0\">No Activities</li>\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field is-grouped is-grouped-right\">\n                <div class=\"control\" v-if=\"canDeleteLesson\">\n                  <button class=\"button is-danger is-outlined\" @click=\"deleteLesson\">\n                    Delete\n                  </button>\n                </div>\n                <div class=\"control\">\n                  <button class=\"button\" @click=\"exportLesson\">Export</button>\n                </div>\n                <div class=\"control\">\n                  <button class=\"button is-primary\" @click=\"saveLesson\">\n                    <span v-if=\"lessonInDatabase\">Update</span>\n                    <span v-else>Save</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"column is-narrow\">\n            <div class=\"box\">\n              <h5 class=\"title is-5\">Activity</h5>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Title</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activeActivity.title\" />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Playback Speed</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activeActivity.practiceSpeed\" min=\"0\" step=\"0.01\" :max=\"2\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Start Time</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activeActivity.startTime\" min=\"0\" step=\"0.01\" :max=\"motion.duration\">\n                    </div>\n                  </div>\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"range\" class=\"input slider mt-0 mb-0\" v-model.number=\"activeActivity.startTime\" min=\"0\" step=\"0.01\" :max=\"motion.duration\"/>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">End Time</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activeActivity.endTime\" :min=\"0\" step=\"0.01\" :max=\"motion.duration\">\n                    </div>\n                  </div>\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"range\" class=\"input slider mt-0 mb-0\" v-model.number=\"activeActivity.endTime\" :min=\"0\" step=\"0.01\" :max=\"motion.duration\"/>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Start Instruction</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activeActivity.startInstruction\" />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Playing Instruction</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activeActivity.playingInstruction\" />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">End Instruction</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activeActivity.endInstruction\" />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Static Instruction</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activeActivity.staticInstruction\" />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Pauses</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <ul class=\"menu-list\">\n                        <li v-for=\"(pause, i) in activeActivity.pauses ?? []\" :key=\"i\">\n                          <a :class=\"{'is-active': activePauseIndex === i}\" @click=\"selectPause(i)\">\n                            <strong>#{{i+1}}</strong>\n                            for {{pause.pauseDuration ?? Constants.DefaultPauseDuration}}s\n                            @ {{pause.time}}s\n                            <small v-if=\"pause.instruction\">&quot;{{pause.instruction}}&quot;</small>\n                          </a>\n                        </li>\n                        <li v-if=\"lessonUnderConstruction.activities.length === 0\">No Pauses</li>\n                        <li><a @click=\"addPause()\">&plus; Add Pause</a></li>\n                        <li v-show=\"(activeActivity.pauses?.length ?? 0) >= 2\"><a @click=\"sortPauses()\">Sort Pauses</a></li>\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Timed Instructions</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <ul class=\"menu-list\">\n                        <li v-for=\"(ti, i) in activeActivity.timedInstructions ?? []\" :key=\"i\">\n                          <a :class=\"{'is-active': activeTimedInstructionIndex === i}\" @click=\"selectTimedInstruction(i)\">\n                            <strong>#{{i+1}}</strong>&nbsp;\n                            <small>&quot;{{ti.text}}&quot;</small>\n                            from {{ti.startTime}}s\n                            to {{ti.endTime}}s\n                          </a>\n                        </li>\n                        <li v-if=\"lessonUnderConstruction.activities.length === 0\">No Timed Instructions</li>\n                        <li><a @click=\"addTimedInstruction()\">&plus; Add Timed Instruction</a></li>\n                        <li v-show=\"(activeActivity.timedInstructions?.length ?? 0) >= 2\"><a @click=\"sortTimedInstructions()\">Sort Timed Instructions</a></li>\n                        <li v-if=\"lessonUnderConstruction.activities.length === 0\">No Timed Instructions</li>\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"column is-narrow\">\n\n            <div v-if=\"activePause\" class=\"box\">\n              <h6 class=\"title is-5\">Pause {{activePauseIndex + 1}} Details</h6>\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\"><label class=\"label\">Time</label></div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activePause.time\" min=\"0\" step=\"0.01\" :max=\"motion.duration\">\n                    </div>\n                  </div>\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"range\" class=\"input slider mt-0 mb-0\" v-model.number=\"activePause.time\" min=\"0\" step=\"0.01\" :max=\"motion.duration\"/>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Duration</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activePause.pauseDuration\" min=\"0\" step=\"0.01\" :max=\"10\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Instruction</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activePause.instruction\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field\">\n                <div class=\"control\">\n                  <button class=\"button is-danger is-outlined\" @click=\"deletePause(activePause)\">Remove Pause {{activePauseIndex + 1}}</button>\n                </div>\n              </div>\n            </div> <!-- End pause detail section-->\n\n            <div v-if=\"activeTimedInstruction\" class=\"box\">\n              <h6 class=\"title is-5\">Timed Instruction {{activeTimedInstructionIndex + 1}} Details</h6>\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\"><label class=\"label\">Start Time</label></div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activeTimedInstruction.startTime\" :min=\"activeActivity.startTime\" step=\"0.01\" :max=\"activeTimedInstruction.endTime\">\n                    </div>\n                  </div>\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"range\" class=\"input slider mt-0 mb-0\" v-model.number=\"activeTimedInstruction.startTime\" :min=\"activeActivity.startTime\" step=\"0.01\" :max=\"activeActivity.endTime\"/>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\"><label class=\"label\">End Time</label></div>\n                <div class=\"field-body\">\n                  <div class=\"field is-narrow\">\n                    <div class=\"control\">\n                      <input type=\"number\" class=\"input narrow-number-input\" v-model.number=\"activeTimedInstruction.endTime\" :min=\"activeTimedInstruction.startTime\" step=\"0.01\" :max=\"activeActivity.endTime\">\n                    </div>\n                  </div>\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"range\" class=\"input slider mt-0 mb-0\" v-model.number=\"activeTimedInstruction.endTime\" :min=\"activeActivity.startTime\" step=\"0.01\" :max=\"activeActivity.endTime\"/>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field is-horizontal\">\n                <div class=\"field-label\">\n                  <label class=\"label\">Text</label>\n                </div>\n                <div class=\"field-body\">\n                  <div class=\"field\">\n                    <div class=\"control\">\n                      <input type=\"text\" class=\"input\" v-model=\"activeTimedInstruction.text\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"field\">\n                <div class=\"control\">\n                  <button class=\"button is-danger is-outlined\" @click=\"deleteTimedInstruction(activeTimedInstruction)\">Remove Timed Instruction {{activeTimedInstructionIndex + 1}}</button>\n                </div>\n              </div>\n            </div> <!-- End timed instruction detail section-->\n          </div>\n\n          <div class=\"column is-narrow\">\n            <div class=\"box\">\n              <h5 class=\"title is-5\">Demo</h5>\n\n              <ActivityVideoPlayer\n                class=\"block\"\n                ref=\"activityVideoPlayer\"\n                :motion=\"motion\"\n                :lesson=\"lessonUnderConstruction\"\n                :activity=\"activeActivity\"\n                :maxHeight=\"'400px'\"\n                @progress=\"onProgress\" />\n\n              <SegmentedProgressBar\n                class=\"block\"\n                :segments=\"progressSegments\"\n                :progress=\"activityProgress\"/>\n\n              <div class=\"buttons is-centered has-addons\">\n                <button class=\"button\" :disabled=\"!hasPreviousActivity\" @click=\"activeActivityIndex -= 1\">&lt;</button>\n                <button class=\"button is-primary\" :disabled=\"!($refs.activityVideoPlayer?.awaitingStart ?? false)\" @click=\"playDemo\">Play Activity</button>\n                <button class=\"button\" :disabled=\"!($refs.activityVideoPlayer?.activityFinished ?? false)\" @click=\"$refs.activityVideoPlayer?.reset()\">Reset</button>\n                <button class=\"button\" :disabled=\"!hasNextActivity\" @click=\"activeActivityIndex += 1\">&gt;</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </section>\n\n    <teleport to='#belowSurface'>\n    </teleport>\n</template>\n\n<script lang=\"ts\">\n\nimport {\n  computed,\n  defineComponent, ref, toRefs, watchEffect,\n} from 'vue';\n\nimport Constants from '@/services/Constants';\nimport ActivityVideoPlayer from '@/components/elements/ActivityVideoPlayer.vue';\nimport PausingVideoPlayer from '@/components/elements/PausingVideoPlayer.vue';\nimport VideoPlayer from '@/components/elements/VideoPlayer.vue';\nimport db, { createBlankActivity, createBlankLesson, DatabaseEntry } from '@/services/MotionDatabase';\nimport DanceLesson, { Activity, PauseInfo, TimedInstruction } from '@/model/DanceLesson';\nimport Utils from '@/services/Utils';\nimport SegmentedProgressBar, { ProgressSegmentData, calculateProgressSegments } from '@/components/elements/SegmentedProgressBar.vue';\n\nconst LessonCreationState = Object.freeze({\n  SelectOpenLesson: 'SelectOpenLesson',\n  ModifyLesson: 'ModifyLesson',\n});\n\nexport default defineComponent({\n  name: 'CreateLessonScreen',\n  components: {\n    ActivityVideoPlayer,\n    SegmentedProgressBar,\n    // VideoPlayer,\n    // ActivityVideoPlayer,\n    // VideoPlayer,\n  },\n  props: ['motion'],\n  emits: ['back-selected', 'lesson-created'],\n  data() {\n    return {\n      newPauseTime: 0,\n      newSegmentVal: 0,\n      activeLessonSelectionIndex: -1,\n      activePauseIndex: 0,\n      activeTimedInstructionIndex: 0,\n      activityProgress: 0,\n    };\n  },\n  computed: {\n    activeLessonSelection(): DanceLesson | null {\n      return this.lessons[this.activeLessonSelectionIndex] ?? null;\n    },\n    lessonInDatabase(): boolean {\n      return db.hasLesson(this.lessonUnderConstruction);\n    },\n    canDeleteLesson(): boolean {\n      return this.lessonInDatabase && this.lessonUnderConstruction.source === 'custom';\n    },\n    lessonStartTime(): number {\n      return this.lessonUnderConstruction?.segmentBreaks[0] ?? 0;\n    },\n    lessonEndTime(): number {\n      return this.lessonUnderConstruction.segmentBreaks[this.lessonUnderConstruction.segmentBreaks.length - 1] ?? this.motion?.duration ?? 1;\n    },\n    lessons() {\n      if (!this.motion) return [];\n      const motion = this.motion as DatabaseEntry;\n      const lessons = db.getLessons(motion);\n      return lessons ?? [];\n    },\n    progressSegments(): ProgressSegmentData[] {\n      if (this.activeActivity && this.lessonUnderConstruction) return calculateProgressSegments(this.lessonUnderConstruction, this.activeActivity);\n      return [];\n    },\n    activePause(): null | PauseInfo {\n      return ((this as any).activeActivity.pauses ?? [])[(this as any).activePauseIndex] ?? null;\n    },\n    activeTimedInstruction(): null | TimedInstruction {\n      return ((this as any).activeActivity.timedInstructions ?? [])[(this as any).activeTimedInstructionIndex] ?? null;\n    },\n    hasNextActivity(): boolean {\n      return this.activeActivityIndex + 1 < this.lessonUnderConstruction.activities.length;\n    },\n    hasPreviousActivity(): boolean {\n      return this.activeActivityIndex > 0;\n    },\n    canEditActiveLesson() {\n      const acLes = this.activeLessonSelection as DanceLesson;\n      return acLes?.source === 'custom';\n    },\n  },\n  mounted() {\n    if (this.lessons.length === 0) {\n      this.startCreation(true);\n    }\n  },\n  setup(props) {\n    const { motion } = toRefs(props);\n    const typedMotion = computed(() => motion.value as unknown as DatabaseEntry);\n    const state = ref(LessonCreationState.SelectOpenLesson);\n    const lessonUnderConstruction = ref(createBlankLesson(motion));\n    const activeActivityIndex = ref(0);\n    const activeActivity = computed(() => lessonUnderConstruction.value.activities[activeActivityIndex.value]);\n\n    watchEffect(() => {\n      if (activeActivity.value.startTime < 0) activeActivity.value.startTime = 0;\n      if (activeActivity.value.endTime > motion.value.duration) activeActivity.value.endTime = motion.value.duration;\n      if (+activeActivity.value.endTime < +activeActivity.value.startTime) activeActivity.value.endTime = activeActivity.value.startTime;\n    });\n\n    return {\n      state,\n      typedMotion,\n      LessonCreationState,\n      lessonUnderConstruction,\n      activeActivityIndex,\n      activeActivity,\n      Constants,\n    };\n  },\n  methods: {\n    startCreation(asTemplate: boolean) {\n      const existingLesson = this.activeLessonSelection;\n      if (existingLesson && asTemplate) {\n        console.log('Creating new lesson from template');\n        this.lessonUnderConstruction = Utils.deepCopy(existingLesson);\n        this.lessonUnderConstruction._id = Utils.uuidv4();\n      } else if (existingLesson && !asTemplate) {\n        console.log('Editing existing lesson');\n        this.lessonUnderConstruction = existingLesson;\n      } else {\n        console.log('Creating new lesson from scratch');\n        this.lessonUnderConstruction = createBlankLesson(this.motion);\n      }\n      this.state = LessonCreationState.ModifyLesson;\n    },\n    addActivity(targetIndex?: number) {\n      const newActivity: Activity = createBlankActivity(this.typedMotion, `Activity ${this.lessonUnderConstruction.activities.length + 1}`);\n\n      if (targetIndex === undefined) {\n        this.lessonUnderConstruction.activities.push(newActivity);\n        this.activeActivityIndex = this.lessonUnderConstruction.activities.length - 1;\n      } else {\n        this.lessonUnderConstruction.activities.splice(targetIndex, 0, newActivity);\n        this.activeActivityIndex = targetIndex;\n      }\n    },\n    selectActivity(targetIndex: number) {\n      this.activeActivityIndex = targetIndex;\n    },\n    addPause(targetIndex?: number) {\n      const pauses = this.activeActivity.pauses ?? [];\n      const newPause: PauseInfo = {\n        time: this.activeActivity.startTime,\n        pauseDuration: Constants.DefaultPauseDuration,\n      };\n      if (targetIndex === undefined) {\n        pauses.push(newPause);\n        this.activePauseIndex = pauses.length - 1;\n      } else {\n        pauses.splice(targetIndex, 0, newPause);\n        this.activePauseIndex = targetIndex;\n      }\n      this.sortPauses();\n      this.activeActivity.pauses = pauses;\n    },\n    selectPause(targetIndex: number) {\n      if (targetIndex === this.activePauseIndex) this.activePauseIndex = -1;\n      else this.activePauseIndex = targetIndex;\n    },\n    sortPauses() {\n      const pauses = this.activeActivity.pauses ?? [];\n      const selectedPause = pauses[this.activePauseIndex];\n      pauses.sort((a, b) => a.time - b.time);\n      const newIndex = pauses.indexOf(selectedPause);\n      if (newIndex >= 0) this.activePauseIndex = newIndex;\n      this.activeActivity.pauses = pauses;\n    },\n    deletePause(pauseObj: PauseInfo) {\n      const pauses = this.activeActivity.pauses ?? [];\n      const pauseIndex = pauses.indexOf(pauseObj);\n      // eslint-disable-next-line no-alert\n      if (pauseIndex >= 0 && window.confirm('Are you sure you want to delete this pause?')) pauses.splice(pauseIndex, 1);\n      this.activeActivity.pauses = pauses;\n    },\n    addTimedInstruction(targetIndex?: number) {\n      const timedInstructions = this.activeActivity.timedInstructions ?? [];\n      const newInstruction: TimedInstruction = {\n        startTime: 0,\n        endTime: 1,\n        text: 'Do XYZ',\n      };\n      if (targetIndex === undefined) {\n        timedInstructions.push(newInstruction);\n        this.activeTimedInstructionIndex = timedInstructions.length - 1;\n      } else {\n        timedInstructions.splice(targetIndex, 0, newInstruction);\n        this.activeTimedInstructionIndex = targetIndex;\n      }\n      this.sortTimedInstructions();\n\n      this.activeActivity.timedInstructions = timedInstructions;\n    },\n    selectTimedInstruction(targetIndex: number) {\n      if (targetIndex === this.activeTimedInstructionIndex) this.activeTimedInstructionIndex = -1;\n      else this.activeTimedInstructionIndex = targetIndex;\n    },\n    sortTimedInstructions() {\n      const timedInstructs = this.activeActivity.timedInstructions ?? [];\n      const selectedTimedInstruc = timedInstructs[this.activeTimedInstructionIndex];\n      timedInstructs.sort((a, b) => a.startTime - b.startTime);\n      const newIndex = timedInstructs.indexOf(selectedTimedInstruc);\n      if (newIndex >= 0) this.activeTimedInstructionIndex = newIndex;\n      this.activeActivity.timedInstructions = timedInstructs;\n    },\n    deleteTimedInstruction(timedInstruction: TimedInstruction) {\n      const timedInstructs = this.activeActivity.timedInstructions ?? [];\n      const tiIndex = timedInstructs.indexOf(timedInstruction);\n      // eslint-disable-next-line no-restricted-globals, no-alert\n      if (tiIndex >= 0 && window.confirm('Are you sure you want to delete this timed instruction?')) timedInstructs.splice(tiIndex, 1);\n      this.activeActivity.timedInstructions = timedInstructs;\n    },\n    addSegmentBreak(breakTime: number) {\n      breakTime = +breakTime;\n      if (Number.isNaN(breakTime) || breakTime < 0 || breakTime > this.motion.duration) return;\n      this.lessonUnderConstruction.segmentBreaks.push(breakTime);\n      const newList = this.lessonUnderConstruction.segmentBreaks.sort();\n      this.lessonUnderConstruction.segmentBreaks = newList;\n      this.newSegmentVal = 0;\n    },\n    playDemo() {\n      (this.$refs.activityVideoPlayer as any).play();\n    },\n    onProgress(progress: number) {\n      this.activityProgress = progress;\n    },\n    saveLesson() {\n      db.saveCustomLesson(this.lessonUnderConstruction);\n    },\n    deleteLesson() {\n      // eslint-disable-next-line no-alert\n      if (!window.confirm('Are you sure you want to delete this lesson?')) {\n        return;\n      }\n\n      db.deleteCustomLesson(this.lessonUnderConstruction);\n      this.$emit('back-selected');\n    },\n    exportLesson() {\n      Utils.PromptDownloadFile(`${this.lessonUnderConstruction.header.lessonTitle}.lesson.json`, JSON.stringify(this.lessonUnderConstruction));\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\">\n\n.create-lesson-screen {\n  .center-block {\n    display: inline-block;\n    margin-left: auto;\n    margin-right: auto;\n  }\n\n  .narrow-number-input {\n    max-width: 5.5rem;\n  }\n\n  .seg-break {\n    background: white;\n  }\n}\n\n</style>\n","<template>\n  <div class=\"activity-video-player\">\n\n    <div class=\"overlay\" v-show=\"activity && activity.userVisual !== 'none'\">\n      <WebcamBox :maxHeight=\"maxHeight\"/>\n    </div>\n\n    <PausingVideoPlayer\n        :videoSrc=\"motion.videoSrc\"\n        ref=\"videoPlayer\"\n        :maxHeight=\"maxHeight\"\n        :drawPoseLandmarks=\"activity?.demoVisual === 'skeleton'\"\n        :videoOpacity=\"activity?.demoVisual === 'video' ? 1 : 0\"\n        :emphasizedJoints=\"emphasizedJoints\"\n        @progress=\"onProgress\"\n        @playback-completed=\"onPlaybackCompleted\"\n        @pause-hit=\"onPauseHit\"\n        @pause-end=\"onPauseEnded\"\n      />\n\n    <div class=\"is-overlay instructions-overlay mb-4\">\n      <InstructionCarousel v-show=\"!activityFinished && timedInstructions().length > 0\" :sizeClass=\"'is-large'\" :instructions=\"timedInstructions()\" class=\"m-2\"/>\n      <InstructionCarousel v-show=\"instructions.length > 0\" :sizeClass=\"'is-large'\" :instructions=\"instructions\" class=\"m-2\"/>\n      <InstructionCarousel v-show=\"activity.staticInstruction\" :sizeClass=\"'is-large'\"  :instructions=\"[{id:0, text:activity.staticInstruction}]\" class=\"m-2\"/>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\n\nimport {\n  computed, ComputedRef, defineComponent, nextTick, onBeforeUnmount, onMounted, Ref, ref, toRefs, watch, watchEffect,\n} from 'vue';\nimport InstructionCarousel, { Instruction } from '@/components/elements/InstructionCarousel.vue';\nimport PausingVideoPlayer from '@/components/elements/PausingVideoPlayer.vue';\nimport WebcamBox from '@/components/elements/WebcamBox.vue';\nimport { Activity, PauseInfo } from '@/model/DanceLesson';\nimport Constants from '@/services/Constants';\n\nconst ActivityPlayState = Object.freeze({\n  AwaitingStart: 'AwaitingStart',\n  PendingStart: 'PendingStart',\n  Playing: 'Playing',\n  ActivityEnded: 'ActivityEnded',\n});\n\nexport default defineComponent({\n  name: 'ActivityVideoPlayer',\n  emits: ['progress', 'activityEnded'],\n  props: {\n    motion: { type: Object },\n    lesson: { type: Object },\n    activity: { type: Object },\n    defaultPauseDuration: { type: Number, default: 1.5 },\n    maxHeight: { type: String, default: '400px' },\n  },\n  components: {\n    PausingVideoPlayer,\n    InstructionCarousel,\n    WebcamBox,\n  },\n  setup(props, { emit }) {\n    const { motion, lesson, activity } = toRefs(props);\n    const state = ref(ActivityPlayState.AwaitingStart);\n    const activityFinished = computed(() => state.value === ActivityPlayState.ActivityEnded);\n    const awaitingStart = computed(() => state.value === ActivityPlayState.AwaitingStart);\n    const videoPlayer = ref(null as null | typeof PausingVideoPlayer);\n    const videoTime = () => (videoPlayer.value as any)?.getVideoTime() ?? 0;\n\n    const pauseInstructs = ref([] as Instruction[]);\n    const onPlaybackCompleted = () => {\n      state.value = ActivityPlayState.ActivityEnded;\n    };\n    const onPauseHit = (pause: PauseInfo) => {\n      if (pause.instruction) pauseInstructs.value.push({ id: pause.time, text: pause.instruction });\n    };\n    const onPauseEnded = () => pauseInstructs.value.splice(0);\n\n    const startTime = computed(() => activity?.value?.startTime ?? 0);\n\n    function reset(newTime?: number) {\n      pauseInstructs.value.splice(0);\n      state.value = ActivityPlayState.AwaitingStart;\n      const time = newTime ?? startTime.value ?? 0;\n\n      if (videoPlayer.value) videoPlayer.value.setTime(time);\n    }\n\n    watchEffect(() => reset(startTime.value));\n    // watch(\n    //   () => startTime,\n    //   (newStartTime: any) => {\n    //     reset(newStartTime);\n    //     console.log('Watch triggered');\n    //   },\n    // );\n    // watchEffect(() => {\n    //   console.log(`New startTime: ${startTime.value}`);\n    // });\n\n    return {\n      videoPlayer,\n      videoTime,\n      state,\n      ActivityPlayState,\n      awaitingStart,\n      activityFinished,\n      pauseInstructs,\n\n      reset,\n      startTime,\n\n      onPlaybackCompleted,\n      onPauseHit,\n      onPauseEnded,\n    };\n  },\n  computed: {\n    emphasizedJoints(): number[] { return this.activity?.emphasizedJoints ?? []; },\n    instructions(): Instruction[] {\n      const mActivity = this.activity;\n      if (!mActivity) return [];\n\n      const instructs: Instruction[] = [];\n\n      if ((this.state === ActivityPlayState.AwaitingStart || this.state === ActivityPlayState.PendingStart) && mActivity.startInstruction) {\n        let text = mActivity.startInstruction;\n        if (this.state === ActivityPlayState.PendingStart) { text += '...'; }\n        instructs.push({\n          id: 1,\n          text,\n        });\n      } else if (this.state === ActivityPlayState.Playing && mActivity.playingInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.playingInstruction,\n        });\n      } else if (this.state === ActivityPlayState.ActivityEnded && mActivity.endInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.endInstruction,\n        });\n      }\n\n      instructs.concat(this.pauseInstructs);\n\n      return instructs;\n    },\n  },\n  methods: {\n    play(delay?: number | undefined) {\n      this.reset();\n      const vidPlayer = this.videoPlayer;\n      const vidActivity = this.activity as Activity | null;\n      if (!vidActivity) return;\n      if (!vidPlayer) {\n        console.error('LEARNING SCREEN:: Aborting video playback: vidPlayer is null');\n        return;\n      }\n\n      this.state = ActivityPlayState.PendingStart;\n\n      vidPlayer.play(\n        vidActivity.startTime,\n        vidActivity.endTime,\n        vidActivity.practiceSpeed ?? 1,\n        vidActivity.pauses ?? [],\n        delay ?? Constants.DefaultPauseDuration,\n        () => {\n          this.state = ActivityPlayState.Playing;\n        },\n      );\n    },\n\n    timedInstructions(): Instruction[] {\n      const mActivity = this.activity as unknown as Activity | null;\n      const time = this.videoTime();\n      if (!mActivity) return [];\n\n      const activeTimedInstructions = mActivity.timedInstructions?.map(\n        (ti, i) => ({\n          id: i,\n          text: ti.text,\n          start: ti.startTime,\n          end: ti.endTime,\n        })\n      ).filter((ti) => ti.start <= time && time < ti.end) ?? [];\n\n      return activeTimedInstructions;\n    },\n    onProgress(val: number) {\n      this.$emit('progress', val);\n    },\n  },\n});\n\n</script>\n\n<style lang=\"scss\">\n\n.activity-video-player {\n  // background: black;\n  position: relative;\n}\n\n</style>\n","\n\nimport {\n  computed, ComputedRef, defineComponent, nextTick, onBeforeUnmount, onMounted, Ref, ref, toRefs, watch, watchEffect,\n} from 'vue';\nimport InstructionCarousel, { Instruction } from '@/components/elements/InstructionCarousel.vue';\nimport PausingVideoPlayer from '@/components/elements/PausingVideoPlayer.vue';\nimport WebcamBox from '@/components/elements/WebcamBox.vue';\nimport { Activity, PauseInfo } from '@/model/DanceLesson';\nimport Constants from '@/services/Constants';\n\nconst ActivityPlayState = Object.freeze({\n  AwaitingStart: 'AwaitingStart',\n  PendingStart: 'PendingStart',\n  Playing: 'Playing',\n  ActivityEnded: 'ActivityEnded',\n});\n\nexport default defineComponent({\n  name: 'ActivityVideoPlayer',\n  emits: ['progress', 'activityEnded'],\n  props: {\n    motion: { type: Object },\n    lesson: { type: Object },\n    activity: { type: Object },\n    defaultPauseDuration: { type: Number, default: 1.5 },\n    maxHeight: { type: String, default: '400px' },\n  },\n  components: {\n    PausingVideoPlayer,\n    InstructionCarousel,\n    WebcamBox,\n  },\n  setup(props, { emit }) {\n    const { motion, lesson, activity } = toRefs(props);\n    const state = ref(ActivityPlayState.AwaitingStart);\n    const activityFinished = computed(() => state.value === ActivityPlayState.ActivityEnded);\n    const awaitingStart = computed(() => state.value === ActivityPlayState.AwaitingStart);\n    const videoPlayer = ref(null as null | typeof PausingVideoPlayer);\n    const videoTime = () => (videoPlayer.value as any)?.getVideoTime() ?? 0;\n\n    const pauseInstructs = ref([] as Instruction[]);\n    const onPlaybackCompleted = () => {\n      state.value = ActivityPlayState.ActivityEnded;\n    };\n    const onPauseHit = (pause: PauseInfo) => {\n      if (pause.instruction) pauseInstructs.value.push({ id: pause.time, text: pause.instruction });\n    };\n    const onPauseEnded = () => pauseInstructs.value.splice(0);\n\n    const startTime = computed(() => activity?.value?.startTime ?? 0);\n\n    function reset(newTime?: number) {\n      pauseInstructs.value.splice(0);\n      state.value = ActivityPlayState.AwaitingStart;\n      const time = newTime ?? startTime.value ?? 0;\n\n      if (videoPlayer.value) videoPlayer.value.setTime(time);\n    }\n\n    watchEffect(() => reset(startTime.value));\n    // watch(\n    //   () => startTime,\n    //   (newStartTime: any) => {\n    //     reset(newStartTime);\n    //     console.log('Watch triggered');\n    //   },\n    // );\n    // watchEffect(() => {\n    //   console.log(`New startTime: ${startTime.value}`);\n    // });\n\n    return {\n      videoPlayer,\n      videoTime,\n      state,\n      ActivityPlayState,\n      awaitingStart,\n      activityFinished,\n      pauseInstructs,\n\n      reset,\n      startTime,\n\n      onPlaybackCompleted,\n      onPauseHit,\n      onPauseEnded,\n    };\n  },\n  computed: {\n    emphasizedJoints(): number[] { return this.activity?.emphasizedJoints ?? []; },\n    instructions(): Instruction[] {\n      const mActivity = this.activity;\n      if (!mActivity) return [];\n\n      const instructs: Instruction[] = [];\n\n      if ((this.state === ActivityPlayState.AwaitingStart || this.state === ActivityPlayState.PendingStart) && mActivity.startInstruction) {\n        let text = mActivity.startInstruction;\n        if (this.state === ActivityPlayState.PendingStart) { text += '...'; }\n        instructs.push({\n          id: 1,\n          text,\n        });\n      } else if (this.state === ActivityPlayState.Playing && mActivity.playingInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.playingInstruction,\n        });\n      } else if (this.state === ActivityPlayState.ActivityEnded && mActivity.endInstruction) {\n        instructs.push({\n          id: 2,\n          text: mActivity.endInstruction,\n        });\n      }\n\n      instructs.concat(this.pauseInstructs);\n\n      return instructs;\n    },\n  },\n  methods: {\n    play(delay?: number | undefined) {\n      this.reset();\n      const vidPlayer = this.videoPlayer;\n      const vidActivity = this.activity as Activity | null;\n      if (!vidActivity) return;\n      if (!vidPlayer) {\n        console.error('LEARNING SCREEN:: Aborting video playback: vidPlayer is null');\n        return;\n      }\n\n      this.state = ActivityPlayState.PendingStart;\n\n      vidPlayer.play(\n        vidActivity.startTime,\n        vidActivity.endTime,\n        vidActivity.practiceSpeed ?? 1,\n        vidActivity.pauses ?? [],\n        delay ?? Constants.DefaultPauseDuration,\n        () => {\n          this.state = ActivityPlayState.Playing;\n        },\n      );\n    },\n\n    timedInstructions(): Instruction[] {\n      const mActivity = this.activity as unknown as Activity | null;\n      const time = this.videoTime();\n      if (!mActivity) return [];\n\n      const activeTimedInstructions = mActivity.timedInstructions?.map(\n        (ti, i) => ({\n          id: i,\n          text: ti.text,\n          start: ti.startTime,\n          end: ti.endTime,\n        })\n      ).filter((ti) => ti.start <= time && time < ti.end) ?? [];\n\n      return activeTimedInstructions;\n    },\n    onProgress(val: number) {\n      this.$emit('progress', val);\n    },\n  },\n});\n\n","import { render } from \"./ActivityVideoPlayer.vue?vue&type=template&id=ab48b626\"\nimport script from \"./ActivityVideoPlayer.vue?vue&type=script&lang=ts\"\nexport * from \"./ActivityVideoPlayer.vue?vue&type=script&lang=ts\"\n\nimport \"./ActivityVideoPlayer.vue?vue&type=style&index=0&id=ab48b626&lang=scss\"\nscript.render = render\n\nexport default script","\n\nimport {\n  computed,\n  defineComponent, ref, toRefs, watchEffect,\n} from 'vue';\n\nimport Constants from '@/services/Constants';\nimport ActivityVideoPlayer from '@/components/elements/ActivityVideoPlayer.vue';\nimport PausingVideoPlayer from '@/components/elements/PausingVideoPlayer.vue';\nimport VideoPlayer from '@/components/elements/VideoPlayer.vue';\nimport db, { createBlankActivity, createBlankLesson, DatabaseEntry } from '@/services/MotionDatabase';\nimport DanceLesson, { Activity, PauseInfo, TimedInstruction } from '@/model/DanceLesson';\nimport Utils from '@/services/Utils';\nimport SegmentedProgressBar, { ProgressSegmentData, calculateProgressSegments } from '@/components/elements/SegmentedProgressBar.vue';\n\nconst LessonCreationState = Object.freeze({\n  SelectOpenLesson: 'SelectOpenLesson',\n  ModifyLesson: 'ModifyLesson',\n});\n\nexport default defineComponent({\n  name: 'CreateLessonScreen',\n  components: {\n    ActivityVideoPlayer,\n    SegmentedProgressBar,\n    // VideoPlayer,\n    // ActivityVideoPlayer,\n    // VideoPlayer,\n  },\n  props: ['motion'],\n  emits: ['back-selected', 'lesson-created'],\n  data() {\n    return {\n      newPauseTime: 0,\n      newSegmentVal: 0,\n      activeLessonSelectionIndex: -1,\n      activePauseIndex: 0,\n      activeTimedInstructionIndex: 0,\n      activityProgress: 0,\n    };\n  },\n  computed: {\n    activeLessonSelection(): DanceLesson | null {\n      return this.lessons[this.activeLessonSelectionIndex] ?? null;\n    },\n    lessonInDatabase(): boolean {\n      return db.hasLesson(this.lessonUnderConstruction);\n    },\n    canDeleteLesson(): boolean {\n      return this.lessonInDatabase && this.lessonUnderConstruction.source === 'custom';\n    },\n    lessonStartTime(): number {\n      return this.lessonUnderConstruction?.segmentBreaks[0] ?? 0;\n    },\n    lessonEndTime(): number {\n      return this.lessonUnderConstruction.segmentBreaks[this.lessonUnderConstruction.segmentBreaks.length - 1] ?? this.motion?.duration ?? 1;\n    },\n    lessons() {\n      if (!this.motion) return [];\n      const motion = this.motion as DatabaseEntry;\n      const lessons = db.getLessons(motion);\n      return lessons ?? [];\n    },\n    progressSegments(): ProgressSegmentData[] {\n      if (this.activeActivity && this.lessonUnderConstruction) return calculateProgressSegments(this.lessonUnderConstruction, this.activeActivity);\n      return [];\n    },\n    activePause(): null | PauseInfo {\n      return ((this as any).activeActivity.pauses ?? [])[(this as any).activePauseIndex] ?? null;\n    },\n    activeTimedInstruction(): null | TimedInstruction {\n      return ((this as any).activeActivity.timedInstructions ?? [])[(this as any).activeTimedInstructionIndex] ?? null;\n    },\n    hasNextActivity(): boolean {\n      return this.activeActivityIndex + 1 < this.lessonUnderConstruction.activities.length;\n    },\n    hasPreviousActivity(): boolean {\n      return this.activeActivityIndex > 0;\n    },\n    canEditActiveLesson() {\n      const acLes = this.activeLessonSelection as DanceLesson;\n      return acLes?.source === 'custom';\n    },\n  },\n  mounted() {\n    if (this.lessons.length === 0) {\n      this.startCreation(true);\n    }\n  },\n  setup(props) {\n    const { motion } = toRefs(props);\n    const typedMotion = computed(() => motion.value as unknown as DatabaseEntry);\n    const state = ref(LessonCreationState.SelectOpenLesson);\n    const lessonUnderConstruction = ref(createBlankLesson(motion));\n    const activeActivityIndex = ref(0);\n    const activeActivity = computed(() => lessonUnderConstruction.value.activities[activeActivityIndex.value]);\n\n    watchEffect(() => {\n      if (activeActivity.value.startTime < 0) activeActivity.value.startTime = 0;\n      if (activeActivity.value.endTime > motion.value.duration) activeActivity.value.endTime = motion.value.duration;\n      if (+activeActivity.value.endTime < +activeActivity.value.startTime) activeActivity.value.endTime = activeActivity.value.startTime;\n    });\n\n    return {\n      state,\n      typedMotion,\n      LessonCreationState,\n      lessonUnderConstruction,\n      activeActivityIndex,\n      activeActivity,\n      Constants,\n    };\n  },\n  methods: {\n    startCreation(asTemplate: boolean) {\n      const existingLesson = this.activeLessonSelection;\n      if (existingLesson && asTemplate) {\n        console.log('Creating new lesson from template');\n        this.lessonUnderConstruction = Utils.deepCopy(existingLesson);\n        this.lessonUnderConstruction._id = Utils.uuidv4();\n      } else if (existingLesson && !asTemplate) {\n        console.log('Editing existing lesson');\n        this.lessonUnderConstruction = existingLesson;\n      } else {\n        console.log('Creating new lesson from scratch');\n        this.lessonUnderConstruction = createBlankLesson(this.motion);\n      }\n      this.state = LessonCreationState.ModifyLesson;\n    },\n    addActivity(targetIndex?: number) {\n      const newActivity: Activity = createBlankActivity(this.typedMotion, `Activity ${this.lessonUnderConstruction.activities.length + 1}`);\n\n      if (targetIndex === undefined) {\n        this.lessonUnderConstruction.activities.push(newActivity);\n        this.activeActivityIndex = this.lessonUnderConstruction.activities.length - 1;\n      } else {\n        this.lessonUnderConstruction.activities.splice(targetIndex, 0, newActivity);\n        this.activeActivityIndex = targetIndex;\n      }\n    },\n    selectActivity(targetIndex: number) {\n      this.activeActivityIndex = targetIndex;\n    },\n    addPause(targetIndex?: number) {\n      const pauses = this.activeActivity.pauses ?? [];\n      const newPause: PauseInfo = {\n        time: this.activeActivity.startTime,\n        pauseDuration: Constants.DefaultPauseDuration,\n      };\n      if (targetIndex === undefined) {\n        pauses.push(newPause);\n        this.activePauseIndex = pauses.length - 1;\n      } else {\n        pauses.splice(targetIndex, 0, newPause);\n        this.activePauseIndex = targetIndex;\n      }\n      this.sortPauses();\n      this.activeActivity.pauses = pauses;\n    },\n    selectPause(targetIndex: number) {\n      if (targetIndex === this.activePauseIndex) this.activePauseIndex = -1;\n      else this.activePauseIndex = targetIndex;\n    },\n    sortPauses() {\n      const pauses = this.activeActivity.pauses ?? [];\n      const selectedPause = pauses[this.activePauseIndex];\n      pauses.sort((a, b) => a.time - b.time);\n      const newIndex = pauses.indexOf(selectedPause);\n      if (newIndex >= 0) this.activePauseIndex = newIndex;\n      this.activeActivity.pauses = pauses;\n    },\n    deletePause(pauseObj: PauseInfo) {\n      const pauses = this.activeActivity.pauses ?? [];\n      const pauseIndex = pauses.indexOf(pauseObj);\n      // eslint-disable-next-line no-alert\n      if (pauseIndex >= 0 && window.confirm('Are you sure you want to delete this pause?')) pauses.splice(pauseIndex, 1);\n      this.activeActivity.pauses = pauses;\n    },\n    addTimedInstruction(targetIndex?: number) {\n      const timedInstructions = this.activeActivity.timedInstructions ?? [];\n      const newInstruction: TimedInstruction = {\n        startTime: 0,\n        endTime: 1,\n        text: 'Do XYZ',\n      };\n      if (targetIndex === undefined) {\n        timedInstructions.push(newInstruction);\n        this.activeTimedInstructionIndex = timedInstructions.length - 1;\n      } else {\n        timedInstructions.splice(targetIndex, 0, newInstruction);\n        this.activeTimedInstructionIndex = targetIndex;\n      }\n      this.sortTimedInstructions();\n\n      this.activeActivity.timedInstructions = timedInstructions;\n    },\n    selectTimedInstruction(targetIndex: number) {\n      if (targetIndex === this.activeTimedInstructionIndex) this.activeTimedInstructionIndex = -1;\n      else this.activeTimedInstructionIndex = targetIndex;\n    },\n    sortTimedInstructions() {\n      const timedInstructs = this.activeActivity.timedInstructions ?? [];\n      const selectedTimedInstruc = timedInstructs[this.activeTimedInstructionIndex];\n      timedInstructs.sort((a, b) => a.startTime - b.startTime);\n      const newIndex = timedInstructs.indexOf(selectedTimedInstruc);\n      if (newIndex >= 0) this.activeTimedInstructionIndex = newIndex;\n      this.activeActivity.timedInstructions = timedInstructs;\n    },\n    deleteTimedInstruction(timedInstruction: TimedInstruction) {\n      const timedInstructs = this.activeActivity.timedInstructions ?? [];\n      const tiIndex = timedInstructs.indexOf(timedInstruction);\n      // eslint-disable-next-line no-restricted-globals, no-alert\n      if (tiIndex >= 0 && window.confirm('Are you sure you want to delete this timed instruction?')) timedInstructs.splice(tiIndex, 1);\n      this.activeActivity.timedInstructions = timedInstructs;\n    },\n    addSegmentBreak(breakTime: number) {\n      breakTime = +breakTime;\n      if (Number.isNaN(breakTime) || breakTime < 0 || breakTime > this.motion.duration) return;\n      this.lessonUnderConstruction.segmentBreaks.push(breakTime);\n      const newList = this.lessonUnderConstruction.segmentBreaks.sort();\n      this.lessonUnderConstruction.segmentBreaks = newList;\n      this.newSegmentVal = 0;\n    },\n    playDemo() {\n      (this.$refs.activityVideoPlayer as any).play();\n    },\n    onProgress(progress: number) {\n      this.activityProgress = progress;\n    },\n    saveLesson() {\n      db.saveCustomLesson(this.lessonUnderConstruction);\n    },\n    deleteLesson() {\n      // eslint-disable-next-line no-alert\n      if (!window.confirm('Are you sure you want to delete this lesson?')) {\n        return;\n      }\n\n      db.deleteCustomLesson(this.lessonUnderConstruction);\n      this.$emit('back-selected');\n    },\n    exportLesson() {\n      Utils.PromptDownloadFile(`${this.lessonUnderConstruction.header.lessonTitle}.lesson.json`, JSON.stringify(this.lessonUnderConstruction));\n    },\n  },\n});\n","import { render } from \"./CreateLessonScreen.vue?vue&type=template&id=2ddc02e1\"\nimport script from \"./CreateLessonScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./CreateLessonScreen.vue?vue&type=script&lang=ts\"\n\nimport \"./CreateLessonScreen.vue?vue&type=style&index=0&id=2ddc02e1&lang=scss\"\nscript.render = render\n\nexport default script","\nimport { defineComponent, nextTick, ref } from 'vue';\nimport webcamProvider from '@/services/WebcamProvider';\nimport { DatabaseEntry } from '@/services/MotionDatabase';\nimport CameraSurface from './components/CameraSurface.vue';\nimport OnboardingUI from './components/OnboardingUI.vue';\nimport DanceMenu from './components/screens/DanceMenu.vue';\nimport LearningScreen from './components/screens/LearningScreen.vue';\nimport DanceLesson from './model/DanceLesson';\nimport WebcamPromptCard from './components/elements/WebcamPromptCard.vue';\n\nimport PoseDrawerTest from './components/screens/PoseDrawerTest.vue';\nimport CreateLessonScreen from './components/screens/CreateLessonScreen.vue';\n\nconst State = {\n  DanceMenu: 'DanceMenu',\n  PromptStartWebcam: 'PromptStartWebcam',\n  StartingWebcam: 'StartingWebcam',\n  LoadingTracking: 'LoadingTracking',\n  Onboarding: 'Onboarding',\n  LessonActive: 'LessonActive',\n  PoseDrawingTester: 'PoseDrawingTester',\n  CreateLesson: 'CreateLesson',\n};\n\nexport default defineComponent({\n  name: 'App',\n  components: {\n    CameraSurface,\n    OnboardingUI,\n    DanceMenu,\n    LearningScreen,\n    WebcamPromptCard,\n    PoseDrawerTest,\n    CreateLessonScreen,\n  },\n  setup() {\n    const state = ref(State.DanceMenu);\n    const cameraSurface = ref(null as typeof CameraSurface | null);\n    const hasCompletedOnboarding = ref(false);\n\n    const currentDance = ref(null as DatabaseEntry | null);\n    const currentLesson = ref(null as DanceLesson | null);\n\n    function danceSelected(dance: DatabaseEntry, lesson: DanceLesson) {\n      currentDance.value = dance;\n      currentLesson.value = lesson;\n\n      if (webcamProvider.webcamStatus.value === 'running') state.value = State.LessonActive;\n      else state.value = State.PromptStartWebcam;\n    }\n\n    function goHome() {\n      state.value = State.DanceMenu;\n      currentDance.value = null;\n      currentLesson.value = null;\n    }\n\n    async function startTracking() {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      nextTick(() => {\n        const camSurface: any = cameraSurface.value;\n        state.value = State.LoadingTracking;\n        camSurface.startTracking();\n      });\n    }\n\n    async function startWebcam() {\n      console.log('Starting Webcam');\n\n      if (webcamProvider.webcamStatus.value !== 'running') {\n        state.value = State.StartingWebcam;\n\n        try {\n          await webcamProvider.startWebcam();\n        } catch (e) {\n          console.error('Error starting webcam: ', e);\n          // eslint-disable-next-line no-alert\n          alert('Failed to start the webcam\\n\\nPlease ensure this is the only app using the camera and that you\\'ve allowed camera access in your browser.');\n          state.value = State.DanceMenu;\n          return;\n        }\n      }\n\n      state.value = State.LoadingTracking;\n      try {\n        await startTracking();\n      } catch (e) {\n        console.error(\"Couldn't start tracking\", e);\n      }\n    }\n\n    function onTrackingAttained() {\n      console.log('Tracking attained');\n      if (hasCompletedOnboarding.value) {\n        state.value = State.LessonActive;\n      } else state.value = State.Onboarding;\n    }\n\n    return {\n      currentDance,\n      currentLesson,\n      danceSelected,\n      goHome,\n      startWebcam,\n      onTrackingAttained,\n      state,\n      cameraSurface,\n      State,\n    };\n  },\n  methods: {\n    poseDrawerSelected() {\n      this.state = State.PoseDrawingTester;\n    },\n    createLessonSelected(dance: DatabaseEntry) {\n      this.currentDance = dance;\n      this.state = State.CreateLesson;\n    },\n  },\n});\n","import { render } from \"./App.vue?vue&type=template&id=01243361\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=01243361&lang=scss\"\nscript.render = render\n\nexport default script","/* eslint-disable no-console */\n\nimport { register } from 'register-service-worker';\n\nif (process.env.NODE_ENV === 'production') {\n  register(`${process.env.BASE_URL}service-worker.js`, {\n    ready() {\n      console.log(\n        'App is being served from cache by a service worker.\\n'\n        + 'For more details, visit https://goo.gl/AFskqB',\n      );\n    },\n    registered() {\n      console.log('Service worker has been registered.');\n    },\n    cached() {\n      console.log('Content has been cached for offline use.');\n    },\n    updatefound() {\n      console.log('New content is downloading.');\n    },\n    updated() {\n      console.log('New content is available; please refresh.');\n    },\n    offline() {\n      console.log('No internet connection found. App is running in offline mode.');\n    },\n    error(error) {\n      console.error('Error during service worker registration:', error);\n    },\n  });\n}\n","import { Landmark, MpHolisticResults, PoseLandmarks } from './MediaPipeTypes';\nimport eventHub, { EventNames, GestureNames } from './EventHub';\nimport {\n  HAND, usingHolistic,\n} from './MediaPipe';\n\nconst minDetectionVisibility = 0.85;\n\nfunction getAngle(lm0: Landmark, lm1: Landmark, aspectRatio: number) {\n  return Math.atan2(lm1.y - lm0.y, aspectRatio * (lm1.x - lm0.x));\n}\nfunction dist(lm0: Landmark, lm1: Landmark, aspectRatio: number) {\n  return Math.sqrt((aspectRatio * (lm1.x - lm0.x)) ** 2 + (lm1.y - lm0.y) ** 2);\n}\nconst getSum = (input: Array<number>) => input.reduce((a, b) => a + b, 0);\n\nfunction midPoint(lm0: Landmark, lm1: Landmark): Landmark {\n  return {\n    x: (0.5) * (lm0.x + lm1.x),\n    y: (0.5) * (lm0.y + lm1.y),\n  };\n}\n\nfunction averageAngle(input: Array<Landmark>, aspectRatio: number): number {\n  if (input.length < 2) return 0;\n\n  const angles = input.map(\n    (val, i, arr) => (arr[i + 1] === undefined ? 0 : getAngle(arr[i], arr[i + 1], aspectRatio)),\n  );\n  angles.pop();\n\n  const y = getSum(angles.map(Math.sin));\n  const x = getSum(angles.map(Math.cos));\n\n  return Math.atan2(y, x);\n}\n\nfunction isLine(input: Array<Landmark>, angleTolerance: number | undefined, aspectRatio: number): boolean {\n  if (input.length < 2) { return false; } // Single point: not a line\n\n  // Default the tolerance to 15 deg (on either side)\n  const tolerance = angleTolerance ?? Math.PI / 12;\n  let lastAngle = getAngle(input[0], input[1], aspectRatio);\n\n  // Make sure the angle is about correct\n  for (let i = 1; i < input.length - 1; i += 1) {\n    const thisAngle = getAngle(input[i], input[i + 1], aspectRatio);\n    if (Math.abs(thisAngle - lastAngle) >= tolerance) { return false; }\n\n    lastAngle = thisAngle;\n  }\n  return true;\n}\n\nfunction detectHandPointingGestures(handLandmarks: Landmark[] | undefined, aspectRatio: number): string {\n  if (!handLandmarks) return GestureNames.none;\n\n  const FINGERS = [\n    HAND.INDEX_FINGER,\n    HAND.MIDDLE_FINGER,\n    HAND.RING_FINGER,\n    HAND.PINKY_FINGER,\n  ];\n\n  const FINGER_LANDMARKS = FINGERS.map((indices) => indices.map((lm) => handLandmarks[lm]));\n\n  let areLines = true;\n  FINGER_LANDMARKS.forEach((finger) => {\n    if (!isLine(finger, undefined, aspectRatio)) areLines = false;\n  });\n\n  const avgAngle = averageAngle(FINGER_LANDMARKS[0], aspectRatio);\n  const avgAngleDeg = (avgAngle * 180) / Math.PI;\n\n  const tolerance = 30;\n  if (Math.abs(avgAngleDeg) < tolerance && areLines) return GestureNames.pointLeft;\n  if (Math.abs(avgAngleDeg) > 180 - tolerance && areLines) return GestureNames.pointRight;\n\n  return GestureNames.none;\n}\n\nfunction detectPosePointingGestures(poseLandmarks: Landmark[] | undefined, aspectRatio: number): string {\n  if (!poseLandmarks) return GestureNames.none;\n\n  const TOLERANCE = 20;\n  const TOLERANCE_RADS = TOLERANCE / (180 * Math.PI);\n\n  const left = [PoseLandmarks.leftElbow, PoseLandmarks.leftWrist].map((i) => poseLandmarks[i]);\n  const lelb = left[0];\n  const lwrist = left[1];\n  if (lelb.visibility && lelb.visibility > minDetectionVisibility && lwrist.visibility && lwrist.visibility > minDetectionVisibility) {\n    const ang = getAngle(lelb, lwrist, aspectRatio);\n    if (Math.abs(ang) > Math.PI - TOLERANCE_RADS) return GestureNames.pointRight;\n  }\n\n  const right = [PoseLandmarks.rightElbow, PoseLandmarks.rightWrist].map((i) => poseLandmarks[i]);\n  const relb = right[0];\n  const rwrist = right[1];\n  if (relb.visibility && relb.visibility > minDetectionVisibility && rwrist.visibility && rwrist.visibility > minDetectionVisibility) {\n    const ang = getAngle(relb, rwrist, aspectRatio);\n    if (Math.abs(ang) < TOLERANCE_RADS) return GestureNames.pointLeft;\n  }\n\n  return GestureNames.none;\n}\n\nfunction isNamasteGesture(results: MpHolisticResults, aspectRatio: number): boolean {\n  /* eslint-disable operator-linebreak, no-multi-spaces */\n  const IDs = PoseLandmarks;\n  const poseLMs = results.poseLandmarks;\n  if (!poseLMs) return false;\n\n  const areArmLandmarksVisible =\n    (poseLMs[IDs.leftShoulder].visibility  ?? 0) > minDetectionVisibility &&\n    (poseLMs[IDs.leftElbow].visibility     ?? 0) > minDetectionVisibility &&\n    (poseLMs[IDs.leftWrist].visibility     ?? 0) > minDetectionVisibility &&\n    (poseLMs[IDs.rightShoulder].visibility ?? 0) > minDetectionVisibility &&\n    (poseLMs[IDs.rightElbow].visibility    ?? 0) > minDetectionVisibility &&\n    (poseLMs[IDs.rightWrist].visibility    ?? 0) > minDetectionVisibility;\n\n  // See if elbows are down, against the stomach\n  const downwards = -Math.PI / 2; // -90 deg\n  const leftForearmTargetAngle = downwards;\n  const rightForearmTargetAngle = downwards;\n  const elbowAngleTolerance = Math.PI / 9; // 20 deg\n\n  const leftForearmAngle = getAngle(poseLMs[IDs.leftShoulder], poseLMs[IDs.leftElbow], aspectRatio);\n  const rightForearmAngle = getAngle(poseLMs[IDs.rightShoulder], poseLMs[IDs.rightElbow], aspectRatio);\n\n  const areElbowsNearChest =\n    Math.abs(leftForearmAngle - leftForearmTargetAngle) < elbowAngleTolerance / 2 &&\n    Math.abs(rightForearmAngle - rightForearmTargetAngle) < elbowAngleTolerance / 2;\n\n  // See if hands are up and together, near base of neck\n  const handNeckMinRelativeDist = 0.8;\n  const shoulderDist = dist(poseLMs[IDs.leftShoulder], poseLMs[IDs.rightShoulder], aspectRatio);\n  const neckCenter = midPoint(poseLMs[IDs.leftShoulder], poseLMs[IDs.rightShoulder]);\n  const leftWristNeckDist = dist(neckCenter, poseLMs[IDs.leftWrist], aspectRatio) / shoulderDist;\n  const rightWristNeckDist = dist(neckCenter, poseLMs[IDs.rightWrist], aspectRatio) / shoulderDist;\n\n  const areHandsNearNeckBase =\n    leftWristNeckDist  < handNeckMinRelativeDist &&\n    rightWristNeckDist < handNeckMinRelativeDist;\n\n  // console.log('areArmLandmarksVisible', areArmLandmarksVisible);\n  // console.log('areElbowsNearChest', areElbowsNearChest);\n  // console.log('areHandsNearNeckBase', areHandsNearNeckBase);\n  // console.log('  leftWristNeckDist', leftWristNeckDist);\n  // console.log('  rightWristNeckDist', rightWristNeckDist);\n  return areArmLandmarksVisible &&\n  //  areElbowsNearChest &&\n         areHandsNearNeckBase;\n\n  /* eslint-enable operator-linebreak, no-multi-spaces */\n}\n\nexport default function detectGesture(mpResults?: MpHolisticResults): string {\n\n  const aspectRatio = (mpResults?.image?.width ?? 1) / (mpResults?.image?.height ?? 1);\n\n  if (!mpResults) return GestureNames.none;\n  let detectedGesture = GestureNames.none;\n\n  if (usingHolistic) {\n    if (detectedGesture === GestureNames.none) detectedGesture = detectHandPointingGestures(mpResults.rightHandLandmarks, aspectRatio);\n    if (detectedGesture === GestureNames.none) detectedGesture = detectHandPointingGestures(mpResults.leftHandLandmarks, aspectRatio);\n  } else detectedGesture = detectPosePointingGestures(mpResults.poseLandmarks, aspectRatio);\n\n  if (detectedGesture === GestureNames.none && isNamasteGesture(mpResults, aspectRatio)) {\n    detectedGesture = GestureNames.namaste;\n  }\n\n  return detectedGesture;\n}\n\nexport function startGestureDetection() {\n  eventHub.on(EventNames.trackingResults, (results: MpHolisticResults) => {\n    const detectedGesture = detectGesture(results);\n    eventHub.emit(EventNames.gesture, detectedGesture, results);\n  });\n}\n","import { createApp } from 'vue';\n\nimport App from './App.vue';\n\nimport './registerServiceWorker';\nimport { startGestureDetection } from './services/GestureDetection';\n\nrequire('bulma-slider');\n\nrequire('@/assets/main.scss');\n\nconst app = createApp(App);\napp.mount('#app');\n\nstartGestureDetection();\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ActivityVideoPlayer.vue?vue&type=style&index=0&id=ab48b626&lang=scss\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./OnboardingUI.vue?vue&type=style&index=0&id=69ed9ac4&lang=scss\""],"sourceRoot":""}